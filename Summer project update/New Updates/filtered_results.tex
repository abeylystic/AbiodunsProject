\documentclass[11pt]{article}

    \usepackage[breakable]{tcolorbox}
    \usepackage{parskip} % Stop auto-indenting (to mimic markdown behaviour)
    

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % Keep aspect ratio if custom image width or height is specified
    \setkeys{Gin}{keepaspectratio}
    % Maintain compatibility with old templates. Remove in nbconvert 6.0
    \let\Oldincludegraphics\includegraphics
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionFormat{nocaption}{}
    \captionsetup{format=nocaption,aboveskip=0pt,belowskip=0pt}

    \usepackage{float}
    \floatplacement{figure}{H} % forces figures to be placed at the correct location
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro

    \usepackage{iftex}
    \ifPDFTeX
        \usepackage[T1]{fontenc}
        \IfFileExists{alphabeta.sty}{
              \usepackage{alphabeta}
          }{
              \usepackage[mathletters]{ucs}
              \usepackage[utf8x]{inputenc}
          }
    \else
        \usepackage{fontspec}
        \usepackage{unicode-math}
    \fi

    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics
                         % to support a larger range
    \makeatletter % fix for old versions of grffile with XeLaTeX
    \@ifpackagelater{grffile}{2019/11/01}
    {
      % Do nothing on new versions
    }
    {
      \def\Gread@@xetex#1{%
        \IfFileExists{"\Gin@base".bb}%
        {\Gread@eps{\Gin@base.bb}}%
        {\Gread@@xetex@aux#1}%
      }
    }
    \makeatother
    \usepackage[Export]{adjustbox} % Used to constrain images to a maximum size
    \adjustboxset{max size={0.9\linewidth}{0.9\paperheight}}

    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    % The default LaTeX title has an obnoxious amount of whitespace. By default,
    % titling removes some of it. It also provides customization options.
    \usepackage{titling}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage{array}     % table support for pandoc >= 2.11.3
    \usepackage{calc}      % table minipage width calculation for pandoc >= 2.11.1
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    \usepackage{soul}      % strikethrough (\st) support for pandoc >= 3.0.0
    \usepackage{mathrsfs}
    

    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}
    \definecolor{ansi-default-inverse-fg}{HTML}{FFFFFF}
    \definecolor{ansi-default-inverse-bg}{HTML}{000000}

    % common color for the border for error outputs.
    \definecolor{outerrorbackground}{HTML}{FFDFDF}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}

    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}


    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatibility definitions
    \def\gt{>}
    \def\lt{<}
    \let\Oldtex\TeX
    \let\Oldlatex\LaTeX
    \renewcommand{\TeX}{\textrm{\Oldtex}}
    \renewcommand{\LaTeX}{\textrm{\Oldlatex}}
    % Document parameters
    % Document title
    \title{08192024 Update}
    
    
    
    
    
    
    
% Pygments definitions
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\@namedef{PY@tok@w}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\@namedef{PY@tok@c}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.24,0.48,0.48}{##1}}}
\@namedef{PY@tok@cp}{\def\PY@tc##1{\textcolor[rgb]{0.61,0.40,0.00}{##1}}}
\@namedef{PY@tok@k}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kp}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kt}{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\@namedef{PY@tok@o}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@ow}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\@namedef{PY@tok@nb}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@nf}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\@namedef{PY@tok@nc}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\@namedef{PY@tok@nn}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\@namedef{PY@tok@ne}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.80,0.25,0.22}{##1}}}
\@namedef{PY@tok@nv}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@no}{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\@namedef{PY@tok@nl}{\def\PY@tc##1{\textcolor[rgb]{0.46,0.46,0.00}{##1}}}
\@namedef{PY@tok@ni}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.44,0.44,0.44}{##1}}}
\@namedef{PY@tok@na}{\def\PY@tc##1{\textcolor[rgb]{0.41,0.47,0.13}{##1}}}
\@namedef{PY@tok@nt}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@nd}{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\@namedef{PY@tok@s}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@sd}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@si}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.64,0.35,0.47}{##1}}}
\@namedef{PY@tok@se}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.36,0.12}{##1}}}
\@namedef{PY@tok@sr}{\def\PY@tc##1{\textcolor[rgb]{0.64,0.35,0.47}{##1}}}
\@namedef{PY@tok@ss}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@sx}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@m}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@gh}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\@namedef{PY@tok@gu}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\@namedef{PY@tok@gd}{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\@namedef{PY@tok@gi}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.52,0.00}{##1}}}
\@namedef{PY@tok@gr}{\def\PY@tc##1{\textcolor[rgb]{0.89,0.00,0.00}{##1}}}
\@namedef{PY@tok@ge}{\let\PY@it=\textit}
\@namedef{PY@tok@gs}{\let\PY@bf=\textbf}
\@namedef{PY@tok@gp}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\@namedef{PY@tok@go}{\def\PY@tc##1{\textcolor[rgb]{0.44,0.44,0.44}{##1}}}
\@namedef{PY@tok@gt}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\@namedef{PY@tok@err}{\def\PY@bc##1{{\setlength{\fboxsep}{\string -\fboxrule}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}}
\@namedef{PY@tok@kc}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kd}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kn}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kr}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@bp}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@fm}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\@namedef{PY@tok@vc}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@vg}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@vi}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@vm}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@sa}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@sb}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@sc}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@dl}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@s2}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@sh}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@s1}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@mb}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@mf}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@mh}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@mi}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@il}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@mo}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@ch}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.24,0.48,0.48}{##1}}}
\@namedef{PY@tok@cm}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.24,0.48,0.48}{##1}}}
\@namedef{PY@tok@cpf}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.24,0.48,0.48}{##1}}}
\@namedef{PY@tok@c1}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.24,0.48,0.48}{##1}}}
\@namedef{PY@tok@cs}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.24,0.48,0.48}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % For linebreaks inside Verbatim environment from package fancyvrb.
    \makeatletter
        \newbox\Wrappedcontinuationbox
        \newbox\Wrappedvisiblespacebox
        \newcommand*\Wrappedvisiblespace {\textcolor{red}{\textvisiblespace}}
        \newcommand*\Wrappedcontinuationsymbol {\textcolor{red}{\llap{\tiny$\m@th\hookrightarrow$}}}
        \newcommand*\Wrappedcontinuationindent {3ex }
        \newcommand*\Wrappedafterbreak {\kern\Wrappedcontinuationindent\copy\Wrappedcontinuationbox}
        % Take advantage of the already applied Pygments mark-up to insert
        % potential linebreaks for TeX processing.
        %        {, <, #, %, $, ' and ": go to next line.
        %        _, }, ^, &, >, - and ~: stay at end of broken line.
        % Use of \textquotesingle for straight quote.
        \newcommand*\Wrappedbreaksatspecials {%
            \def\PYGZus{\discretionary{\char`\_}{\Wrappedafterbreak}{\char`\_}}%
            \def\PYGZob{\discretionary{}{\Wrappedafterbreak\char`\{}{\char`\{}}%
            \def\PYGZcb{\discretionary{\char`\}}{\Wrappedafterbreak}{\char`\}}}%
            \def\PYGZca{\discretionary{\char`\^}{\Wrappedafterbreak}{\char`\^}}%
            \def\PYGZam{\discretionary{\char`\&}{\Wrappedafterbreak}{\char`\&}}%
            \def\PYGZlt{\discretionary{}{\Wrappedafterbreak\char`\<}{\char`\<}}%
            \def\PYGZgt{\discretionary{\char`\>}{\Wrappedafterbreak}{\char`\>}}%
            \def\PYGZsh{\discretionary{}{\Wrappedafterbreak\char`\#}{\char`\#}}%
            \def\PYGZpc{\discretionary{}{\Wrappedafterbreak\char`\%}{\char`\%}}%
            \def\PYGZdl{\discretionary{}{\Wrappedafterbreak\char`\$}{\char`\$}}%
            \def\PYGZhy{\discretionary{\char`\-}{\Wrappedafterbreak}{\char`\-}}%
            \def\PYGZsq{\discretionary{}{\Wrappedafterbreak\textquotesingle}{\textquotesingle}}%
            \def\PYGZdq{\discretionary{}{\Wrappedafterbreak\char`\"}{\char`\"}}%
            \def\PYGZti{\discretionary{\char`\~}{\Wrappedafterbreak}{\char`\~}}%
        }
        % Some characters . , ; ? ! / are not pygmentized.
        % This macro makes them "active" and they will insert potential linebreaks
        \newcommand*\Wrappedbreaksatpunct {%
            \lccode`\~`\.\lowercase{\def~}{\discretionary{\hbox{\char`\.}}{\Wrappedafterbreak}{\hbox{\char`\.}}}%
            \lccode`\~`\,\lowercase{\def~}{\discretionary{\hbox{\char`\,}}{\Wrappedafterbreak}{\hbox{\char`\,}}}%
            \lccode`\~`\;\lowercase{\def~}{\discretionary{\hbox{\char`\;}}{\Wrappedafterbreak}{\hbox{\char`\;}}}%
            \lccode`\~`\:\lowercase{\def~}{\discretionary{\hbox{\char`\:}}{\Wrappedafterbreak}{\hbox{\char`\:}}}%
            \lccode`\~`\?\lowercase{\def~}{\discretionary{\hbox{\char`\?}}{\Wrappedafterbreak}{\hbox{\char`\?}}}%
            \lccode`\~`\!\lowercase{\def~}{\discretionary{\hbox{\char`\!}}{\Wrappedafterbreak}{\hbox{\char`\!}}}%
            \lccode`\~`\/\lowercase{\def~}{\discretionary{\hbox{\char`\/}}{\Wrappedafterbreak}{\hbox{\char`\/}}}%
            \catcode`\.\active
            \catcode`\,\active
            \catcode`\;\active
            \catcode`\:\active
            \catcode`\?\active
            \catcode`\!\active
            \catcode`\/\active
            \lccode`\~`\~
        }
    \makeatother

    \let\OriginalVerbatim=\Verbatim
    \makeatletter
    \renewcommand{\Verbatim}[1][1]{%
        %\parskip\z@skip
        \sbox\Wrappedcontinuationbox {\Wrappedcontinuationsymbol}%
        \sbox\Wrappedvisiblespacebox {\FV@SetupFont\Wrappedvisiblespace}%
        \def\FancyVerbFormatLine ##1{\hsize\linewidth
            \vtop{\raggedright\hyphenpenalty\z@\exhyphenpenalty\z@
                \doublehyphendemerits\z@\finalhyphendemerits\z@
                \strut ##1\strut}%
        }%
        % If the linebreak is at a space, the latter will be displayed as visible
        % space at end of first line, and a continuation symbol starts next line.
        % Stretch/shrink are however usually zero for typewriter font.
        \def\FV@Space {%
            \nobreak\hskip\z@ plus\fontdimen3\font minus\fontdimen4\font
            \discretionary{\copy\Wrappedvisiblespacebox}{\Wrappedafterbreak}
            {\kern\fontdimen2\font}%
        }%

        % Allow breaks at special characters using \PYG... macros.
        \Wrappedbreaksatspecials
        % Breaks at punctuation characters . , ; ? ! and / need catcode=\active
        \OriginalVerbatim[#1,codes*=\Wrappedbreaksatpunct]%
    }
    \makeatother

    % Exact colors from NB
    \definecolor{incolor}{HTML}{303F9F}
    \definecolor{outcolor}{HTML}{D84315}
    \definecolor{cellborder}{HTML}{CFCFCF}
    \definecolor{cellbackground}{HTML}{F7F7F7}

    % prompt
    \makeatletter
    \newcommand{\boxspacing}{\kern\kvtcb@left@rule\kern\kvtcb@boxsep}
    \makeatother
    \newcommand{\prompt}[4]{
        {\ttfamily\llap{{\color{#2}[#3]:\hspace{3pt}#4}}\vspace{-\baselineskip}}
    }
    

    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

\begin{document}
    
    \maketitle
    
    

    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{1}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import} \PY{n+nn}{warnings}
\PY{n}{warnings}\PY{o}{.}\PY{n}{filterwarnings}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ignore}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
\PY{k+kn}{from} \PY{n+nn}{pgmpy}\PY{n+nn}{.}\PY{n+nn}{estimators} \PY{k+kn}{import} \PY{n}{PC}
\PY{k+kn}{from} \PY{n+nn}{abbeyFunctions} \PY{k+kn}{import} \PY{n}{graph\PYZus{}DAG}
\PY{k+kn}{from} \PY{n+nn}{abiFunctions} \PY{k+kn}{import} \PY{n}{analyze\PYZus{}wls\PYZus{}pooled\PYZus{}models}\PY{p}{,} \PY{n}{wls\PYZus{}pooled\PYZus{}model\PYZus{}analysis}
\PY{k+kn}{import} \PY{n+nn}{pingouin}
\PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{2}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{diff\PYZus{}nominal} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{diff\PYZus{}nominal.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{n}{diff\PYZus{}nominal}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Unnamed: 0}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}

\PY{n}{rates\PYZus{}nominal} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rates\PYZus{}nominal.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{n}{rates\PYZus{}nominal}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Unnamed: 0}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}

\PY{n}{log\PYZus{}nominal} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{log\PYZus{}nominal\PYZus{}data.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{3}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{nominal\PYZus{}differenced\PYZus{}rates\PYZus{}with\PYZus{}all\PYZus{}variables} \PY{o}{=} \PY{n}{diff\PYZus{}nominal}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{set\PYZus{}index}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FIPS}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{TimePeriod}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}

\PY{n}{nominal\PYZus{}rates\PYZus{}with\PYZus{}all\PYZus{}variables} \PY{o}{=} \PY{n}{rates\PYZus{}nominal}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{set\PYZus{}index}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FIPS}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{TimePeriod}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}

\PY{n}{nominal\PYZus{}log\PYZus{}with\PYZus{}all\PYZus{}variables} \PY{o}{=} \PY{n}{log\PYZus{}nominal}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{set\PYZus{}index}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FIPS}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{TimePeriod}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}

\PY{c+c1}{\PYZsh{} Create a dictionary to store the DataFrames}
\PY{n}{full\PYZus{}DAG\PYZus{}dict} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}

\PY{n}{full\PYZus{}DAG\PYZus{}dict}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Nominal log (All variables)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{nominal\PYZus{}log\PYZus{}with\PYZus{}all\PYZus{}variables}

\PY{n}{full\PYZus{}DAG\PYZus{}dict}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Nominal log (without Monetary)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{nominal\PYZus{}log\PYZus{}with\PYZus{}all\PYZus{}variables}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M4I}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}

\PY{n}{full\PYZus{}DAG\PYZus{}dict}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Nominal log (without unem)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{nominal\PYZus{}log\PYZus{}with\PYZus{}all\PYZus{}variables}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{unem}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}

\PY{n}{full\PYZus{}DAG\PYZus{}dict}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Nominal rates (All variables)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{nominal\PYZus{}rates\PYZus{}with\PYZus{}all\PYZus{}variables}

\PY{n}{full\PYZus{}DAG\PYZus{}dict}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Nominal rates (without Monetary)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{nominal\PYZus{}rates\PYZus{}with\PYZus{}all\PYZus{}variables}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M4I}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}

\PY{n}{full\PYZus{}DAG\PYZus{}dict}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Nominal rates (without unem)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{nominal\PYZus{}rates\PYZus{}with\PYZus{}all\PYZus{}variables}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{unem}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}

\PY{n}{full\PYZus{}DAG\PYZus{}dict}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Nominal diff rates (All variables)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{nominal\PYZus{}differenced\PYZus{}rates\PYZus{}with\PYZus{}all\PYZus{}variables}

\PY{n}{full\PYZus{}DAG\PYZus{}dict}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Nominal diff rates (without Monetary)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{nominal\PYZus{}differenced\PYZus{}rates\PYZus{}with\PYZus{}all\PYZus{}variables}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M4I}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}

\PY{n}{full\PYZus{}DAG\PYZus{}dict}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Nominal diff rates (without unem)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{nominal\PYZus{}differenced\PYZus{}rates\PYZus{}with\PYZus{}all\PYZus{}variables}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{unem}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{4}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{full\PYZus{}df\PYZus{}rates\PYZus{}cluster} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{full\PYZus{}df\PYZus{}rates\PYZus{}cluster.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{full\PYZus{}df\PYZus{}rates\PYZus{}cluster}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Unnamed: 0}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}

\PY{n}{full\PYZus{}df\PYZus{}diff\PYZus{}cluster} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{full\PYZus{}df\PYZus{}diff\PYZus{}cluster.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{full\PYZus{}df\PYZus{}diff\PYZus{}cluster}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Unnamed: 0}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}

\PY{n}{full\PYZus{}df\PYZus{}log\PYZus{}cluster} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{full\PYZus{}df\PYZus{}log\PYZus{}cluster.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{full\PYZus{}df\PYZus{}log\PYZus{}cluster}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Unnamed: 0}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{5}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{full\PYZus{}df\PYZus{}with\PYZus{}cluster} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}

\PY{n}{full\PYZus{}df\PYZus{}with\PYZus{}cluster}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Rates}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{full\PYZus{}df\PYZus{}rates\PYZus{}cluster}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{set\PYZus{}index}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FIPS}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{TimePeriod}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\PY{n}{full\PYZus{}df\PYZus{}with\PYZus{}cluster}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Diff rates}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{full\PYZus{}df\PYZus{}diff\PYZus{}cluster}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{set\PYZus{}index}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FIPS}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{TimePeriod}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{6}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} Convert boolean columns to integer columns}
\PY{k}{def} \PY{n+nf}{convert\PYZus{}bool\PYZus{}to\PYZus{}int}\PY{p}{(}\PY{n}{df}\PY{p}{)}\PY{p}{:}
    \PY{k}{for} \PY{n}{col} \PY{o+ow}{in} \PY{n}{df}\PY{o}{.}\PY{n}{select\PYZus{}dtypes}\PY{p}{(}\PY{n}{include}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bool}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{columns}\PY{p}{:}
        \PY{n}{df}\PY{p}{[}\PY{n}{col}\PY{p}{]} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{int}\PY{p}{)}
    \PY{k}{return} \PY{n}{df}

\PY{n}{data\PYZus{}cluster\PYZus{}dict} \PY{o}{=} \PY{p}{\PYZob{}}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Nominal rates with clusters}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{convert\PYZus{}bool\PYZus{}to\PYZus{}int}\PY{p}{(}\PY{n}{pd}\PY{o}{.}\PY{n}{get\PYZus{}dummies}\PY{p}{(}\PY{n}{full\PYZus{}df\PYZus{}rates\PYZus{}cluster}\PY{p}{,} \PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{clusters}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{drop\PYZus{}first}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}\PY{p}{)}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Nominal diff rates with clusters}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{convert\PYZus{}bool\PYZus{}to\PYZus{}int}\PY{p}{(}\PY{n}{pd}\PY{o}{.}\PY{n}{get\PYZus{}dummies}\PY{p}{(}\PY{n}{full\PYZus{}df\PYZus{}diff\PYZus{}cluster}\PY{p}{,} \PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{clusters}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{drop\PYZus{}first}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}\PY{p}{)}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Nominal log with clusters}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{convert\PYZus{}bool\PYZus{}to\PYZus{}int}\PY{p}{(}\PY{n}{pd}\PY{o}{.}\PY{n}{get\PYZus{}dummies}\PY{p}{(}\PY{n}{full\PYZus{}df\PYZus{}log\PYZus{}cluster}\PY{p}{,} \PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{clusters}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{drop\PYZus{}first}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}\PY{p}{)}
\PY{p}{\PYZcb{}}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{7}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{df\PYZus{}rates} \PY{o}{=} \PY{n}{data\PYZus{}cluster\PYZus{}dict}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Nominal rates with clusters}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}

\PY{n}{df\PYZus{}diff} \PY{o}{=} \PY{n}{data\PYZus{}cluster\PYZus{}dict}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Nominal diff rates with clusters}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{44}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{rates\PYZus{}sum} \PY{o}{=} \PY{n}{df\PYZus{}rates}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{p}{)}

\PY{n}{diff\PYZus{}sum} \PY{o}{=} \PY{n}{df\PYZus{}diff}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{52}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{summary\PYZus{}rates} \PY{o}{=} \PY{n}{rates\PYZus{}sum}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Agri}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mini}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Util}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M4I}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{unem}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
       \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{EFW}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{clusters\PYZus{}2.0}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{clusters\PYZus{}3.0}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{clusters\PYZus{}4.0}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{agg}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{std}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{min}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}

\PY{n}{summary\PYZus{}diff} \PY{o}{=} \PY{n}{diff\PYZus{}sum}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Agri}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mini}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Util}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M4I}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{unem}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
       \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{EFW}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{clusters\PYZus{}2.0}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{clusters\PYZus{}3.0}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{clusters\PYZus{}4.0}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{agg}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{std}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{min}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{53}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{summary\PYZus{}rates}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{53}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
          Agri      Mini      Util        M4       M4I       unem       EFW  \textbackslash{}
mean  0.016776 -0.007244  0.035747  0.050146  0.007932   6.126820  8.112852
std   0.736230  0.475596  0.403522  0.046424  0.010146   2.639422  0.174835
min  -4.377459 -6.101616 -6.395262 -0.047803  0.000516   1.069231  7.630000
max   4.480537  6.758095  9.326184  0.208378  0.033668  29.392308  8.610000

      clusters\_2.0  clusters\_3.0  clusters\_4.0
mean      0.370578      0.151095      0.099683
std       0.482967      0.358147      0.299581
min       0.000000      0.000000      0.000000
max       1.000000      1.000000      1.000000
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{54}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{summary\PYZus{}diff}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{54}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
          Agri       Mini       Util        M4       M4I       unem       EFW  \textbackslash{}
mean  0.007348  -0.016714  -0.008102  0.002423 -0.000377   0.053772 -0.021230
std   1.204870   0.647426   0.553488  0.051955  0.006672   1.415603  0.100993
min  -7.485003  -7.196588 -10.957942 -0.110658 -0.017333  -8.569231 -0.380000
max   8.803364  10.443862   9.861832  0.155660  0.011944  11.384615  0.190000

      clusters\_2.0  clusters\_3.0  clusters\_4.0
mean      0.372096      0.184109      0.090563
std       0.483373      0.387581      0.286993
min       0.000000      0.000000      0.000000
max       1.000000      1.000000      1.000000
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{55}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} summary statistics}

\PY{c+c1}{\PYZsh{} Add a new level to distinguish between rates and differenced rates}
\PY{n}{summary\PYZus{}rates}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Rates}\PY{l+s+s1}{\PYZsq{}}
\PY{n}{summary\PYZus{}diff}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Differenced Rates}\PY{l+s+s1}{\PYZsq{}}

\PY{c+c1}{\PYZsh{} Set the \PYZsq{}Type\PYZsq{} as the first level of the index}
\PY{n}{summary\PYZus{}rates} \PY{o}{=} \PY{n}{summary\PYZus{}rates}\PY{o}{.}\PY{n}{set\PYZus{}index}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{append}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\PY{n}{summary\PYZus{}diff} \PY{o}{=} \PY{n}{summary\PYZus{}diff}\PY{o}{.}\PY{n}{set\PYZus{}index}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{append}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}

\PY{c+c1}{\PYZsh{} Combine the DataFrames}
\PY{n}{combined\PYZus{}summary} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{concat}\PY{p}{(}\PY{p}{[}\PY{n}{summary\PYZus{}rates}\PY{p}{,} \PY{n}{summary\PYZus{}diff}\PY{p}{]}\PY{p}{)}
\PY{n}{combined\PYZus{}summary} \PY{o}{=} \PY{n}{combined\PYZus{}summary}\PY{o}{.}\PY{n}{reorder\PYZus{}levels}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{k+kc}{None}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
\PY{n}{combined\PYZus{}summary} \PY{o}{=} \PY{n}{combined\PYZus{}summary}\PY{o}{.}\PY{n}{sort\PYZus{}index}\PY{p}{(}\PY{n}{level}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{8}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import} \PY{n+nn}{itertools}
\PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
\PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
\PY{k+kn}{import} \PY{n+nn}{statsmodels}\PY{n+nn}{.}\PY{n+nn}{api} \PY{k}{as} \PY{n+nn}{sm}
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{model\PYZus{}selection} \PY{k+kn}{import} \PY{n}{KFold}

\PY{k}{def} \PY{n+nf}{calculate\PYZus{}residuals\PYZus{}k}\PY{p}{(}\PY{n}{df}\PY{p}{,} \PY{n}{y\PYZus{}var}\PY{p}{,} \PY{n}{X\PYZus{}vars}\PY{p}{,} \PY{n}{model\PYZus{}type}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ols}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{weights}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,} \PY{n}{include\PYZus{}constant}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{p}{:}
    \PY{n}{residuals} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
    \PY{k}{for} \PY{n}{var} \PY{o+ow}{in} \PY{p}{[}\PY{n}{y\PYZus{}var}\PY{p}{]} \PY{o}{+} \PY{n}{X\PYZus{}vars}\PY{p}{:}
        \PY{n}{other\PYZus{}vars} \PY{o}{=} \PY{p}{[}\PY{n}{v} \PY{k}{for} \PY{n}{v} \PY{o+ow}{in} \PY{p}{[}\PY{n}{y\PYZus{}var}\PY{p}{]} \PY{o}{+} \PY{n}{X\PYZus{}vars} \PY{k}{if} \PY{n}{v} \PY{o}{!=} \PY{n}{var}\PY{p}{]}
        \PY{n}{X} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{n}{other\PYZus{}vars}\PY{p}{]}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}
        \PY{k}{if} \PY{n}{include\PYZus{}constant}\PY{p}{:}
            \PY{n}{X} \PY{o}{=} \PY{n}{sm}\PY{o}{.}\PY{n}{add\PYZus{}constant}\PY{p}{(}\PY{n}{X}\PY{p}{,} \PY{n}{has\PYZus{}constant}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{add}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{y} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{n}{var}\PY{p}{]}
        
        \PY{k}{if} \PY{n}{model\PYZus{}type} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ols}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
            \PY{n}{model} \PY{o}{=} \PY{n}{sm}\PY{o}{.}\PY{n}{OLS}\PY{p}{(}\PY{n}{y}\PY{p}{,} \PY{n}{X}\PY{p}{)}
        \PY{k}{elif} \PY{n}{model\PYZus{}type} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{wls}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
            \PY{n}{model} \PY{o}{=} \PY{n}{sm}\PY{o}{.}\PY{n}{WLS}\PY{p}{(}\PY{n}{y}\PY{p}{,} \PY{n}{X}\PY{p}{,} \PY{n}{weights}\PY{o}{=}\PY{n}{weights}\PY{p}{)}
        
        \PY{n}{results} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{p}{)}
        \PY{n}{residuals}\PY{p}{[}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s2}{epsilon\PYZus{}}\PY{l+s+se}{\PYZob{}\PYZob{}}\PY{l+s+si}{\PYZob{}}\PY{n}{var}\PY{l+s+si}{\PYZcb{}}\PY{l+s+se}{\PYZcb{}\PYZcb{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{results}\PY{o}{.}\PY{n}{resid}
    \PY{k}{return} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{residuals}\PY{p}{)}

\PY{k}{def} \PY{n+nf}{ols\PYZus{}wls\PYZus{}combinations\PYZus{}kfold}\PY{p}{(}\PY{n}{df}\PY{p}{,} \PY{n}{dependent\PYZus{}var}\PY{p}{,} \PY{n}{independent\PYZus{}vars}\PY{p}{,} \PY{n}{model\PYZus{}type}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ols}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} 
                               \PY{n}{always\PYZus{}include}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,} \PY{n}{never\PYZus{}include}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,} \PY{n}{df\PYZus{}name}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{df}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} 
                               \PY{n}{include\PYZus{}constant}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,} \PY{n}{n\PYZus{}splits}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{k+kc}{None}\PY{p}{)}\PY{p}{:}
    \PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{seed}\PY{p}{(}\PY{n}{random\PYZus{}state}\PY{p}{)}
    \PY{n}{df} \PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{replace}\PY{p}{(}\PY{p}{[}\PY{n}{np}\PY{o}{.}\PY{n}{inf}\PY{p}{,} \PY{o}{\PYZhy{}}\PY{n}{np}\PY{o}{.}\PY{n}{inf}\PY{p}{]}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{nan}\PY{p}{)}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{p}{)}

    \PY{n}{y} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{n}{dependent\PYZus{}var}\PY{p}{]}

    \PY{k}{if} \PY{n}{model\PYZus{}type} \PY{o+ow}{not} \PY{o+ow}{in} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ols}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{wls}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{:}
        \PY{k}{raise} \PY{n+ne}{ValueError}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{model\PYZus{}type must be either }\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{ols}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{ or }\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{wls}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}

    \PY{k}{if} \PY{n}{model\PYZus{}type} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{wls}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
        \PY{c+c1}{\PYZsh{} Calculate weights for WLS}
        \PY{n}{county\PYZus{}unem} \PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FIPS}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{[}\PY{n}{dependent\PYZus{}var}\PY{p}{]}\PY{o}{.}\PY{n}{var}\PY{p}{(}\PY{p}{)}
        \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{weight}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FIPS}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{map}\PY{p}{(}\PY{k}{lambda} \PY{n}{x}\PY{p}{:} \PY{l+m+mi}{1} \PY{o}{/} \PY{n}{county\PYZus{}unem}\PY{o}{.}\PY{n}{get}\PY{p}{(}\PY{n}{x}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{nan}\PY{p}{)}\PY{p}{)}
        \PY{n}{df} \PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{replace}\PY{p}{(}\PY{p}{[}\PY{n}{np}\PY{o}{.}\PY{n}{inf}\PY{p}{,} \PY{o}{\PYZhy{}}\PY{n}{np}\PY{o}{.}\PY{n}{inf}\PY{p}{]}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{nan}\PY{p}{)}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{n}{subset}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{weight}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}

    \PY{n}{results} \PY{o}{=} \PY{p}{[}\PY{p}{]}
    \PY{n}{residuals\PYZus{}dict} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
    \PY{n}{best\PYZus{}folds\PYZus{}data} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}

    \PY{k}{if} \PY{n}{always\PYZus{}include} \PY{o+ow}{is} \PY{k+kc}{None}\PY{p}{:}
        \PY{n}{always\PYZus{}include} \PY{o}{=} \PY{p}{[}\PY{p}{]}
    \PY{k}{if} \PY{n}{never\PYZus{}include} \PY{o+ow}{is} \PY{k+kc}{None}\PY{p}{:}
        \PY{n}{never\PYZus{}include} \PY{o}{=} \PY{p}{[}\PY{p}{]}

    \PY{n}{independent\PYZus{}vars} \PY{o}{=} \PY{p}{[}\PY{n}{var} \PY{k}{for} \PY{n}{var} \PY{o+ow}{in} \PY{n}{independent\PYZus{}vars} \PY{k}{if} \PY{n}{var} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{never\PYZus{}include}\PY{p}{]}

    \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n+nb}{len}\PY{p}{(}\PY{n}{independent\PYZus{}vars}\PY{p}{)} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{:}
        \PY{k}{for} \PY{n}{combo} \PY{o+ow}{in} \PY{n}{itertools}\PY{o}{.}\PY{n}{combinations}\PY{p}{(}\PY{n}{independent\PYZus{}vars}\PY{p}{,} \PY{n}{i}\PY{p}{)}\PY{p}{:}
            \PY{n}{combo} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n}{always\PYZus{}include}\PY{p}{)} \PY{o}{+} \PY{n+nb}{list}\PY{p}{(}\PY{n}{combo}\PY{p}{)}
            \PY{n}{X} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{n}{combo}\PY{p}{]}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}

            \PY{k}{if} \PY{n}{include\PYZus{}constant}\PY{p}{:}
                \PY{n}{X} \PY{o}{=} \PY{n}{sm}\PY{o}{.}\PY{n}{add\PYZus{}constant}\PY{p}{(}\PY{n}{X}\PY{p}{,} \PY{n}{has\PYZus{}constant}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{add}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
                \PY{n}{combo\PYZus{}with\PYZus{}const} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{const}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{+} \PY{n}{combo}
            \PY{k}{else}\PY{p}{:}
                \PY{n}{combo\PYZus{}with\PYZus{}const} \PY{o}{=} \PY{n}{combo}

            \PY{n}{kf} \PY{o}{=} \PY{n}{KFold}\PY{p}{(}\PY{n}{n\PYZus{}splits}\PY{o}{=}\PY{n}{n\PYZus{}splits}\PY{p}{,} \PY{n}{shuffle}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{n}{random\PYZus{}state}\PY{p}{)}
            \PY{n}{mse\PYZus{}list} \PY{o}{=} \PY{p}{[}\PY{p}{]}
            \PY{n}{r\PYZus{}squared\PYZus{}list} \PY{o}{=} \PY{p}{[}\PY{p}{]}
            \PY{n}{beta\PYZus{}estimates} \PY{o}{=} \PY{p}{[}\PY{p}{]}
            \PY{n}{std\PYZus{}errors} \PY{o}{=} \PY{p}{[}\PY{p}{]}
            \PY{n}{p\PYZus{}values} \PY{o}{=} \PY{p}{[}\PY{p}{]}
            \PY{n}{fold\PYZus{}residuals\PYZus{}list} \PY{o}{=} \PY{p}{[}\PY{p}{]}
            \PY{n}{fold\PYZus{}data\PYZus{}list} \PY{o}{=} \PY{p}{[}\PY{p}{]}

            \PY{k}{for} \PY{n}{train\PYZus{}index}\PY{p}{,} \PY{n}{test\PYZus{}index} \PY{o+ow}{in} \PY{n}{kf}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{n}{X}\PY{p}{)}\PY{p}{:}
                \PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{X\PYZus{}test} \PY{o}{=} \PY{n}{X}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{train\PYZus{}index}\PY{p}{]}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{n}{drop}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}\PY{p}{,} \PY{n}{X}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{test\PYZus{}index}\PY{p}{]}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{n}{drop}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
                \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}test} \PY{o}{=} \PY{n}{y}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{train\PYZus{}index}\PY{p}{]}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{n}{drop}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}\PY{p}{,} \PY{n}{y}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{test\PYZus{}index}\PY{p}{]}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{n}{drop}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}

                \PY{k}{if} \PY{n}{model\PYZus{}type} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ols}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
                    \PY{n}{model} \PY{o}{=} \PY{n}{sm}\PY{o}{.}\PY{n}{OLS}\PY{p}{(}\PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{X\PYZus{}train}\PY{p}{)}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{p}{)}
                \PY{k}{elif} \PY{n}{model\PYZus{}type} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{wls}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
                    \PY{n}{weights} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{weight}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{train\PYZus{}index}\PY{p}{]}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{n}{drop}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
                    \PY{n}{model} \PY{o}{=} \PY{n}{sm}\PY{o}{.}\PY{n}{WLS}\PY{p}{(}\PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{weights}\PY{o}{=}\PY{n}{weights}\PY{p}{)}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{p}{)}

                \PY{n}{y\PYZus{}pred} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}
                \PY{n}{mse} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{(}\PY{n}{y\PYZus{}test} \PY{o}{\PYZhy{}} \PY{n}{y\PYZus{}pred}\PY{p}{)} \PY{o}{*}\PY{o}{*} \PY{l+m+mi}{2}\PY{p}{)}
                \PY{n}{mse\PYZus{}list}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{mse}\PY{p}{)}
                \PY{n}{r\PYZus{}squared} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{rsquared}
                \PY{n}{r\PYZus{}squared\PYZus{}list}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{r\PYZus{}squared}\PY{p}{)}
                \PY{n}{beta\PYZus{}estimates}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{model}\PY{o}{.}\PY{n}{params}\PY{p}{)}
                \PY{n}{std\PYZus{}errors}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{model}\PY{o}{.}\PY{n}{bse}\PY{p}{)}
                \PY{n}{p\PYZus{}values}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{model}\PY{o}{.}\PY{n}{pvalues}\PY{p}{)}

                \PY{n}{fold\PYZus{}residuals} \PY{o}{=} \PY{p}{\PYZob{}}\PY{n}{var}\PY{p}{:} \PY{p}{[}\PY{p}{]} \PY{k}{for} \PY{n}{var} \PY{o+ow}{in} \PY{p}{[}\PY{n}{dependent\PYZus{}var}\PY{p}{]} \PY{o}{+} \PY{n}{combo\PYZus{}with\PYZus{}const} \PY{k}{if} \PY{n}{var} \PY{o}{!=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{const}\PY{l+s+s1}{\PYZsq{}}\PY{p}{\PYZcb{}}
                \PY{n}{residuals\PYZus{}y} \PY{o}{=} \PY{n}{y\PYZus{}test} \PY{o}{\PYZhy{}} \PY{n}{y\PYZus{}pred}
                \PY{n}{fold\PYZus{}residuals}\PY{p}{[}\PY{n}{dependent\PYZus{}var}\PY{p}{]}\PY{o}{.}\PY{n}{extend}\PY{p}{(}\PY{n}{residuals\PYZus{}y}\PY{p}{)}

                \PY{c+c1}{\PYZsh{} Calculate and store residuals for independent variables}
                \PY{k}{for} \PY{n}{var} \PY{o+ow}{in} \PY{n}{combo\PYZus{}with\PYZus{}const}\PY{p}{:}
                    \PY{k}{if} \PY{n}{var} \PY{o}{!=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{const}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
                        \PY{n}{residuals\PYZus{}X} \PY{o}{=} \PY{n}{X\PYZus{}test}\PY{p}{[}\PY{n}{var}\PY{p}{]} \PY{o}{\PYZhy{}} \PY{n}{model}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}
                        \PY{n}{fold\PYZus{}residuals}\PY{p}{[}\PY{n}{var}\PY{p}{]}\PY{o}{.}\PY{n}{extend}\PY{p}{(}\PY{n}{residuals\PYZus{}X}\PY{p}{)}
                
                \PY{n}{fold\PYZus{}residuals\PYZus{}list}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{fold\PYZus{}residuals}\PY{p}{)}
                \PY{n}{fold\PYZus{}data\PYZus{}list}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{X\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{)}

            \PY{n}{top\PYZus{}3\PYZus{}indices} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{argsort}\PY{p}{(}\PY{n}{mse\PYZus{}list}\PY{p}{)}\PY{p}{[}\PY{p}{:}\PY{l+m+mi}{3}\PY{p}{]}
            \PY{n}{avg\PYZus{}top\PYZus{}3\PYZus{}mse} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{[}\PY{n}{mse\PYZus{}list}\PY{p}{[}\PY{n}{idx}\PY{p}{]} \PY{k}{for} \PY{n}{idx} \PY{o+ow}{in} \PY{n}{top\PYZus{}3\PYZus{}indices}\PY{p}{]}\PY{p}{)}
            \PY{n}{avg\PYZus{}beta\PYZus{}estimates} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{[}\PY{n}{beta\PYZus{}estimates}\PY{p}{[}\PY{n}{idx}\PY{p}{]} \PY{k}{for} \PY{n}{idx} \PY{o+ow}{in} \PY{n}{top\PYZus{}3\PYZus{}indices}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
            \PY{n}{avg\PYZus{}std\PYZus{}errors} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{[}\PY{n}{std\PYZus{}errors}\PY{p}{[}\PY{n}{idx}\PY{p}{]} \PY{k}{for} \PY{n}{idx} \PY{o+ow}{in} \PY{n}{top\PYZus{}3\PYZus{}indices}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
            \PY{n}{avg\PYZus{}p\PYZus{}values} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{[}\PY{n}{p\PYZus{}values}\PY{p}{[}\PY{n}{idx}\PY{p}{]} \PY{k}{for} \PY{n}{idx} \PY{o+ow}{in} \PY{n}{top\PYZus{}3\PYZus{}indices}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
            \PY{n}{avg\PYZus{}r\PYZus{}squared} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{[}\PY{n}{r\PYZus{}squared\PYZus{}list}\PY{p}{[}\PY{n}{idx}\PY{p}{]} \PY{k}{for} \PY{n}{idx} \PY{o+ow}{in} \PY{n}{top\PYZus{}3\PYZus{}indices}\PY{p}{]}\PY{p}{)}

            \PY{n}{sorted\PYZus{}combo\PYZus{}with\PYZus{}const} \PY{o}{=} \PY{n+nb}{sorted}\PY{p}{(}\PY{n}{combo\PYZus{}with\PYZus{}const}\PY{p}{)}

            \PY{n}{result} \PY{o}{=} \PY{p}{\PYZob{}}
                \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DataFrame}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{df\PYZus{}name}\PY{p}{,}
                \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Model}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{, }\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{sorted\PYZus{}combo\PYZus{}with\PYZus{}const}\PY{p}{)}\PY{p}{,}
                \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r\PYZhy{}squared}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{avg\PYZus{}r\PYZus{}squared}\PY{p}{,}
                \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{avg\PYZus{}top\PYZus{}3\PYZus{}mse}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{avg\PYZus{}top\PYZus{}3\PYZus{}mse}\PY{p}{,}
                \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Variables}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZlt{}br\PYZgt{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{join}\PY{p}{(}
                    \PY{p}{[}\PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}}\PY{n}{sorted\PYZus{}combo\PYZus{}with\PYZus{}const}\PY{p}{[}\PY{n}{idx}\PY{p}{]}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{: }\PY{l+s+si}{\PYZob{}}\PY{n}{avg\PYZus{}beta\PYZus{}estimates}\PY{p}{[}\PY{n}{idx}\PY{p}{]}\PY{l+s+si}{:}\PY{l+s+s1}{.4f}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{ (SE: }\PY{l+s+si}{\PYZob{}}\PY{n}{avg\PYZus{}std\PYZus{}errors}\PY{p}{[}\PY{n}{idx}\PY{p}{]}\PY{l+s+si}{:}\PY{l+s+s1}{.4f}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{, p: }\PY{l+s+si}{\PYZob{}}\PY{n}{avg\PYZus{}p\PYZus{}values}\PY{p}{[}\PY{n}{idx}\PY{p}{]}\PY{l+s+si}{:}\PY{l+s+s1}{.4f}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{)}\PY{l+s+s1}{\PYZsq{}} \PY{k}{for} \PY{n}{idx} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{sorted\PYZus{}combo\PYZus{}with\PYZus{}const}\PY{p}{)}\PY{p}{)}\PY{p}{]}\PY{p}{)}
            \PY{p}{\PYZcb{}}
            \PY{k}{for} \PY{n}{idx}\PY{p}{,} \PY{n}{var} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{sorted\PYZus{}combo\PYZus{}with\PYZus{}const}\PY{p}{)}\PY{p}{:}
                \PY{k}{if} \PY{n}{var} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{const}\PY{l+s+s1}{\PYZsq{}} \PY{o+ow}{and} \PY{o+ow}{not} \PY{n}{include\PYZus{}constant}\PY{p}{:}
                    \PY{n}{result}\PY{p}{[}\PY{n}{var}\PY{p}{]} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{nan}
                    \PY{n}{result}\PY{p}{[}\PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}}\PY{n}{var}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{\PYZus{}SE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{nan}
                    \PY{n}{result}\PY{p}{[}\PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}}\PY{n}{var}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{\PYZus{}p}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{nan}
                \PY{k}{else}\PY{p}{:}
                    \PY{n}{result}\PY{p}{[}\PY{n}{var}\PY{p}{]} \PY{o}{=} \PY{n}{avg\PYZus{}beta\PYZus{}estimates}\PY{p}{[}\PY{n}{idx}\PY{p}{]}
                    \PY{n}{result}\PY{p}{[}\PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}}\PY{n}{var}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{\PYZus{}SE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{avg\PYZus{}std\PYZus{}errors}\PY{p}{[}\PY{n}{idx}\PY{p}{]}
                    \PY{n}{result}\PY{p}{[}\PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}}\PY{n}{var}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{\PYZus{}p}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{avg\PYZus{}p\PYZus{}values}\PY{p}{[}\PY{n}{idx}\PY{p}{]}
            \PY{n}{results}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{result}\PY{p}{)}

            \PY{c+c1}{\PYZsh{} Calculate residuals for the average model based on the top 3 lowest MSEs}
            \PY{n}{all\PYZus{}residuals} \PY{o}{=} \PY{p}{[}\PY{p}{]}
            \PY{k}{for} \PY{n}{idx} \PY{o+ow}{in} \PY{n}{top\PYZus{}3\PYZus{}indices}\PY{p}{:}
                \PY{n}{train\PYZus{}index}\PY{p}{,} \PY{n}{test\PYZus{}index} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n}{kf}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{n}{X}\PY{p}{)}\PY{p}{)}\PY{p}{[}\PY{n}{idx}\PY{p}{]}
                \PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{X\PYZus{}test} \PY{o}{=} \PY{n}{X}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{train\PYZus{}index}\PY{p}{]}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{n}{drop}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}\PY{p}{,} \PY{n}{X}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{test\PYZus{}index}\PY{p}{]}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{n}{drop}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
                \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}test} \PY{o}{=} \PY{n}{y}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{train\PYZus{}index}\PY{p}{]}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{n}{drop}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}\PY{p}{,} \PY{n}{y}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{test\PYZus{}index}\PY{p}{]}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{n}{drop}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}

                \PY{k}{if} \PY{n}{model\PYZus{}type} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ols}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
                    \PY{n}{model} \PY{o}{=} \PY{n}{sm}\PY{o}{.}\PY{n}{OLS}\PY{p}{(}\PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{X\PYZus{}train}\PY{p}{)}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{p}{)}
                \PY{k}{elif} \PY{n}{model\PYZus{}type} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{wls}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
                    \PY{n}{weights} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{weight}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{train\PYZus{}index}\PY{p}{]}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{n}{drop}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
                    \PY{n}{model} \PY{o}{=} \PY{n}{sm}\PY{o}{.}\PY{n}{WLS}\PY{p}{(}\PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{weights}\PY{o}{=}\PY{n}{weights}\PY{p}{)}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{p}{)}

                \PY{n}{y\PYZus{}pred} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}
                \PY{n}{residuals\PYZus{}y} \PY{o}{=} \PY{n}{y\PYZus{}test} \PY{o}{\PYZhy{}} \PY{n}{y\PYZus{}pred}
                \PY{n}{residuals\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s2}{epsilon\PYZus{}}\PY{l+s+se}{\PYZob{}\PYZob{}}\PY{l+s+si}{\PYZob{}}\PY{n}{dependent\PYZus{}var}\PY{l+s+si}{\PYZcb{}}\PY{l+s+se}{\PYZcb{}\PYZcb{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{n}{residuals\PYZus{}y}\PY{p}{\PYZcb{}}\PY{p}{)}
                
                \PY{c+c1}{\PYZsh{} Calculate residuals for independent variables}
                \PY{k}{for} \PY{n}{var} \PY{o+ow}{in} \PY{n}{combo\PYZus{}with\PYZus{}const}\PY{p}{:}
                    \PY{k}{if} \PY{n}{var} \PY{o}{!=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{const}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
                        \PY{n}{residuals\PYZus{}X} \PY{o}{=} \PY{n}{X\PYZus{}test}\PY{p}{[}\PY{n}{var}\PY{p}{]} \PY{o}{\PYZhy{}} \PY{n}{model}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}
                        \PY{n}{residuals\PYZus{}df}\PY{p}{[}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s2}{epsilon\PYZus{}}\PY{l+s+se}{\PYZob{}\PYZob{}}\PY{l+s+si}{\PYZob{}}\PY{n}{var}\PY{l+s+si}{\PYZcb{}}\PY{l+s+se}{\PYZcb{}\PYZcb{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{residuals\PYZus{}X}

                \PY{n}{all\PYZus{}residuals}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{residuals\PYZus{}df}\PY{p}{)}
            
            \PY{c+c1}{\PYZsh{} Average residuals across top 3 models}
            \PY{n}{avg\PYZus{}residuals} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{concat}\PY{p}{(}\PY{n}{all\PYZus{}residuals}\PY{p}{)}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{n}{level}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}
            \PY{n}{sorted\PYZus{}combo} \PY{o}{=} \PY{n+nb}{tuple}\PY{p}{(}\PY{n+nb}{sorted}\PY{p}{(}\PY{n}{combo\PYZus{}with\PYZus{}const}\PY{p}{)}\PY{p}{)}
            \PY{n}{residuals\PYZus{}dict}\PY{p}{[}\PY{n}{sorted\PYZus{}combo}\PY{p}{]} \PY{o}{=} \PY{n}{avg\PYZus{}residuals}
            
            \PY{c+c1}{\PYZsh{} Save the best fold data}
            \PY{n}{best\PYZus{}fold\PYZus{}index} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{argmin}\PY{p}{(}\PY{n}{mse\PYZus{}list}\PY{p}{)}
            \PY{n}{best\PYZus{}folds\PYZus{}data}\PY{p}{[}\PY{n}{sorted\PYZus{}combo}\PY{p}{]} \PY{o}{=} \PY{n}{fold\PYZus{}data\PYZus{}list}\PY{p}{[}\PY{n}{best\PYZus{}fold\PYZus{}index}\PY{p}{]}

    \PY{n}{results\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{results}\PY{p}{)}
    \PY{k}{return} \PY{n}{results\PYZus{}df}\PY{p}{,} \PY{n}{residuals\PYZus{}dict}\PY{p}{,} \PY{n}{best\PYZus{}folds\PYZus{}data}

\PY{c+c1}{\PYZsh{} \PYZsh{} Usage example}
\PY{c+c1}{\PYZsh{} results\PYZus{}ols\PYZus{}rates\PYZus{}clusters\PYZus{}efw\PYZus{}k, residuals\PYZus{}ols\PYZus{}rates\PYZus{}clusters\PYZus{}efw\PYZus{}k, best\PYZus{}fold\PYZus{}data\PYZus{}ols = ols\PYZus{}wls\PYZus{}combinations\PYZus{}kfold(}
\PY{c+c1}{\PYZsh{}     df\PYZus{}rates, dv, iv, model\PYZus{}type=\PYZsq{}ols\PYZsq{}, always\PYZus{}include=None, never\PYZus{}include=None, df\PYZus{}name=\PYZsq{}Rates ols)\PYZsq{}, }
\PY{c+c1}{\PYZsh{}     include\PYZus{}constant=True, n\PYZus{}splits=5, random\PYZus{}state=42)}

\PY{c+c1}{\PYZsh{} Function to get merged data from best\PYZus{}fold\PYZus{}data regardless of order}
\PY{k}{def} \PY{n+nf}{get\PYZus{}best\PYZus{}fold\PYZus{}data\PYZus{}merged}\PY{p}{(}\PY{n}{best\PYZus{}fold\PYZus{}data}\PY{p}{,} \PY{o}{*}\PY{n+nb}{vars}\PY{p}{)}\PY{p}{:}
    \PY{n}{sorted\PYZus{}vars} \PY{o}{=} \PY{n+nb}{tuple}\PY{p}{(}\PY{n+nb}{sorted}\PY{p}{(}\PY{n+nb}{vars}\PY{p}{)}\PY{p}{)}
    \PY{k}{if} \PY{n}{sorted\PYZus{}vars} \PY{o+ow}{in} \PY{n}{best\PYZus{}fold\PYZus{}data}\PY{p}{:}
        \PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{X\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}test} \PY{o}{=} \PY{n}{best\PYZus{}fold\PYZus{}data}\PY{p}{[}\PY{n}{sorted\PYZus{}vars}\PY{p}{]}
        \PY{n}{train\PYZus{}data} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{concat}\PY{p}{(}\PY{p}{[}\PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
        \PY{n}{test\PYZus{}data} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{concat}\PY{p}{(}\PY{p}{[}\PY{n}{X\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}test}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
        \PY{k}{return} \PY{n}{train\PYZus{}data}\PY{p}{,} \PY{n}{test\PYZus{}data}
    \PY{k}{else}\PY{p}{:}
        \PY{k}{raise} \PY{n+ne}{KeyError}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Combination }\PY{l+s+si}{\PYZob{}}\PY{n}{sorted\PYZus{}vars}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{ not found in best\PYZus{}fold\PYZus{}data.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}

\PY{c+c1}{\PYZsh{} \PYZsh{} Access the best fold data without considering order and merge it}
\PY{c+c1}{\PYZsh{} try:}
\PY{c+c1}{\PYZsh{}     train\PYZus{}data, test\PYZus{}data = get\PYZus{}best\PYZus{}fold\PYZus{}data\PYZus{}merged(best\PYZus{}fold\PYZus{}data\PYZus{}ols, \PYZsq{}clusters\PYZus{}2.0\PYZsq{}, \PYZsq{}Agri\PYZsq{}, \PYZsq{}const\PYZsq{})}
\PY{c+c1}{\PYZsh{}     print(\PYZdq{}Best fold data accessed and merged successfully.\PYZdq{})}
\PY{c+c1}{\PYZsh{} except KeyError as e:}
\PY{c+c1}{\PYZsh{}     print(e)}

\PY{c+c1}{\PYZsh{} \PYZsh{} Save to CSV}
\PY{c+c1}{\PYZsh{} train\PYZus{}data.to\PYZus{}csv(\PYZsq{}best\PYZus{}fold\PYZus{}train\PYZus{}data.csv\PYZsq{}, index=False)}
\PY{c+c1}{\PYZsh{} test\PYZus{}data.to\PYZus{}csv(\PYZsq{}best\PYZus{}fold\PYZus{}test\PYZus{}data.csv\PYZsq{}, index=False)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{9}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import} \PY{n+nn}{itertools}
\PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
\PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
\PY{k+kn}{import} \PY{n+nn}{statsmodels}\PY{n+nn}{.}\PY{n+nn}{api} \PY{k}{as} \PY{n+nn}{sm}
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{model\PYZus{}selection} \PY{k+kn}{import} \PY{n}{KFold}

\PY{k}{def} \PY{n+nf}{calculate\PYZus{}residuals\PYZus{}k}\PY{p}{(}\PY{n}{df}\PY{p}{,} \PY{n}{y\PYZus{}var}\PY{p}{,} \PY{n}{X\PYZus{}vars}\PY{p}{,} \PY{n}{model\PYZus{}type}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ols}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{weights}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,} \PY{n}{include\PYZus{}constant}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{p}{:}
    \PY{n}{residuals} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
    \PY{k}{for} \PY{n}{var} \PY{o+ow}{in} \PY{p}{[}\PY{n}{y\PYZus{}var}\PY{p}{]} \PY{o}{+} \PY{n}{X\PYZus{}vars}\PY{p}{:}
        \PY{n}{other\PYZus{}vars} \PY{o}{=} \PY{p}{[}\PY{n}{v} \PY{k}{for} \PY{n}{v} \PY{o+ow}{in} \PY{p}{[}\PY{n}{y\PYZus{}var}\PY{p}{]} \PY{o}{+} \PY{n}{X\PYZus{}vars} \PY{k}{if} \PY{n}{v} \PY{o}{!=} \PY{n}{var}\PY{p}{]}
        \PY{n}{X} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{n}{other\PYZus{}vars}\PY{p}{]}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}
        \PY{k}{if} \PY{n}{include\PYZus{}constant}\PY{p}{:}
            \PY{n}{X} \PY{o}{=} \PY{n}{sm}\PY{o}{.}\PY{n}{add\PYZus{}constant}\PY{p}{(}\PY{n}{X}\PY{p}{,} \PY{n}{has\PYZus{}constant}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{add}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{y} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{n}{var}\PY{p}{]}
        
        \PY{k}{if} \PY{n}{model\PYZus{}type} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ols}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
            \PY{n}{model} \PY{o}{=} \PY{n}{sm}\PY{o}{.}\PY{n}{OLS}\PY{p}{(}\PY{n}{y}\PY{p}{,} \PY{n}{X}\PY{p}{)}
        \PY{k}{elif} \PY{n}{model\PYZus{}type} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{wls}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
            \PY{n}{model} \PY{o}{=} \PY{n}{sm}\PY{o}{.}\PY{n}{WLS}\PY{p}{(}\PY{n}{y}\PY{p}{,} \PY{n}{X}\PY{p}{,} \PY{n}{weights}\PY{o}{=}\PY{n}{weights}\PY{p}{)}
        
        \PY{n}{results} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{p}{)}
        \PY{n}{residuals}\PY{p}{[}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s2}{epsilon\PYZus{}}\PY{l+s+se}{\PYZob{}\PYZob{}}\PY{l+s+si}{\PYZob{}}\PY{n}{var}\PY{l+s+si}{\PYZcb{}}\PY{l+s+se}{\PYZcb{}\PYZcb{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{results}\PY{o}{.}\PY{n}{resid}
    \PY{k}{return} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{residuals}\PY{p}{)}

\PY{k}{def} \PY{n+nf}{ols\PYZus{}wls\PYZus{}combinations\PYZus{}kfold}\PY{p}{(}\PY{n}{df}\PY{p}{,} \PY{n}{dependent\PYZus{}var}\PY{p}{,} \PY{n}{independent\PYZus{}vars}\PY{p}{,} \PY{n}{model\PYZus{}type}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ols}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} 
                               \PY{n}{always\PYZus{}include}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,} \PY{n}{never\PYZus{}include}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,} \PY{n}{df\PYZus{}name}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{df}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} 
                               \PY{n}{include\PYZus{}constant}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,} \PY{n}{n\PYZus{}splits}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{k+kc}{None}\PY{p}{)}\PY{p}{:}
    \PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{seed}\PY{p}{(}\PY{n}{random\PYZus{}state}\PY{p}{)}
    \PY{n}{df} \PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{replace}\PY{p}{(}\PY{p}{[}\PY{n}{np}\PY{o}{.}\PY{n}{inf}\PY{p}{,} \PY{o}{\PYZhy{}}\PY{n}{np}\PY{o}{.}\PY{n}{inf}\PY{p}{]}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{nan}\PY{p}{)}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{p}{)}

    \PY{n}{y} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{n}{dependent\PYZus{}var}\PY{p}{]}

    \PY{k}{if} \PY{n}{model\PYZus{}type} \PY{o+ow}{not} \PY{o+ow}{in} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ols}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{wls}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{:}
        \PY{k}{raise} \PY{n+ne}{ValueError}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{model\PYZus{}type must be either }\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{ols}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{ or }\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{wls}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}

    \PY{k}{if} \PY{n}{model\PYZus{}type} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{wls}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
        \PY{c+c1}{\PYZsh{} Calculate weights for WLS}
        \PY{n}{county\PYZus{}unem} \PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FIPS}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{[}\PY{n}{dependent\PYZus{}var}\PY{p}{]}\PY{o}{.}\PY{n}{var}\PY{p}{(}\PY{p}{)}
        \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{weight}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FIPS}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{map}\PY{p}{(}\PY{k}{lambda} \PY{n}{x}\PY{p}{:} \PY{l+m+mi}{1} \PY{o}{/} \PY{n}{county\PYZus{}unem}\PY{o}{.}\PY{n}{get}\PY{p}{(}\PY{n}{x}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{nan}\PY{p}{)}\PY{p}{)}
        \PY{n}{df} \PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{replace}\PY{p}{(}\PY{p}{[}\PY{n}{np}\PY{o}{.}\PY{n}{inf}\PY{p}{,} \PY{o}{\PYZhy{}}\PY{n}{np}\PY{o}{.}\PY{n}{inf}\PY{p}{]}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{nan}\PY{p}{)}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{n}{subset}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{weight}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}

    \PY{n}{results} \PY{o}{=} \PY{p}{[}\PY{p}{]}
    \PY{n}{residuals\PYZus{}dict} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
    \PY{n}{best\PYZus{}folds\PYZus{}data} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}

    \PY{k}{if} \PY{n}{always\PYZus{}include} \PY{o+ow}{is} \PY{k+kc}{None}\PY{p}{:}
        \PY{n}{always\PYZus{}include} \PY{o}{=} \PY{p}{[}\PY{p}{]}
    \PY{k}{if} \PY{n}{never\PYZus{}include} \PY{o+ow}{is} \PY{k+kc}{None}\PY{p}{:}
        \PY{n}{never\PYZus{}include} \PY{o}{=} \PY{p}{[}\PY{p}{]}

    \PY{n}{independent\PYZus{}vars} \PY{o}{=} \PY{p}{[}\PY{n}{var} \PY{k}{for} \PY{n}{var} \PY{o+ow}{in} \PY{n}{independent\PYZus{}vars} \PY{k}{if} \PY{n}{var} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{never\PYZus{}include}\PY{p}{]}

    \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n+nb}{len}\PY{p}{(}\PY{n}{independent\PYZus{}vars}\PY{p}{)} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{:}
        \PY{k}{for} \PY{n}{combo} \PY{o+ow}{in} \PY{n}{itertools}\PY{o}{.}\PY{n}{combinations}\PY{p}{(}\PY{n}{independent\PYZus{}vars}\PY{p}{,} \PY{n}{i}\PY{p}{)}\PY{p}{:}
            \PY{n}{combo} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n}{always\PYZus{}include}\PY{p}{)} \PY{o}{+} \PY{n+nb}{list}\PY{p}{(}\PY{n}{combo}\PY{p}{)}
            \PY{n}{X} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{n}{combo}\PY{p}{]}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}

            \PY{k}{if} \PY{n}{include\PYZus{}constant}\PY{p}{:}
                \PY{n}{X} \PY{o}{=} \PY{n}{sm}\PY{o}{.}\PY{n}{add\PYZus{}constant}\PY{p}{(}\PY{n}{X}\PY{p}{,} \PY{n}{has\PYZus{}constant}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{add}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
                \PY{n}{combo\PYZus{}with\PYZus{}const} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{const}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{+} \PY{n}{combo}
            \PY{k}{else}\PY{p}{:}
                \PY{n}{combo\PYZus{}with\PYZus{}const} \PY{o}{=} \PY{n}{combo}

            \PY{n}{kf} \PY{o}{=} \PY{n}{KFold}\PY{p}{(}\PY{n}{n\PYZus{}splits}\PY{o}{=}\PY{n}{n\PYZus{}splits}\PY{p}{,} \PY{n}{shuffle}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{n}{random\PYZus{}state}\PY{p}{)}
            \PY{n}{mse\PYZus{}list} \PY{o}{=} \PY{p}{[}\PY{p}{]}
            \PY{n}{r\PYZus{}squared\PYZus{}list} \PY{o}{=} \PY{p}{[}\PY{p}{]}
            \PY{n}{beta\PYZus{}estimates} \PY{o}{=} \PY{p}{[}\PY{p}{]}
            \PY{n}{std\PYZus{}errors} \PY{o}{=} \PY{p}{[}\PY{p}{]}
            \PY{n}{p\PYZus{}values} \PY{o}{=} \PY{p}{[}\PY{p}{]}
            \PY{n}{fold\PYZus{}residuals\PYZus{}list} \PY{o}{=} \PY{p}{[}\PY{p}{]}
            \PY{n}{fold\PYZus{}data\PYZus{}list} \PY{o}{=} \PY{p}{[}\PY{p}{]}

            \PY{k}{for} \PY{n}{train\PYZus{}index}\PY{p}{,} \PY{n}{test\PYZus{}index} \PY{o+ow}{in} \PY{n}{kf}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{n}{X}\PY{p}{)}\PY{p}{:}
                \PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{X\PYZus{}test} \PY{o}{=} \PY{n}{X}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{train\PYZus{}index}\PY{p}{]}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{n}{drop}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}\PY{p}{,} \PY{n}{X}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{test\PYZus{}index}\PY{p}{]}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{n}{drop}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
                \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}test} \PY{o}{=} \PY{n}{y}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{train\PYZus{}index}\PY{p}{]}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{n}{drop}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}\PY{p}{,} \PY{n}{y}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{test\PYZus{}index}\PY{p}{]}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{n}{drop}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}

                \PY{k}{if} \PY{n}{model\PYZus{}type} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ols}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
                    \PY{n}{model} \PY{o}{=} \PY{n}{sm}\PY{o}{.}\PY{n}{OLS}\PY{p}{(}\PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{X\PYZus{}train}\PY{p}{)}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{p}{)}
                \PY{k}{elif} \PY{n}{model\PYZus{}type} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{wls}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
                    \PY{n}{weights} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{weight}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{train\PYZus{}index}\PY{p}{]}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{n}{drop}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
                    \PY{n}{model} \PY{o}{=} \PY{n}{sm}\PY{o}{.}\PY{n}{WLS}\PY{p}{(}\PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{weights}\PY{o}{=}\PY{n}{weights}\PY{p}{)}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{p}{)}

                \PY{n}{y\PYZus{}pred} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}
                \PY{n}{mse} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{(}\PY{n}{y\PYZus{}test} \PY{o}{\PYZhy{}} \PY{n}{y\PYZus{}pred}\PY{p}{)} \PY{o}{*}\PY{o}{*} \PY{l+m+mi}{2}\PY{p}{)}
                \PY{n}{mse\PYZus{}list}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{mse}\PY{p}{)}
                \PY{n}{r\PYZus{}squared} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{rsquared}
                \PY{n}{r\PYZus{}squared\PYZus{}list}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{r\PYZus{}squared}\PY{p}{)}
                \PY{n}{beta\PYZus{}estimates}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{model}\PY{o}{.}\PY{n}{params}\PY{p}{)}
                \PY{n}{std\PYZus{}errors}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{model}\PY{o}{.}\PY{n}{bse}\PY{p}{)}
                \PY{n}{p\PYZus{}values}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{model}\PY{o}{.}\PY{n}{pvalues}\PY{p}{)}

                \PY{n}{fold\PYZus{}residuals} \PY{o}{=} \PY{p}{\PYZob{}}\PY{n}{var}\PY{p}{:} \PY{p}{[}\PY{p}{]} \PY{k}{for} \PY{n}{var} \PY{o+ow}{in} \PY{p}{[}\PY{n}{dependent\PYZus{}var}\PY{p}{]} \PY{o}{+} \PY{n}{combo\PYZus{}with\PYZus{}const} \PY{k}{if} \PY{n}{var} \PY{o}{!=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{const}\PY{l+s+s1}{\PYZsq{}}\PY{p}{\PYZcb{}}
                \PY{n}{residuals\PYZus{}y} \PY{o}{=} \PY{n}{y\PYZus{}test} \PY{o}{\PYZhy{}} \PY{n}{y\PYZus{}pred}
                \PY{n}{fold\PYZus{}residuals}\PY{p}{[}\PY{n}{dependent\PYZus{}var}\PY{p}{]}\PY{o}{.}\PY{n}{extend}\PY{p}{(}\PY{n}{residuals\PYZus{}y}\PY{p}{)}

                \PY{c+c1}{\PYZsh{} Calculate and store residuals for independent variables}
                \PY{k}{for} \PY{n}{var} \PY{o+ow}{in} \PY{n}{combo\PYZus{}with\PYZus{}const}\PY{p}{:}
                    \PY{k}{if} \PY{n}{var} \PY{o}{!=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{const}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
                        \PY{n}{residuals\PYZus{}X} \PY{o}{=} \PY{n}{X\PYZus{}test}\PY{p}{[}\PY{n}{var}\PY{p}{]} \PY{o}{\PYZhy{}} \PY{n}{model}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}
                        \PY{n}{fold\PYZus{}residuals}\PY{p}{[}\PY{n}{var}\PY{p}{]}\PY{o}{.}\PY{n}{extend}\PY{p}{(}\PY{n}{residuals\PYZus{}X}\PY{p}{)}
                
                \PY{n}{fold\PYZus{}residuals\PYZus{}list}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{fold\PYZus{}residuals}\PY{p}{)}
                \PY{n}{fold\PYZus{}data\PYZus{}list}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{X\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{)}

            \PY{n}{top\PYZus{}3\PYZus{}indices} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{argsort}\PY{p}{(}\PY{n}{mse\PYZus{}list}\PY{p}{)}\PY{p}{[}\PY{p}{:}\PY{l+m+mi}{3}\PY{p}{]}
            \PY{n}{avg\PYZus{}top\PYZus{}3\PYZus{}mse} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{[}\PY{n}{mse\PYZus{}list}\PY{p}{[}\PY{n}{idx}\PY{p}{]} \PY{k}{for} \PY{n}{idx} \PY{o+ow}{in} \PY{n}{top\PYZus{}3\PYZus{}indices}\PY{p}{]}\PY{p}{)}
            \PY{n}{avg\PYZus{}beta\PYZus{}estimates} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{[}\PY{n}{beta\PYZus{}estimates}\PY{p}{[}\PY{n}{idx}\PY{p}{]} \PY{k}{for} \PY{n}{idx} \PY{o+ow}{in} \PY{n}{top\PYZus{}3\PYZus{}indices}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
            \PY{n}{avg\PYZus{}std\PYZus{}errors} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{[}\PY{n}{std\PYZus{}errors}\PY{p}{[}\PY{n}{idx}\PY{p}{]} \PY{k}{for} \PY{n}{idx} \PY{o+ow}{in} \PY{n}{top\PYZus{}3\PYZus{}indices}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
            \PY{n}{avg\PYZus{}p\PYZus{}values} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{[}\PY{n}{p\PYZus{}values}\PY{p}{[}\PY{n}{idx}\PY{p}{]} \PY{k}{for} \PY{n}{idx} \PY{o+ow}{in} \PY{n}{top\PYZus{}3\PYZus{}indices}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
            \PY{n}{avg\PYZus{}r\PYZus{}squared} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{[}\PY{n}{r\PYZus{}squared\PYZus{}list}\PY{p}{[}\PY{n}{idx}\PY{p}{]} \PY{k}{for} \PY{n}{idx} \PY{o+ow}{in} \PY{n}{top\PYZus{}3\PYZus{}indices}\PY{p}{]}\PY{p}{)}

            \PY{n}{sorted\PYZus{}combo\PYZus{}with\PYZus{}const} \PY{o}{=} \PY{n+nb}{sorted}\PY{p}{(}\PY{n}{combo\PYZus{}with\PYZus{}const}\PY{p}{)}

            \PY{n}{result} \PY{o}{=} \PY{p}{\PYZob{}}
                \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DataFrame}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{df\PYZus{}name}\PY{p}{,}
                \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Model}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{, }\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{sorted\PYZus{}combo\PYZus{}with\PYZus{}const}\PY{p}{)}\PY{p}{,}
                \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r\PYZhy{}squared}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{avg\PYZus{}r\PYZus{}squared}\PY{p}{,}
                \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{avg\PYZus{}top\PYZus{}3\PYZus{}mse}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{avg\PYZus{}top\PYZus{}3\PYZus{}mse}\PY{p}{,}
                \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Variables}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZlt{}br\PYZgt{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{join}\PY{p}{(}
                    \PY{p}{[}\PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}}\PY{n}{sorted\PYZus{}combo\PYZus{}with\PYZus{}const}\PY{p}{[}\PY{n}{idx}\PY{p}{]}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{: }\PY{l+s+si}{\PYZob{}}\PY{n}{avg\PYZus{}beta\PYZus{}estimates}\PY{p}{[}\PY{n}{idx}\PY{p}{]}\PY{l+s+si}{:}\PY{l+s+s1}{.4f}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{ (SE: }\PY{l+s+si}{\PYZob{}}\PY{n}{avg\PYZus{}std\PYZus{}errors}\PY{p}{[}\PY{n}{idx}\PY{p}{]}\PY{l+s+si}{:}\PY{l+s+s1}{.4f}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{, p: }\PY{l+s+si}{\PYZob{}}\PY{n}{avg\PYZus{}p\PYZus{}values}\PY{p}{[}\PY{n}{idx}\PY{p}{]}\PY{l+s+si}{:}\PY{l+s+s1}{.4f}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{)}\PY{l+s+s1}{\PYZsq{}} \PY{k}{for} \PY{n}{idx} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{sorted\PYZus{}combo\PYZus{}with\PYZus{}const}\PY{p}{)}\PY{p}{)}\PY{p}{]}\PY{p}{)}
            \PY{p}{\PYZcb{}}
            \PY{k}{for} \PY{n}{idx}\PY{p}{,} \PY{n}{var} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{sorted\PYZus{}combo\PYZus{}with\PYZus{}const}\PY{p}{)}\PY{p}{:}
                \PY{k}{if} \PY{n}{var} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{const}\PY{l+s+s1}{\PYZsq{}} \PY{o+ow}{and} \PY{o+ow}{not} \PY{n}{include\PYZus{}constant}\PY{p}{:}
                    \PY{n}{result}\PY{p}{[}\PY{n}{var}\PY{p}{]} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{nan}
                    \PY{n}{result}\PY{p}{[}\PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}}\PY{n}{var}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{\PYZus{}SE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{nan}
                    \PY{n}{result}\PY{p}{[}\PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}}\PY{n}{var}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{\PYZus{}p}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{nan}
                \PY{k}{else}\PY{p}{:}
                    \PY{n}{result}\PY{p}{[}\PY{n}{var}\PY{p}{]} \PY{o}{=} \PY{n}{avg\PYZus{}beta\PYZus{}estimates}\PY{p}{[}\PY{n}{idx}\PY{p}{]}
                    \PY{n}{result}\PY{p}{[}\PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}}\PY{n}{var}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{\PYZus{}SE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{avg\PYZus{}std\PYZus{}errors}\PY{p}{[}\PY{n}{idx}\PY{p}{]}
                    \PY{n}{result}\PY{p}{[}\PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}}\PY{n}{var}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{\PYZus{}p}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{avg\PYZus{}p\PYZus{}values}\PY{p}{[}\PY{n}{idx}\PY{p}{]}
            \PY{n}{results}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{result}\PY{p}{)}

            \PY{c+c1}{\PYZsh{} Calculate residuals for the average model based on the top 3 lowest MSEs}
            \PY{n}{all\PYZus{}residuals} \PY{o}{=} \PY{p}{[}\PY{p}{]}
            \PY{k}{for} \PY{n}{idx} \PY{o+ow}{in} \PY{n}{top\PYZus{}3\PYZus{}indices}\PY{p}{:}
                \PY{n}{train\PYZus{}index}\PY{p}{,} \PY{n}{test\PYZus{}index} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n}{kf}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{n}{X}\PY{p}{)}\PY{p}{)}\PY{p}{[}\PY{n}{idx}\PY{p}{]}
                \PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{X\PYZus{}test} \PY{o}{=} \PY{n}{X}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{train\PYZus{}index}\PY{p}{]}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{n}{drop}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}\PY{p}{,} \PY{n}{X}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{test\PYZus{}index}\PY{p}{]}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{n}{drop}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
                \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}test} \PY{o}{=} \PY{n}{y}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{train\PYZus{}index}\PY{p}{]}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{n}{drop}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}\PY{p}{,} \PY{n}{y}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{test\PYZus{}index}\PY{p}{]}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{n}{drop}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}

                \PY{k}{if} \PY{n}{model\PYZus{}type} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ols}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
                    \PY{n}{model} \PY{o}{=} \PY{n}{sm}\PY{o}{.}\PY{n}{OLS}\PY{p}{(}\PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{X\PYZus{}train}\PY{p}{)}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{p}{)}
                \PY{k}{elif} \PY{n}{model\PYZus{}type} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{wls}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
                    \PY{n}{weights} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{weight}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{train\PYZus{}index}\PY{p}{]}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{n}{drop}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
                    \PY{n}{model} \PY{o}{=} \PY{n}{sm}\PY{o}{.}\PY{n}{WLS}\PY{p}{(}\PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{weights}\PY{o}{=}\PY{n}{weights}\PY{p}{)}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{p}{)}

                \PY{n}{y\PYZus{}pred} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}
                \PY{n}{residuals\PYZus{}y} \PY{o}{=} \PY{n}{y\PYZus{}test} \PY{o}{\PYZhy{}} \PY{n}{y\PYZus{}pred}
                \PY{n}{residuals\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s2}{epsilon\PYZus{}}\PY{l+s+se}{\PYZob{}\PYZob{}}\PY{l+s+si}{\PYZob{}}\PY{n}{dependent\PYZus{}var}\PY{l+s+si}{\PYZcb{}}\PY{l+s+se}{\PYZcb{}\PYZcb{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{n}{residuals\PYZus{}y}\PY{p}{\PYZcb{}}\PY{p}{)}
                
                \PY{c+c1}{\PYZsh{} Calculate residuals for independent variables}
                \PY{k}{for} \PY{n}{var} \PY{o+ow}{in} \PY{n}{combo\PYZus{}with\PYZus{}const}\PY{p}{:}
                    \PY{k}{if} \PY{n}{var} \PY{o}{!=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{const}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
                        \PY{n}{residuals\PYZus{}X} \PY{o}{=} \PY{n}{X\PYZus{}test}\PY{p}{[}\PY{n}{var}\PY{p}{]} \PY{o}{\PYZhy{}} \PY{n}{model}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}
                        \PY{n}{residuals\PYZus{}df}\PY{p}{[}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s2}{epsilon\PYZus{}}\PY{l+s+se}{\PYZob{}\PYZob{}}\PY{l+s+si}{\PYZob{}}\PY{n}{var}\PY{l+s+si}{\PYZcb{}}\PY{l+s+se}{\PYZcb{}\PYZcb{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{residuals\PYZus{}X}

                \PY{n}{all\PYZus{}residuals}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{residuals\PYZus{}df}\PY{p}{)}
            
            \PY{c+c1}{\PYZsh{} Average residuals across top 3 models}
            \PY{n}{avg\PYZus{}residuals} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{concat}\PY{p}{(}\PY{n}{all\PYZus{}residuals}\PY{p}{)}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{n}{level}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}
            \PY{n}{sorted\PYZus{}combo} \PY{o}{=} \PY{n+nb}{tuple}\PY{p}{(}\PY{n+nb}{sorted}\PY{p}{(}\PY{n}{combo\PYZus{}with\PYZus{}const}\PY{p}{)}\PY{p}{)}
            \PY{n}{residuals\PYZus{}dict}\PY{p}{[}\PY{n}{sorted\PYZus{}combo}\PY{p}{]} \PY{o}{=} \PY{n}{avg\PYZus{}residuals}
            
            \PY{c+c1}{\PYZsh{} Save the best fold data}
            \PY{n}{best\PYZus{}fold\PYZus{}index} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{argmin}\PY{p}{(}\PY{n}{mse\PYZus{}list}\PY{p}{)}
            \PY{n}{best\PYZus{}folds\PYZus{}data}\PY{p}{[}\PY{n}{sorted\PYZus{}combo}\PY{p}{]} \PY{o}{=} \PY{n}{fold\PYZus{}data\PYZus{}list}\PY{p}{[}\PY{n}{best\PYZus{}fold\PYZus{}index}\PY{p}{]}

    \PY{n}{results\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{results}\PY{p}{)}
    \PY{k}{return} \PY{n}{results\PYZus{}df}\PY{p}{,} \PY{n}{residuals\PYZus{}dict}\PY{p}{,} \PY{n}{best\PYZus{}folds\PYZus{}data}

\PY{c+c1}{\PYZsh{} \PYZsh{} Usage example}
\PY{c+c1}{\PYZsh{} results\PYZus{}ols\PYZus{}rates\PYZus{}clusters\PYZus{}efw\PYZus{}k, residuals\PYZus{}ols\PYZus{}rates\PYZus{}clusters\PYZus{}efw\PYZus{}k, best\PYZus{}fold\PYZus{}data\PYZus{}ols = ols\PYZus{}wls\PYZus{}combinations\PYZus{}kfold(}
\PY{c+c1}{\PYZsh{}     df\PYZus{}rates, dv, iv, model\PYZus{}type=\PYZsq{}ols\PYZsq{}, always\PYZus{}include=None, never\PYZus{}include=None, df\PYZus{}name=\PYZsq{}Rates ols)\PYZsq{}, }
\PY{c+c1}{\PYZsh{}     include\PYZus{}constant=True, n\PYZus{}splits=5, random\PYZus{}state=42)}

\PY{c+c1}{\PYZsh{} Function to get merged data from best\PYZus{}fold\PYZus{}data regardless of order}
\PY{k}{def} \PY{n+nf}{get\PYZus{}best\PYZus{}fold\PYZus{}data\PYZus{}merged}\PY{p}{(}\PY{n}{best\PYZus{}fold\PYZus{}data}\PY{p}{,} \PY{o}{*}\PY{n+nb}{vars}\PY{p}{)}\PY{p}{:}
    \PY{n}{sorted\PYZus{}vars} \PY{o}{=} \PY{n+nb}{tuple}\PY{p}{(}\PY{n+nb}{sorted}\PY{p}{(}\PY{n+nb}{vars}\PY{p}{)}\PY{p}{)}
    \PY{k}{if} \PY{n}{sorted\PYZus{}vars} \PY{o+ow}{in} \PY{n}{best\PYZus{}fold\PYZus{}data}\PY{p}{:}
        \PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{X\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}test} \PY{o}{=} \PY{n}{best\PYZus{}fold\PYZus{}data}\PY{p}{[}\PY{n}{sorted\PYZus{}vars}\PY{p}{]}
        \PY{n}{train\PYZus{}data} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{concat}\PY{p}{(}\PY{p}{[}\PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
        \PY{n}{test\PYZus{}data} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{concat}\PY{p}{(}\PY{p}{[}\PY{n}{X\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}test}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
        \PY{k}{return} \PY{n}{train\PYZus{}data}\PY{p}{,} \PY{n}{test\PYZus{}data}
    \PY{k}{else}\PY{p}{:}
        \PY{k}{raise} \PY{n+ne}{KeyError}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Combination }\PY{l+s+si}{\PYZob{}}\PY{n}{sorted\PYZus{}vars}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{ not found in best\PYZus{}fold\PYZus{}data.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}

\PY{c+c1}{\PYZsh{} \PYZsh{} Access the best fold data without considering order and merge it}
\PY{c+c1}{\PYZsh{} try:}
\PY{c+c1}{\PYZsh{}     train\PYZus{}data, test\PYZus{}data = get\PYZus{}best\PYZus{}fold\PYZus{}data\PYZus{}merged(best\PYZus{}fold\PYZus{}data\PYZus{}ols, \PYZsq{}clusters\PYZus{}2.0\PYZsq{}, \PYZsq{}Agri\PYZsq{}, \PYZsq{}const\PYZsq{})}
\PY{c+c1}{\PYZsh{}     print(\PYZdq{}Best fold data accessed and merged successfully.\PYZdq{})}
\PY{c+c1}{\PYZsh{} except KeyError as e:}
\PY{c+c1}{\PYZsh{}     print(e)}

\PY{c+c1}{\PYZsh{} \PYZsh{} Save to CSV}
\PY{c+c1}{\PYZsh{} train\PYZus{}data.to\PYZus{}csv(\PYZsq{}best\PYZus{}fold\PYZus{}train\PYZus{}data.csv\PYZsq{}, index=False)}
\PY{c+c1}{\PYZsh{} test\PYZus{}data.to\PYZus{}csv(\PYZsq{}best\PYZus{}fold\PYZus{}test\PYZus{}data.csv\PYZsq{}, index=False)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{10}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
\PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
\PY{k+kn}{from} \PY{n+nn}{IPython}\PY{n+nn}{.}\PY{n+nn}{display} \PY{k+kn}{import} \PY{n}{display}\PY{p}{,} \PY{n}{HTML}

\PY{k}{def} \PY{n+nf}{filter\PYZus{}results\PYZus{}table}\PY{p}{(}\PY{n}{results\PYZus{}dict}\PY{p}{,} \PY{n}{df\PYZus{}name}\PY{p}{,} \PY{n}{variable\PYZus{}combinations}\PY{p}{)}\PY{p}{:}
    \PY{c+c1}{\PYZsh{} Extract the relevant dataframe from the results dictionary}
    \PY{n}{df\PYZus{}results} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{results\PYZus{}dict}\PY{p}{[}\PY{n}{df\PYZus{}name}\PY{p}{]}\PY{p}{)}
    
    \PY{c+c1}{\PYZsh{} Convert \PYZsq{}Model\PYZsq{} column to sets of variables for easier comparison}
    \PY{n}{df\PYZus{}results}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Model}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{df\PYZus{}results}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Model}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{apply}\PY{p}{(}\PY{k}{lambda} \PY{n}{x}\PY{p}{:} \PY{n+nb}{set}\PY{p}{(}\PY{n}{x}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{, }\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{)}
    
    \PY{c+c1}{\PYZsh{} Convert each set of variables in variable\PYZus{}combinations to sets for comparison}
    \PY{n}{variable\PYZus{}combinations} \PY{o}{=} \PY{p}{[}\PY{n+nb}{set}\PY{p}{(}\PY{n}{combo}\PY{p}{)} \PY{k}{for} \PY{n}{combo} \PY{o+ow}{in} \PY{n}{variable\PYZus{}combinations}\PY{p}{]}
    
    \PY{c+c1}{\PYZsh{} Filter the DataFrame for rows where the \PYZsq{}Model\PYZsq{} matches any of the variable combinations}
    \PY{n}{filtered\PYZus{}df} \PY{o}{=} \PY{n}{df\PYZus{}results}\PY{p}{[}
        \PY{n}{df\PYZus{}results}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Model}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{apply}\PY{p}{(}\PY{k}{lambda} \PY{n}{x}\PY{p}{:} \PY{n+nb}{any}\PY{p}{(}\PY{n}{x} \PY{o}{==} \PY{n}{combo} \PY{k}{for} \PY{n}{combo} \PY{o+ow}{in} \PY{n}{variable\PYZus{}combinations}\PY{p}{)}\PY{p}{)}
    \PY{p}{]}
    
    \PY{k}{return} \PY{n}{filtered\PYZus{}df}

\PY{k}{def} \PY{n+nf}{significance\PYZus{}stars}\PY{p}{(}\PY{n}{p\PYZus{}value}\PY{p}{)}\PY{p}{:}
    \PY{k}{if} \PY{n}{p\PYZus{}value} \PY{o}{\PYZlt{}} \PY{l+m+mf}{0.01}\PY{p}{:}
        \PY{k}{return} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{***}\PY{l+s+s1}{\PYZsq{}}
    \PY{k}{elif} \PY{n}{p\PYZus{}value} \PY{o}{\PYZlt{}} \PY{l+m+mf}{0.05}\PY{p}{:}
        \PY{k}{return} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{**}\PY{l+s+s1}{\PYZsq{}}
    \PY{k}{elif} \PY{n}{p\PYZus{}value} \PY{o}{\PYZlt{}} \PY{l+m+mf}{0.1}\PY{p}{:}
        \PY{k}{return} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{*}\PY{l+s+s1}{\PYZsq{}}
    \PY{k}{else}\PY{p}{:}
        \PY{k}{return} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsq{}}

\PY{k}{def} \PY{n+nf}{format\PYZus{}estimate}\PY{p}{(}\PY{n}{beta}\PY{p}{,} \PY{n}{std\PYZus{}error}\PY{p}{,} \PY{n}{p\PYZus{}value}\PY{p}{)}\PY{p}{:}
    \PY{n}{stars} \PY{o}{=} \PY{n}{significance\PYZus{}stars}\PY{p}{(}\PY{n}{p\PYZus{}value}\PY{p}{)}
    \PY{k}{if} \PY{n}{pd}\PY{o}{.}\PY{n}{notna}\PY{p}{(}\PY{n}{std\PYZus{}error}\PY{p}{)}\PY{p}{:}
        \PY{k}{return} \PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZob{}}\PY{n}{beta}\PY{l+s+si}{:}\PY{l+s+s2}{.4f}\PY{l+s+si}{\PYZcb{}}\PY{l+s+si}{\PYZob{}}\PY{n}{stars}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZlt{}br\PYZgt{}(}\PY{l+s+si}{\PYZob{}}\PY{n}{std\PYZus{}error}\PY{l+s+si}{:}\PY{l+s+s2}{.4f}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{)}\PY{l+s+s2}{\PYZdq{}}
    \PY{k}{return} \PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZob{}}\PY{n}{beta}\PY{l+s+si}{:}\PY{l+s+s2}{.4f}\PY{l+s+si}{\PYZcb{}}\PY{l+s+si}{\PYZob{}}\PY{n}{stars}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}

\PY{k}{def} \PY{n+nf}{display\PYZus{}results\PYZus{}table}\PY{p}{(}\PY{n}{filtered\PYZus{}df}\PY{p}{,} \PY{n}{variable\PYZus{}combinations}\PY{p}{,} \PY{n}{column\PYZus{}names}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,} \PY{n}{exclude\PYZus{}rows}\PY{o}{=}\PY{k+kc}{None}\PY{p}{)}\PY{p}{:}
    \PY{k}{if} \PY{n}{filtered\PYZus{}df}\PY{o}{.}\PY{n}{empty}\PY{p}{:}
        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{No matching results found.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
        \PY{k}{return}
    
    \PY{c+c1}{\PYZsh{} Dynamically determine variables and metrics from the filtered DataFrame}
    \PY{n}{variables\PYZus{}and\PYZus{}metrics} \PY{o}{=} \PY{n}{filtered\PYZus{}df}\PY{o}{.}\PY{n}{columns}\PY{o}{.}\PY{n}{tolist}\PY{p}{(}\PY{p}{)}
    \PY{n}{variables\PYZus{}and\PYZus{}metrics}\PY{o}{.}\PY{n}{remove}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Model}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}  \PY{c+c1}{\PYZsh{} Remove \PYZsq{}Model\PYZsq{} as it\PYZsq{}s used for filtering}
    \PY{n}{variables\PYZus{}and\PYZus{}metrics}\PY{o}{.}\PY{n}{remove}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DataFrame}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}  \PY{c+c1}{\PYZsh{} Remove \PYZsq{}DataFrame\PYZsq{} as it\PYZsq{}s not a variable/metric}

    \PY{c+c1}{\PYZsh{} Initialize the result DataFrame with the index of all potential variables and metrics}
    \PY{n}{results\PYZus{}table} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{index}\PY{o}{=}\PY{n}{variables\PYZus{}and\PYZus{}metrics}\PY{p}{)}
    
    \PY{c+c1}{\PYZsh{} Use custom column names if provided, otherwise use the variable combinations}
    \PY{k}{if} \PY{n}{column\PYZus{}names}\PY{p}{:}
        \PY{k}{assert} \PY{n+nb}{len}\PY{p}{(}\PY{n}{column\PYZus{}names}\PY{p}{)} \PY{o}{==} \PY{n+nb}{len}\PY{p}{(}\PY{n}{variable\PYZus{}combinations}\PY{p}{)}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Length of column\PYZus{}names must match variable\PYZus{}combinations}\PY{l+s+s2}{\PYZdq{}}
        \PY{n}{model\PYZus{}columns} \PY{o}{=} \PY{n}{column\PYZus{}names}
    \PY{k}{else}\PY{p}{:}
        \PY{n}{model\PYZus{}columns} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{, }\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{combo}\PY{p}{)} \PY{k}{for} \PY{n}{combo} \PY{o+ow}{in} \PY{n}{variable\PYZus{}combinations}\PY{p}{]}
    
    \PY{c+c1}{\PYZsh{} Add each model\PYZsq{}s results to the table}
    \PY{k}{for} \PY{n}{model\PYZus{}vars}\PY{p}{,} \PY{n}{model\PYZus{}name} \PY{o+ow}{in} \PY{n+nb}{zip}\PY{p}{(}\PY{n}{variable\PYZus{}combinations}\PY{p}{,} \PY{n}{model\PYZus{}columns}\PY{p}{)}\PY{p}{:}
        \PY{n}{model\PYZus{}data} \PY{o}{=} \PY{n}{filtered\PYZus{}df}\PY{p}{[}\PY{n}{filtered\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Model}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{apply}\PY{p}{(}\PY{k}{lambda} \PY{n}{x}\PY{p}{:} \PY{n}{x} \PY{o}{==} \PY{n}{model\PYZus{}vars}\PY{p}{)}\PY{p}{]}
        
        \PY{k}{if} \PY{o+ow}{not} \PY{n}{model\PYZus{}data}\PY{o}{.}\PY{n}{empty}\PY{p}{:}
            \PY{n}{model\PYZus{}data} \PY{o}{=} \PY{n}{model\PYZus{}data}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
            \PY{k}{for} \PY{n}{var} \PY{o+ow}{in} \PY{n}{variables\PYZus{}and\PYZus{}metrics}\PY{p}{:}
                \PY{k}{if} \PY{n}{var} \PY{o+ow}{in} \PY{n}{model\PYZus{}data}\PY{o}{.}\PY{n}{index} \PY{o+ow}{and} \PY{o+ow}{not} \PY{n}{var}\PY{o}{.}\PY{n}{endswith}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZus{}SE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{o+ow}{and} \PY{o+ow}{not} \PY{n}{var}\PY{o}{.}\PY{n}{endswith}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZus{}p}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{:}
                    \PY{c+c1}{\PYZsh{} Skip adding data for excluded rows}
                    \PY{k}{if} \PY{n}{exclude\PYZus{}rows} \PY{o+ow}{and} \PY{n}{var} \PY{o+ow}{in} \PY{n}{exclude\PYZus{}rows}\PY{p}{:}
                        \PY{k}{continue}
                    \PY{n}{beta} \PY{o}{=} \PY{n}{model\PYZus{}data}\PY{p}{[}\PY{n}{var}\PY{p}{]}
                    \PY{n}{std\PYZus{}error} \PY{o}{=} \PY{n}{model\PYZus{}data}\PY{o}{.}\PY{n}{get}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}}\PY{n}{var}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{\PYZus{}SE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{nan}\PY{p}{)}
                    \PY{n}{p\PYZus{}value} \PY{o}{=} \PY{n}{model\PYZus{}data}\PY{o}{.}\PY{n}{get}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}}\PY{n}{var}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{\PYZus{}p}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{nan}\PY{p}{)}
                    
                    \PY{c+c1}{\PYZsh{} Store formatted estimate even if std\PYZus{}error or p\PYZus{}value is NaN}
                    \PY{n}{results\PYZus{}table}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{var}\PY{p}{,} \PY{n}{model\PYZus{}name}\PY{p}{]} \PY{o}{=} \PY{n}{format\PYZus{}estimate}\PY{p}{(}\PY{n}{beta}\PY{p}{,} \PY{n}{std\PYZus{}error}\PY{p}{,} \PY{n}{p\PYZus{}value}\PY{p}{)}
    
    \PY{c+c1}{\PYZsh{} Drop rows that have names ending with \PYZsq{}\PYZus{}SE\PYZsq{} or \PYZsq{}\PYZus{}p\PYZsq{}}
    \PY{n}{results\PYZus{}table} \PY{o}{=} \PY{n}{results\PYZus{}table}\PY{p}{[}\PY{o}{\PYZti{}}\PY{n}{results\PYZus{}table}\PY{o}{.}\PY{n}{index}\PY{o}{.}\PY{n}{str}\PY{o}{.}\PY{n}{endswith}\PY{p}{(}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZus{}SE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZus{}p}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{]}
    
    \PY{c+c1}{\PYZsh{} Drop rows with all NaN values}
    \PY{n}{results\PYZus{}table}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{n}{how}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{all}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
    
    \PY{c+c1}{\PYZsh{} Apply CSS styling to center align column headers}
    \PY{n}{results\PYZus{}table\PYZus{}styled} \PY{o}{=} \PY{n}{results\PYZus{}table}\PY{o}{.}\PY{n}{style}\PY{o}{.}\PY{n}{set\PYZus{}table\PYZus{}styles}\PY{p}{(}\PY{p}{[}
        \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{selector}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{th.col\PYZus{}heading}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{props}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{[}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{text\PYZhy{}align}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{center}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{\PYZcb{}}
    \PY{p}{]}\PY{p}{)}
    
    \PY{c+c1}{\PYZsh{} Display the results table with centered column headers}
    \PY{n}{display}\PY{p}{(}\PY{n}{results\PYZus{}table\PYZus{}styled}\PY{p}{)}
    
    \PY{c+c1}{\PYZsh{} Add the legend for significance stars}
    \PY{n}{legend\PYZus{}html} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}\PYZdq{}\PYZdq{}}
\PY{l+s+s2}{    \PYZlt{}br\PYZgt{}\PYZlt{}br\PYZgt{}}
\PY{l+s+s2}{    \PYZlt{}strong\PYZgt{}Significance legend:\PYZlt{}/strong\PYZgt{}\PYZlt{}br\PYZgt{}}
\PY{l+s+s2}{    \PYZlt{}strong\PYZgt{}*\PYZlt{}/strong\PYZgt{} p \PYZlt{} 0.1\PYZlt{}br\PYZgt{}}
\PY{l+s+s2}{    \PYZlt{}strong\PYZgt{}**\PYZlt{}/strong\PYZgt{} p \PYZlt{} 0.05\PYZlt{}br\PYZgt{}}
\PY{l+s+s2}{    \PYZlt{}strong\PYZgt{}***\PYZlt{}/strong\PYZgt{} p \PYZlt{} 0.01}
\PY{l+s+s2}{    }\PY{l+s+s2}{\PYZdq{}\PYZdq{}\PYZdq{}}
    \PY{n}{display}\PY{p}{(}\PY{n}{HTML}\PY{p}{(}\PY{n}{legend\PYZus{}html}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{11}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{dv} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{unem}\PY{l+s+s1}{\PYZsq{}}
\PY{n}{iv} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Agri}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mini}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Util}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{EFW}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M4I}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{clusters\PYZus{}2.0}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{clusters\PYZus{}3.0}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{clusters\PYZus{}4.0}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{12}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} Rates ols}
\PY{n}{results\PYZus{}ols\PYZus{}rates\PYZus{}clusters\PYZus{}efw\PYZus{}k}\PY{p}{,} \PY{n}{residuals\PYZus{}ols\PYZus{}rates\PYZus{}clusters\PYZus{}efw\PYZus{}k}\PY{p}{,} \PY{n}{best\PYZus{}rates\PYZus{}data\PYZus{}ols} \PY{o}{=} \PY{n}{ols\PYZus{}wls\PYZus{}combinations\PYZus{}kfold}\PY{p}{(}\PY{n}{df\PYZus{}rates}\PY{p}{,} \PY{n}{dv}\PY{p}{,} \PY{n}{iv}\PY{p}{,} 
                                                                           \PY{n}{model\PYZus{}type}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ols}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} 
                                                                           \PY{n}{always\PYZus{}include}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,} 
                                                                           \PY{n}{never\PYZus{}include}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,} 
                                                                           \PY{n}{df\PYZus{}name}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Rates ols)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} 
                                                                           \PY{n}{include\PYZus{}constant}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}
                                                                           \PY{n}{n\PYZus{}splits}\PY{o}{=}\PY{l+m+mi}{5}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{42}\PY{p}{)}


\PY{c+c1}{\PYZsh{}rates, wls, clusters, efw}
\PY{n}{results\PYZus{}wls\PYZus{}rates\PYZus{}clusters\PYZus{}efw\PYZus{}k}\PY{p}{,} \PY{n}{residuals\PYZus{}wls\PYZus{}rates\PYZus{}clusters\PYZus{}efw\PYZus{}k}\PY{p}{,} \PY{n}{best\PYZus{}rates\PYZus{}data\PYZus{}wls} \PY{o}{=} \PY{n}{ols\PYZus{}wls\PYZus{}combinations\PYZus{}kfold}\PY{p}{(}\PY{n}{df\PYZus{}rates}\PY{p}{,} \PY{n}{dv}\PY{p}{,} \PY{n}{iv}\PY{p}{,} 
                                                                           \PY{n}{model\PYZus{}type}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{wls}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} 
                                                                           \PY{n}{always\PYZus{}include}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,} 
                                                                           \PY{n}{never\PYZus{}include}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,} 
                                                                           \PY{n}{df\PYZus{}name}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Rates wls)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} 
                                                                           \PY{n}{include\PYZus{}constant}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}
                                                                           \PY{n}{n\PYZus{}splits}\PY{o}{=}\PY{l+m+mi}{5}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{42}\PY{p}{)}


\PY{c+c1}{\PYZsh{}diff rates, ols, cluster, efw}
\PY{n}{results\PYZus{}ols\PYZus{}diff\PYZus{}rates\PYZus{}clusters\PYZus{}efw\PYZus{}k}\PY{p}{,} \PY{n}{residuals\PYZus{}ols\PYZus{}diff\PYZus{}rates\PYZus{}clusters\PYZus{}efw\PYZus{}k}\PY{p}{,} \PY{n}{best\PYZus{}diff\PYZus{}rates\PYZus{}ols} \PY{o}{=} \PY{n}{ols\PYZus{}wls\PYZus{}combinations\PYZus{}kfold}\PY{p}{(}\PY{n}{df\PYZus{}diff}\PY{p}{,} \PY{n}{dv}\PY{p}{,} \PY{n}{iv}\PY{p}{,} 
                                                                                     \PY{n}{model\PYZus{}type}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ols}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} 
                                                                                     \PY{n}{always\PYZus{}include}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,} 
                                                                                     \PY{n}{never\PYZus{}include}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,} 
                                                                                     \PY{n}{df\PYZus{}name}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Diff rates ols}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} 
                                                                                     \PY{n}{include\PYZus{}constant}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,}
                                                                           \PY{n}{n\PYZus{}splits}\PY{o}{=}\PY{l+m+mi}{5}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{42}\PY{p}{)}




\PY{c+c1}{\PYZsh{} Combine the results and residuals into dictionaries}
\PY{n}{results\PYZus{}dict\PYZus{}combo\PYZus{}k} \PY{o}{=} \PY{p}{\PYZob{}}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Rates wls}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{results\PYZus{}wls\PYZus{}rates\PYZus{}clusters\PYZus{}efw\PYZus{}k}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Rates ols}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{results\PYZus{}ols\PYZus{}rates\PYZus{}clusters\PYZus{}efw\PYZus{}k}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Diff rates ols}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{results\PYZus{}ols\PYZus{}diff\PYZus{}rates\PYZus{}clusters\PYZus{}efw\PYZus{}k}
\PY{p}{\PYZcb{}}

\PY{n}{residuals\PYZus{}dict\PYZus{}combo\PYZus{}k} \PY{o}{=} \PY{p}{\PYZob{}}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Rates wls}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{residuals\PYZus{}wls\PYZus{}rates\PYZus{}clusters\PYZus{}efw\PYZus{}k}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Rates ols}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{residuals\PYZus{}ols\PYZus{}rates\PYZus{}clusters\PYZus{}efw\PYZus{}k}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Diff rates ols}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{residuals\PYZus{}ols\PYZus{}diff\PYZus{}rates\PYZus{}clusters\PYZus{}efw\PYZus{}k}
\PY{p}{\PYZcb{}}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{13}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{rates\PYZus{}try} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Rates wls}\PY{l+s+s1}{\PYZsq{}}

\PY{n}{variable\PYZus{}combok} \PY{o}{=} \PY{p}{[}
    \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{const}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M4I}\PY{l+s+s1}{\PYZsq{}}\PY{p}{\PYZcb{}}\PY{p}{,}
    \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{const}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Agri}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Util}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mini}\PY{l+s+s1}{\PYZsq{}}\PY{p}{\PYZcb{}}\PY{p}{,}
    \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{const}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Agri}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mini}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Util}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M4I}\PY{l+s+s1}{\PYZsq{}}\PY{p}{\PYZcb{}}\PY{p}{,}
    \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{const}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M4I}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Agri}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mini}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Util}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{EFW}\PY{l+s+s1}{\PYZsq{}}\PY{p}{\PYZcb{}}\PY{p}{,}
    \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{const}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M4I}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Agri}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mini}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Util}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{clusters\PYZus{}2.0}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{clusters\PYZus{}3.0}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{clusters\PYZus{}4.0}\PY{l+s+s1}{\PYZsq{}}\PY{p}{\PYZcb{}}\PY{p}{,}
    \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{const}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M4I}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Agri}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mini}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Util}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{EFW}\PY{l+s+s1}{\PYZsq{}} \PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{clusters\PYZus{}2.0}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{clusters\PYZus{}3.0}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{clusters\PYZus{}4.0}\PY{l+s+s1}{\PYZsq{}}\PY{p}{\PYZcb{}}\PY{p}{]}

\PY{n}{column\PYZus{}names} \PY{o}{=} \PY{p}{[}
    \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{M4}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{s only}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sectors only}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M4+sectors}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M4+sectors+EFW}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M4+sectors+clusters}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{All variables}\PY{l+s+s1}{\PYZsq{}}
\PY{p}{]}

\PY{c+c1}{\PYZsh{} Specify the row(s) to exclude from display}
\PY{n}{exclude\PYZus{}rows} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Variables}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}

\PY{n}{rates\PYZus{}kfold} \PY{o}{=} \PY{n}{filter\PYZus{}results\PYZus{}table}\PY{p}{(}\PY{n}{results\PYZus{}dict\PYZus{}combo\PYZus{}k}\PY{p}{,} \PY{n}{rates\PYZus{}try}\PY{p}{,} \PY{n}{variable\PYZus{}combok}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{14}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{rates\PYZus{}try\PYZus{}ols\PYZus{}k} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Rates ols}\PY{l+s+s1}{\PYZsq{}}

\PY{c+c1}{\PYZsh{} Specify the row(s) to exclude from display}
\PY{n}{exclude\PYZus{}rows} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Variables}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}

\PY{n}{rates\PYZus{}k\PYZus{}ols} \PY{o}{=} \PY{n}{filter\PYZus{}results\PYZus{}table}\PY{p}{(}\PY{n}{results\PYZus{}dict\PYZus{}combo\PYZus{}k}\PY{p}{,} \PY{n}{rates\PYZus{}try\PYZus{}ols\PYZus{}k}\PY{p}{,} \PY{n}{variable\PYZus{}combok}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{15}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{diff\PYZus{}rates\PYZus{}try} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Diff rates ols}\PY{l+s+s1}{\PYZsq{}}

\PY{n}{variable\PYZus{}combinationsk} \PY{o}{=} \PY{p}{[}
    \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M4I}\PY{l+s+s1}{\PYZsq{}}\PY{p}{\PYZcb{}}\PY{p}{,}
    \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Agri}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Util}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mini}\PY{l+s+s1}{\PYZsq{}}\PY{p}{\PYZcb{}}\PY{p}{,}
    \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Agri}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mini}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Util}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M4I}\PY{l+s+s1}{\PYZsq{}}\PY{p}{\PYZcb{}}\PY{p}{,}
    \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M4I}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Agri}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mini}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Util}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{EFW}\PY{l+s+s1}{\PYZsq{}}\PY{p}{\PYZcb{}}\PY{p}{,}
    \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M4I}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Agri}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mini}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Util}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{clusters\PYZus{}2.0}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{clusters\PYZus{}3.0}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{clusters\PYZus{}4.0}\PY{l+s+s1}{\PYZsq{}}\PY{p}{\PYZcb{}}\PY{p}{,}
    \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M4I}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Agri}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mini}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Util}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{EFW}\PY{l+s+s1}{\PYZsq{}} \PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{clusters\PYZus{}2.0}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{clusters\PYZus{}3.0}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{clusters\PYZus{}4.0}\PY{l+s+s1}{\PYZsq{}}\PY{p}{\PYZcb{}}\PY{p}{]}

\PY{n}{column\PYZus{}names} \PY{o}{=} \PY{p}{[}
    \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{M4}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{s only}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sectors only}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M4+sectors}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M4+sectors+EFW}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M4+sectors+clusters}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{All variables}\PY{l+s+s1}{\PYZsq{}}
\PY{p}{]}

\PY{c+c1}{\PYZsh{} Specify the row(s) to exclude from display}
\PY{n}{exclude\PYZus{}rows} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Variables}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}

\PY{n}{diff\PYZus{}rates\PYZus{}kfold} \PY{o}{=} \PY{n}{filter\PYZus{}results\PYZus{}table}\PY{p}{(}\PY{n}{results\PYZus{}dict\PYZus{}combo\PYZus{}k}\PY{p}{,} \PY{n}{diff\PYZus{}rates\PYZus{}try}\PY{p}{,} \PY{n}{variable\PYZus{}combinationsk}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{16}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Rates ols k\PYZhy{}fold :}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{display\PYZus{}results\PYZus{}table}\PY{p}{(}\PY{n}{rates\PYZus{}k\PYZus{}ols}\PY{p}{,} \PY{n}{variable\PYZus{}combok}\PY{p}{,} \PY{n}{column\PYZus{}names}\PY{p}{,} \PY{n}{exclude\PYZus{}rows}\PY{p}{)}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Differenced Rates ols k\PYZhy{}fold :}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{display\PYZus{}results\PYZus{}table}\PY{p}{(}\PY{n}{diff\PYZus{}rates\PYZus{}kfold}\PY{p}{,} \PY{n}{variable\PYZus{}combinationsk}\PY{p}{,} \PY{n}{column\PYZus{}names}\PY{p}{,} \PY{n}{exclude\PYZus{}rows}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Rates ols k-fold :
    \end{Verbatim}

    
    \begin{Verbatim}[commandchars=\\\{\}]
<pandas.io.formats.style.Styler at 0x31fa84b50>
    \end{Verbatim}

    
    
    \begin{Verbatim}[commandchars=\\\{\}]
<IPython.core.display.HTML object>
    \end{Verbatim}

    
    \begin{Verbatim}[commandchars=\\\{\}]
None
Differenced Rates ols k-fold :
    \end{Verbatim}

    
    \begin{Verbatim}[commandchars=\\\{\}]
<pandas.io.formats.style.Styler at 0x3b0023010>
    \end{Verbatim}

    
    
    \begin{Verbatim}[commandchars=\\\{\}]
<IPython.core.display.HTML object>
    \end{Verbatim}

    
    \begin{Verbatim}[commandchars=\\\{\}]
None
    \end{Verbatim}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{17}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import} \PY{n+nn}{itertools}
\PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
\PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
\PY{k+kn}{import} \PY{n+nn}{statsmodels}\PY{n+nn}{.}\PY{n+nn}{api} \PY{k}{as} \PY{n+nn}{sm}

\PY{k}{def} \PY{n+nf}{calculate\PYZus{}residuals}\PY{p}{(}\PY{n}{df}\PY{p}{,} \PY{n}{y\PYZus{}var}\PY{p}{,} \PY{n}{X\PYZus{}vars}\PY{p}{,} \PY{n}{model\PYZus{}type}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ols}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{weights}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,} \PY{n}{include\PYZus{}constant}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{p}{:}
    \PY{n}{residuals} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
    \PY{k}{for} \PY{n}{var} \PY{o+ow}{in} \PY{p}{[}\PY{n}{y\PYZus{}var}\PY{p}{]} \PY{o}{+} \PY{n}{X\PYZus{}vars}\PY{p}{:}
        \PY{n}{other\PYZus{}vars} \PY{o}{=} \PY{p}{[}\PY{n}{v} \PY{k}{for} \PY{n}{v} \PY{o+ow}{in} \PY{p}{[}\PY{n}{y\PYZus{}var}\PY{p}{]} \PY{o}{+} \PY{n}{X\PYZus{}vars} \PY{k}{if} \PY{n}{v} \PY{o}{!=} \PY{n}{var}\PY{p}{]}
        \PY{n}{X} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{n}{other\PYZus{}vars}\PY{p}{]}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}
        \PY{k}{if} \PY{n}{include\PYZus{}constant}\PY{p}{:}
            \PY{n}{X} \PY{o}{=} \PY{n}{sm}\PY{o}{.}\PY{n}{add\PYZus{}constant}\PY{p}{(}\PY{n}{X}\PY{p}{,} \PY{n}{has\PYZus{}constant}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{add}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{y} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{p}{[}\PY{n}{var}\PY{p}{]}\PY{p}{]}
        
        \PY{k}{if} \PY{n}{model\PYZus{}type} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ols}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
            \PY{n}{model} \PY{o}{=} \PY{n}{sm}\PY{o}{.}\PY{n}{OLS}\PY{p}{(}\PY{n}{y}\PY{p}{,} \PY{n}{X}\PY{p}{)}
        \PY{k}{elif} \PY{n}{model\PYZus{}type} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{wls}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
            \PY{n}{model} \PY{o}{=} \PY{n}{sm}\PY{o}{.}\PY{n}{WLS}\PY{p}{(}\PY{n}{y}\PY{p}{,} \PY{n}{X}\PY{p}{,} \PY{n}{weights}\PY{o}{=}\PY{n}{weights}\PY{p}{)}
        
        \PY{n}{results} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{p}{)}
        \PY{n}{residuals}\PY{p}{[}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s2}{epsilon\PYZus{}}\PY{l+s+se}{\PYZob{}\PYZob{}}\PY{l+s+si}{\PYZob{}}\PY{n}{var}\PY{l+s+si}{\PYZcb{}}\PY{l+s+se}{\PYZcb{}\PYZcb{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{results}\PY{o}{.}\PY{n}{resid}
    \PY{k}{return} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{residuals}\PY{p}{)}

\PY{k}{def} \PY{n+nf}{ols\PYZus{}wls\PYZus{}combinations\PYZus{}full}\PY{p}{(}\PY{n}{df}\PY{p}{,} \PY{n}{dependent\PYZus{}var}\PY{p}{,} \PY{n}{independent\PYZus{}vars}\PY{p}{,} \PY{n}{model\PYZus{}type}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ols}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} 
                              \PY{n}{always\PYZus{}include}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,} \PY{n}{never\PYZus{}include}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,} \PY{n}{df\PYZus{}name}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{df}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} 
                              \PY{n}{include\PYZus{}constant}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{p}{:}
    \PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{seed}\PY{p}{(}\PY{k+kc}{None}\PY{p}{)}
    \PY{n}{df} \PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{replace}\PY{p}{(}\PY{p}{[}\PY{n}{np}\PY{o}{.}\PY{n}{inf}\PY{p}{,} \PY{o}{\PYZhy{}}\PY{n}{np}\PY{o}{.}\PY{n}{inf}\PY{p}{]}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{nan}\PY{p}{)}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{p}{)}

    \PY{k}{if} \PY{n}{model\PYZus{}type} \PY{o+ow}{not} \PY{o+ow}{in} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ols}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{wls}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{:}
        \PY{k}{raise} \PY{n+ne}{ValueError}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{model\PYZus{}type must be either }\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{ols}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{ or }\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{wls}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}

    \PY{k}{if} \PY{n}{model\PYZus{}type} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{wls}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
        \PY{n}{county\PYZus{}unem} \PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FIPS}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{[}\PY{n}{dependent\PYZus{}var}\PY{p}{]}\PY{o}{.}\PY{n}{var}\PY{p}{(}\PY{p}{)}
        \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{weight}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FIPS}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{map}\PY{p}{(}\PY{k}{lambda} \PY{n}{x}\PY{p}{:} \PY{l+m+mi}{1} \PY{o}{/} \PY{n}{county\PYZus{}unem}\PY{o}{.}\PY{n}{get}\PY{p}{(}\PY{n}{x}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{nan}\PY{p}{)}\PY{p}{)}
        \PY{n}{df} \PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{replace}\PY{p}{(}\PY{p}{[}\PY{n}{np}\PY{o}{.}\PY{n}{inf}\PY{p}{,} \PY{o}{\PYZhy{}}\PY{n}{np}\PY{o}{.}\PY{n}{inf}\PY{p}{]}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{nan}\PY{p}{)}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{n}{subset}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{weight}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
        \PY{n}{weights} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{weight}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
    \PY{k}{else}\PY{p}{:}
        \PY{n}{weights} \PY{o}{=} \PY{k+kc}{None}

    \PY{k}{if} \PY{n}{always\PYZus{}include} \PY{o+ow}{is} \PY{k+kc}{None}\PY{p}{:}
        \PY{n}{always\PYZus{}include} \PY{o}{=} \PY{p}{[}\PY{p}{]}
    \PY{k}{if} \PY{n}{never\PYZus{}include} \PY{o+ow}{is} \PY{k+kc}{None}\PY{p}{:}
        \PY{n}{never\PYZus{}include} \PY{o}{=} \PY{p}{[}\PY{p}{]}

    \PY{n}{independent\PYZus{}vars} \PY{o}{=} \PY{p}{[}\PY{n}{var} \PY{k}{for} \PY{n}{var} \PY{o+ow}{in} \PY{n}{independent\PYZus{}vars} \PY{k}{if} \PY{n}{var} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{never\PYZus{}include}\PY{p}{]}

    \PY{n}{results} \PY{o}{=} \PY{p}{[}\PY{p}{]}
    \PY{n}{residuals\PYZus{}dict} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}

    \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n+nb}{len}\PY{p}{(}\PY{n}{independent\PYZus{}vars}\PY{p}{)} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{:}
        \PY{k}{for} \PY{n}{combo} \PY{o+ow}{in} \PY{n}{itertools}\PY{o}{.}\PY{n}{combinations}\PY{p}{(}\PY{n}{independent\PYZus{}vars}\PY{p}{,} \PY{n}{i}\PY{p}{)}\PY{p}{:}
            \PY{n}{combo} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n}{always\PYZus{}include}\PY{p}{)} \PY{o}{+} \PY{n+nb}{list}\PY{p}{(}\PY{n}{combo}\PY{p}{)}
            \PY{n}{X} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{n}{combo}\PY{p}{]}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}

            \PY{k}{if} \PY{n}{include\PYZus{}constant}\PY{p}{:}
                \PY{n}{X} \PY{o}{=} \PY{n}{sm}\PY{o}{.}\PY{n}{add\PYZus{}constant}\PY{p}{(}\PY{n}{X}\PY{p}{,} \PY{n}{has\PYZus{}constant}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{add}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

            \PY{n}{common\PYZus{}index} \PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{index}\PY{o}{.}\PY{n}{intersection}\PY{p}{(}\PY{n}{X}\PY{o}{.}\PY{n}{index}\PY{p}{)}
            \PY{n}{y\PYZus{}common} \PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{common\PYZus{}index}\PY{p}{,} \PY{n}{dependent\PYZus{}var}\PY{p}{]}
            \PY{n}{X\PYZus{}common} \PY{o}{=} \PY{n}{X}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{common\PYZus{}index}\PY{p}{]}

            \PY{k}{if} \PY{n}{model\PYZus{}type} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ols}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
                \PY{n}{model} \PY{o}{=} \PY{n}{sm}\PY{o}{.}\PY{n}{OLS}\PY{p}{(}\PY{n}{y\PYZus{}common}\PY{p}{,} \PY{n}{X\PYZus{}common}\PY{p}{)}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{p}{)}
            \PY{k}{elif} \PY{n}{model\PYZus{}type} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{wls}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
                \PY{n}{weights\PYZus{}common} \PY{o}{=} \PY{n}{weights}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{common\PYZus{}index}\PY{p}{]}
                \PY{n}{model} \PY{o}{=} \PY{n}{sm}\PY{o}{.}\PY{n}{WLS}\PY{p}{(}\PY{n}{y\PYZus{}common}\PY{p}{,} \PY{n}{X\PYZus{}common}\PY{p}{,} \PY{n}{weights}\PY{o}{=}\PY{n}{weights\PYZus{}common}\PY{p}{)}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{p}{)}

            \PY{n}{beta\PYZus{}estimates} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{params}
            \PY{n}{std\PYZus{}errors} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{bse}
            \PY{n}{p\PYZus{}values} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{pvalues}
            \PY{n}{r\PYZus{}squared} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{rsquared}
            \PY{n}{y\PYZus{}pred} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}common}\PY{p}{)}
            \PY{n}{mse} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{(}\PY{n}{y\PYZus{}common} \PY{o}{\PYZhy{}} \PY{n}{y\PYZus{}pred}\PY{p}{)} \PY{o}{*}\PY{o}{*} \PY{l+m+mi}{2}\PY{p}{)}

            \PY{c+c1}{\PYZsh{} Format the variables in a readable manner}
            \PY{n}{formatted\PYZus{}vars} \PY{o}{=} \PY{p}{[}
                \PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}}\PY{n}{var}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{: }\PY{l+s+si}{\PYZob{}}\PY{n}{beta\PYZus{}estimates}\PY{p}{[}\PY{n}{idx}\PY{+w}{ }\PY{o}{+}\PY{+w}{ }\PY{n+nb}{int}\PY{p}{(}\PY{n}{include\PYZus{}constant}\PY{p}{)}\PY{p}{]}\PY{l+s+si}{:}\PY{l+s+s1}{.4f}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{ (SE: }\PY{l+s+si}{\PYZob{}}\PY{n}{std\PYZus{}errors}\PY{p}{[}\PY{n}{idx}\PY{+w}{ }\PY{o}{+}\PY{+w}{ }\PY{n+nb}{int}\PY{p}{(}\PY{n}{include\PYZus{}constant}\PY{p}{)}\PY{p}{]}\PY{l+s+si}{:}\PY{l+s+s1}{.4f}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{, p: }\PY{l+s+si}{\PYZob{}}\PY{n}{p\PYZus{}values}\PY{p}{[}\PY{n}{idx}\PY{+w}{ }\PY{o}{+}\PY{+w}{ }\PY{n+nb}{int}\PY{p}{(}\PY{n}{include\PYZus{}constant}\PY{p}{)}\PY{p}{]}\PY{l+s+si}{:}\PY{l+s+s1}{.4f}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{)}\PY{l+s+s1}{\PYZsq{}}
                \PY{k}{for} \PY{n}{idx}\PY{p}{,} \PY{n}{var} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{combo}\PY{p}{)}
            \PY{p}{]}

            \PY{n}{result} \PY{o}{=} \PY{p}{\PYZob{}}
                \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DataFrame}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{df\PYZus{}name}\PY{p}{,}
                \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Model}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{, }\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{const}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{+} \PY{n}{combo}\PY{p}{)} \PY{k}{if} \PY{n}{include\PYZus{}constant} \PY{k}{else} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{, }\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{combo}\PY{p}{)}\PY{p}{,}
                \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r\PYZhy{}squared}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{r\PYZus{}squared}\PY{p}{,}
                \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{MSE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{mse}\PY{p}{,}
                \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Variables}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZlt{}br\PYZgt{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{formatted\PYZus{}vars}\PY{p}{)}
            \PY{p}{\PYZcb{}}

            \PY{k}{for} \PY{n}{idx}\PY{p}{,} \PY{n}{var} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{combo}\PY{p}{)}\PY{p}{:}
                \PY{n}{result}\PY{p}{[}\PY{n}{var}\PY{p}{]} \PY{o}{=} \PY{n}{beta\PYZus{}estimates}\PY{p}{[}\PY{n}{idx} \PY{o}{+} \PY{n+nb}{int}\PY{p}{(}\PY{n}{include\PYZus{}constant}\PY{p}{)}\PY{p}{]}
                \PY{n}{result}\PY{p}{[}\PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}}\PY{n}{var}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{\PYZus{}SE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{std\PYZus{}errors}\PY{p}{[}\PY{n}{idx} \PY{o}{+} \PY{n+nb}{int}\PY{p}{(}\PY{n}{include\PYZus{}constant}\PY{p}{)}\PY{p}{]}
                \PY{n}{result}\PY{p}{[}\PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}}\PY{n}{var}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{\PYZus{}p}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{p\PYZus{}values}\PY{p}{[}\PY{n}{idx} \PY{o}{+} \PY{n+nb}{int}\PY{p}{(}\PY{n}{include\PYZus{}constant}\PY{p}{)}\PY{p}{]}

            \PY{k}{if} \PY{n}{include\PYZus{}constant}\PY{p}{:}
                \PY{n}{result}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{const}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{beta\PYZus{}estimates}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
                \PY{n}{result}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{const\PYZus{}SE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{std\PYZus{}errors}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
                \PY{n}{result}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{const\PYZus{}p}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{p\PYZus{}values}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
                
            \PY{n}{results}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{result}\PY{p}{)}

            \PY{c+c1}{\PYZsh{} Store residuals for the current combination}
            \PY{n}{sorted\PYZus{}combo} \PY{o}{=} \PY{n+nb}{tuple}\PY{p}{(}\PY{n+nb}{sorted}\PY{p}{(}\PY{n}{combo}\PY{p}{)}\PY{p}{)}
            \PY{n}{residuals\PYZus{}dict}\PY{p}{[}\PY{n}{sorted\PYZus{}combo}\PY{p}{]} \PY{o}{=} \PY{n}{calculate\PYZus{}residuals}\PY{p}{(}\PY{n}{df}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{common\PYZus{}index}\PY{p}{]}\PY{p}{,} \PY{n}{dependent\PYZus{}var}\PY{p}{,} \PY{n}{combo}\PY{p}{,} \PY{n}{model\PYZus{}type}\PY{o}{=}\PY{n}{model\PYZus{}type}\PY{p}{,} \PY{n}{weights}\PY{o}{=}\PY{n}{weights\PYZus{}common} \PY{k}{if} \PY{n}{model\PYZus{}type} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{wls}\PY{l+s+s1}{\PYZsq{}} \PY{k}{else} \PY{k+kc}{None}\PY{p}{,} \PY{n}{include\PYZus{}constant}\PY{o}{=}\PY{n}{include\PYZus{}constant}\PY{p}{)}

    \PY{n}{results\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{results}\PY{p}{)}
    \PY{k}{return} \PY{n}{results\PYZus{}df}\PY{p}{,} \PY{n}{residuals\PYZus{}dict}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{18}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} Rates ols}
\PY{n}{results\PYZus{}ols\PYZus{}rates}\PY{p}{,} \PY{n}{residuals\PYZus{}ols\PYZus{}rates} \PY{o}{=} \PY{n}{ols\PYZus{}wls\PYZus{}combinations\PYZus{}full}\PY{p}{(}\PY{n}{df\PYZus{}rates}\PY{p}{,} \PY{n}{dv}\PY{p}{,} \PY{n}{iv}\PY{p}{,} 
                                                                           \PY{n}{model\PYZus{}type}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ols}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} 
                                                                           \PY{n}{always\PYZus{}include}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,} 
                                                                           \PY{n}{never\PYZus{}include}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,} 
                                                                           \PY{n}{df\PYZus{}name}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Rates ols)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} 
                                                                           \PY{n}{include\PYZus{}constant}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}


\PY{c+c1}{\PYZsh{}rates, wls, clusters, efw}
\PY{n}{results\PYZus{}wls\PYZus{}rates}\PY{p}{,} \PY{n}{residuals\PYZus{}wls\PYZus{}rates} \PY{o}{=} \PY{n}{ols\PYZus{}wls\PYZus{}combinations\PYZus{}full}\PY{p}{(}\PY{n}{df\PYZus{}rates}\PY{p}{,} \PY{n}{dv}\PY{p}{,} \PY{n}{iv}\PY{p}{,} 
                                                                           \PY{n}{model\PYZus{}type}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{wls}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} 
                                                                           \PY{n}{always\PYZus{}include}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,} 
                                                                           \PY{n}{never\PYZus{}include}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,} 
                                                                           \PY{n}{df\PYZus{}name}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Rates wls)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                                                          \PY{n}{include\PYZus{}constant}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}


\PY{c+c1}{\PYZsh{}diff rates, ols, cluster, efw}
\PY{n}{results\PYZus{}ols\PYZus{}diff\PYZus{}rates}\PY{p}{,} \PY{n}{residuals\PYZus{}ols\PYZus{}diff\PYZus{}rates} \PY{o}{=} \PY{n}{ols\PYZus{}wls\PYZus{}combinations\PYZus{}full}\PY{p}{(}\PY{n}{df\PYZus{}diff}\PY{p}{,} \PY{n}{dv}\PY{p}{,} \PY{n}{iv}\PY{p}{,} 
                                                                                     \PY{n}{model\PYZus{}type}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ols}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} 
                                                                                     \PY{n}{always\PYZus{}include}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,} 
                                                                                     \PY{n}{never\PYZus{}include}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,} 
                                                                                     \PY{n}{df\PYZus{}name}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Diff rates ols}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} 
                                                                                     \PY{n}{include\PYZus{}constant}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}




\PY{c+c1}{\PYZsh{} Combine the results and residuals into dictionaries}
\PY{n}{results\PYZus{}dict\PYZus{}full} \PY{o}{=} \PY{p}{\PYZob{}}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Rates wls}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{results\PYZus{}wls\PYZus{}rates}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Rates ols}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{results\PYZus{}ols\PYZus{}rates}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Diff rates ols}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{results\PYZus{}ols\PYZus{}diff\PYZus{}rates}
\PY{p}{\PYZcb{}}

\PY{n}{residuals\PYZus{}dict\PYZus{}full} \PY{o}{=} \PY{p}{\PYZob{}}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Rates wls}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{residuals\PYZus{}wls\PYZus{}rates}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Rates ols}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{residuals\PYZus{}ols\PYZus{}rates}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Diff rates ols}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{residuals\PYZus{}ols\PYZus{}diff\PYZus{}rates}
\PY{p}{\PYZcb{}}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{19}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{rates\PYZus{}full\PYZus{}wls} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Rates wls}\PY{l+s+s1}{\PYZsq{}}

\PY{n}{variable\PYZus{}combinations} \PY{o}{=} \PY{p}{[}
    \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{const}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M4I}\PY{l+s+s1}{\PYZsq{}}\PY{p}{\PYZcb{}}\PY{p}{,}
    \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{const}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Agri}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Util}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mini}\PY{l+s+s1}{\PYZsq{}}\PY{p}{\PYZcb{}}\PY{p}{,}
    \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{const}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Agri}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mini}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Util}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M4I}\PY{l+s+s1}{\PYZsq{}}\PY{p}{\PYZcb{}}\PY{p}{,}
    \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{const}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M4I}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Agri}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mini}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Util}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{EFW}\PY{l+s+s1}{\PYZsq{}}\PY{p}{\PYZcb{}}\PY{p}{,}
    \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{const}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M4I}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Agri}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mini}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Util}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{clusters\PYZus{}2.0}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{clusters\PYZus{}3.0}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{clusters\PYZus{}4.0}\PY{l+s+s1}{\PYZsq{}}\PY{p}{\PYZcb{}}\PY{p}{,}
    \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{const}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M4I}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Agri}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mini}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Util}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{EFW}\PY{l+s+s1}{\PYZsq{}} \PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{clusters\PYZus{}2.0}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{clusters\PYZus{}3.0}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{clusters\PYZus{}4.0}\PY{l+s+s1}{\PYZsq{}}\PY{p}{\PYZcb{}}\PY{p}{]}

\PY{n}{column\PYZus{}names} \PY{o}{=} \PY{p}{[}
    \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{M4}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{s only}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sectors only}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M4+sectors}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M4+sectors+EFW}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M4+sectors+clusters}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{All variables}\PY{l+s+s1}{\PYZsq{}}
\PY{p}{]}

\PY{c+c1}{\PYZsh{} Specify the row(s) to exclude from display}
\PY{n}{exclude\PYZus{}rows} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Variables}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}

\PY{n}{rates\PYZus{}full\PYZus{}reg\PYZus{}wls} \PY{o}{=} \PY{n}{filter\PYZus{}results\PYZus{}table}\PY{p}{(}\PY{n}{results\PYZus{}dict\PYZus{}full}\PY{p}{,} \PY{n}{rates\PYZus{}full\PYZus{}wls}\PY{p}{,} \PY{n}{variable\PYZus{}combinations}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{20}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{rates\PYZus{}full\PYZus{}ols} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Rates ols}\PY{l+s+s1}{\PYZsq{}}

\PY{c+c1}{\PYZsh{} Specify the row(s) to exclude from display}
\PY{n}{exclude\PYZus{}rows} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Variables}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}

\PY{n}{rates\PYZus{}full\PYZus{}reg\PYZus{}ols} \PY{o}{=} \PY{n}{filter\PYZus{}results\PYZus{}table}\PY{p}{(}\PY{n}{results\PYZus{}dict\PYZus{}full}\PY{p}{,} \PY{n}{rates\PYZus{}full\PYZus{}ols}\PY{p}{,} \PY{n}{variable\PYZus{}combinations}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{21}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{Diff\PYZus{}rates\PYZus{}full\PYZus{}ols} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Diff rates ols}\PY{l+s+s1}{\PYZsq{}}

\PY{n}{variables\PYZus{}combo\PYZus{}diff} \PY{o}{=} \PY{p}{[}
    \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M4I}\PY{l+s+s1}{\PYZsq{}}\PY{p}{\PYZcb{}}\PY{p}{,}
    \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Agri}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Util}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mini}\PY{l+s+s1}{\PYZsq{}}\PY{p}{\PYZcb{}}\PY{p}{,}
    \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Agri}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mini}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Util}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M4I}\PY{l+s+s1}{\PYZsq{}}\PY{p}{\PYZcb{}}\PY{p}{,}
    \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M4I}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Agri}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mini}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Util}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{EFW}\PY{l+s+s1}{\PYZsq{}}\PY{p}{\PYZcb{}}\PY{p}{,}
    \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M4I}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Agri}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mini}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Util}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{clusters\PYZus{}2.0}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{clusters\PYZus{}3.0}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{clusters\PYZus{}4.0}\PY{l+s+s1}{\PYZsq{}}\PY{p}{\PYZcb{}}\PY{p}{,}
    \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M4I}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Agri}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mini}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Util}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{EFW}\PY{l+s+s1}{\PYZsq{}} \PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{clusters\PYZus{}2.0}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{clusters\PYZus{}3.0}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{clusters\PYZus{}4.0}\PY{l+s+s1}{\PYZsq{}}\PY{p}{\PYZcb{}}\PY{p}{]}

\PY{n}{column\PYZus{}names} \PY{o}{=} \PY{p}{[}
    \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{M4}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{s only}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sectors only}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M4+sectors}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M4+sectors+EFW}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M4+sectors+clusters}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{All variables}\PY{l+s+s1}{\PYZsq{}}
\PY{p}{]}

\PY{c+c1}{\PYZsh{} Specify the row(s) to exclude from display}
\PY{n}{exclude\PYZus{}rows} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Variables}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}

\PY{n}{Diff\PYZus{}rates\PYZus{}full\PYZus{}reg\PYZus{}ols} \PY{o}{=} \PY{n}{filter\PYZus{}results\PYZus{}table}\PY{p}{(}\PY{n}{results\PYZus{}dict\PYZus{}full}\PY{p}{,} \PY{n}{Diff\PYZus{}rates\PYZus{}full\PYZus{}ols}\PY{p}{,} \PY{n}{variables\PYZus{}combo\PYZus{}diff}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{22}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Rates ols full model :}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{display\PYZus{}results\PYZus{}table}\PY{p}{(}\PY{n}{rates\PYZus{}full\PYZus{}reg\PYZus{}ols}\PY{p}{,} \PY{n}{variable\PYZus{}combinations}\PY{p}{,} \PY{n}{column\PYZus{}names}\PY{p}{,} \PY{n}{exclude\PYZus{}rows}\PY{p}{)}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Differenced rates ols full model :}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{display\PYZus{}results\PYZus{}table}\PY{p}{(}\PY{n}{Diff\PYZus{}rates\PYZus{}full\PYZus{}reg\PYZus{}ols}\PY{p}{,} \PY{n}{variables\PYZus{}combo\PYZus{}diff}\PY{p}{,} \PY{n}{column\PYZus{}names}\PY{p}{,} \PY{n}{exclude\PYZus{}rows}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Rates ols full model :
    \end{Verbatim}

    
    \begin{Verbatim}[commandchars=\\\{\}]
<pandas.io.formats.style.Styler at 0x31ef6ea10>
    \end{Verbatim}

    
    
    \begin{Verbatim}[commandchars=\\\{\}]
<IPython.core.display.HTML object>
    \end{Verbatim}

    
    \begin{Verbatim}[commandchars=\\\{\}]
None
Differenced rates ols full model :
    \end{Verbatim}

    
    \begin{Verbatim}[commandchars=\\\{\}]
<pandas.io.formats.style.Styler at 0x31f0b5210>
    \end{Verbatim}

    
    
    \begin{Verbatim}[commandchars=\\\{\}]
<IPython.core.display.HTML object>
    \end{Verbatim}

    
    \begin{Verbatim}[commandchars=\\\{\}]
None
    \end{Verbatim}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{23}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import} \PY{n+nn}{os}
\PY{k+kn}{import} \PY{n+nn}{networkx} \PY{k}{as} \PY{n+nn}{nx}
\PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
\PY{k+kn}{from} \PY{n+nn}{pgmpy}\PY{n+nn}{.}\PY{n+nn}{estimators} \PY{k+kn}{import} \PY{n}{PC}
\PY{k+kn}{from} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{patches} \PY{k+kn}{import} \PY{n}{ArrowStyle}
\PY{k+kn}{from} \PY{n+nn}{networkx}\PY{n+nn}{.}\PY{n+nn}{drawing}\PY{n+nn}{.}\PY{n+nn}{nx\PYZus{}pydot} \PY{k+kn}{import} \PY{n}{graphviz\PYZus{}layout}
\PY{k+kn}{from} \PY{n+nn}{networkx}\PY{n+nn}{.}\PY{n+nn}{drawing}\PY{n+nn}{.}\PY{n+nn}{nx\PYZus{}agraph} \PY{k+kn}{import} \PY{n}{graphviz\PYZus{}layout}

\PY{c+c1}{\PYZsh{} Function to plot directed acyclic graph (DAG) with correlation labels}
\PY{k}{def} \PY{n+nf}{graph\PYZus{}DAG}\PY{p}{(}\PY{n}{edges}\PY{p}{,} \PY{n}{df}\PY{p}{,} \PY{n}{title}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{save\PYZus{}path}\PY{o}{=}\PY{k+kc}{None}\PY{p}{)}\PY{p}{:}
    \PY{n}{graph} \PY{o}{=} \PY{n}{nx}\PY{o}{.}\PY{n}{DiGraph}\PY{p}{(}\PY{p}{)}
    
    \PY{c+c1}{\PYZsh{} Calculate and set edge labels}
    \PY{n}{edge\PYZus{}labels} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
    \PY{k}{for} \PY{n}{edge} \PY{o+ow}{in} \PY{n}{edges}\PY{p}{:}
        \PY{n}{controls} \PY{o}{=} \PY{p}{[}\PY{n}{key} \PY{k}{for} \PY{n}{key} \PY{o+ow}{in} \PY{n}{df}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)} \PY{k}{if} \PY{n}{key} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{edge}\PY{p}{]}
        \PY{n}{controls} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n+nb}{set}\PY{p}{(}\PY{n}{controls}\PY{p}{)}\PY{p}{)}
        \PY{n}{keep\PYZus{}controls} \PY{o}{=} \PY{p}{[}\PY{p}{]}
        \PY{k}{for} \PY{n}{control} \PY{o+ow}{in} \PY{n}{controls}\PY{p}{:}
            \PY{n}{control\PYZus{}edges} \PY{o}{=} \PY{p}{[}\PY{n}{ctrl\PYZus{}edge} \PY{k}{for} \PY{n}{ctrl\PYZus{}edge} \PY{o+ow}{in} \PY{n}{edges} \PY{k}{if} \PY{n}{control} \PY{o}{==} \PY{n}{ctrl\PYZus{}edge}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{]}
            \PY{k}{if} \PY{p}{(}\PY{n}{control}\PY{p}{,} \PY{n}{edge}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)} \PY{o+ow}{in} \PY{n}{control\PYZus{}edges}\PY{p}{:}
                \PY{n}{keep\PYZus{}controls}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{control}\PY{p}{)}
        \PY{n}{pcorr} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{p}{[}\PY{n}{edge}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{edge}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{]} \PY{o}{+} \PY{n}{keep\PYZus{}controls}\PY{p}{]}\PY{o}{.}\PY{n}{pcorr}\PY{p}{(}\PY{p}{)}
        \PY{n}{edge\PYZus{}labels}\PY{p}{[}\PY{n}{edge}\PY{p}{]} \PY{o}{=} \PY{n+nb}{str}\PY{p}{(}\PY{n+nb}{round}\PY{p}{(}\PY{n}{pcorr}\PY{p}{[}\PY{n}{edge}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{edge}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{]}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)}
        
    \PY{n}{graph}\PY{o}{.}\PY{n}{add\PYZus{}edges\PYZus{}from}\PY{p}{(}\PY{n}{edges}\PY{p}{)}
    \PY{n}{color\PYZus{}map} \PY{o}{=} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{C0}\PY{l+s+s2}{\PYZdq{}} \PY{k}{for} \PY{n}{g} \PY{o+ow}{in} \PY{n}{graph}\PY{p}{]}
    \PY{n}{fig}\PY{p}{,} \PY{n}{ax} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{20}\PY{p}{,} \PY{l+m+mi}{12}\PY{p}{)}\PY{p}{)}
    \PY{n}{pos} \PY{o}{=} \PY{n}{graphviz\PYZus{}layout}\PY{p}{(}\PY{n}{graph}\PY{p}{,} \PY{n}{prog}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{neato}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{n}{title}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{30}\PY{p}{)}
    \PY{n}{nx}\PY{o}{.}\PY{n}{draw\PYZus{}networkx}\PY{p}{(}\PY{n}{graph}\PY{p}{,} \PY{n}{pos}\PY{p}{,} \PY{n}{node\PYZus{}color}\PY{o}{=}\PY{n}{color\PYZus{}map}\PY{p}{,} \PY{n}{node\PYZus{}size}\PY{o}{=}\PY{l+m+mi}{1200}\PY{p}{,}
                     \PY{n}{with\PYZus{}labels}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,} \PY{n}{arrows}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,} \PY{n}{font\PYZus{}color}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{white}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
                     \PY{n}{font\PYZus{}size}\PY{o}{=}\PY{l+m+mi}{15}\PY{p}{,} \PY{n}{alpha}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{width}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{edge\PYZus{}color}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{C1}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
                     \PY{n}{arrowstyle}\PY{o}{=}\PY{n}{ArrowStyle}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Fancy, head\PYZus{}length=1.5, head\PYZus{}width=1.5, tail\PYZus{}width=0.1}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{,}
                     \PY{n}{connectionstyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{arc3, rad = 0.05}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ax}\PY{o}{=}\PY{n}{ax}\PY{p}{)}

    \PY{c+c1}{\PYZsh{} Draw edge labels}
    \PY{n}{nx}\PY{o}{.}\PY{n}{draw\PYZus{}networkx\PYZus{}edge\PYZus{}labels}\PY{p}{(}\PY{n}{graph}\PY{p}{,} \PY{n}{pos}\PY{p}{,} \PY{n}{edge\PYZus{}labels}\PY{o}{=}\PY{n}{edge\PYZus{}labels}\PY{p}{,} \PY{n}{font\PYZus{}color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{green}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{font\PYZus{}size}\PY{o}{=}\PY{l+m+mi}{20}\PY{p}{)}
    
    \PY{c+c1}{\PYZsh{} Save the plot if save\PYZus{}path is provided}
    \PY{k}{if} \PY{n}{save\PYZus{}path}\PY{p}{:}
        \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{n}{save\PYZus{}path}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}

\PY{c+c1}{\PYZsh{} Function to plot graphs for a single dataframe or a dictionary of dataframes}
\PY{k}{def} \PY{n+nf}{plot\PYZus{}graph}\PY{p}{(}\PY{n}{data}\PY{p}{,} \PY{n}{p\PYZus{}val}\PY{o}{=}\PY{l+m+mf}{0.001}\PY{p}{,} \PY{n}{figsize\PYZus{}single}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{20}\PY{p}{,} \PY{l+m+mi}{12}\PY{p}{)}\PY{p}{,} \PY{n}{figsize\PYZus{}dict}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{24}\PY{p}{,} \PY{l+m+mi}{20}\PY{p}{)}\PY{p}{,} \PY{n}{overall\PYZus{}title}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{save\PYZus{}dir}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{:}
    \PY{c+c1}{\PYZsh{} Create the directory if it does not exist}
    \PY{k}{if} \PY{n}{save\PYZus{}dir} \PY{o+ow}{and} \PY{o+ow}{not} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{exists}\PY{p}{(}\PY{n}{save\PYZus{}dir}\PY{p}{)}\PY{p}{:}
        \PY{n}{os}\PY{o}{.}\PY{n}{makedirs}\PY{p}{(}\PY{n}{save\PYZus{}dir}\PY{p}{)}

    \PY{k}{if} \PY{n+nb}{isinstance}\PY{p}{(}\PY{n}{data}\PY{p}{,} \PY{n+nb}{dict}\PY{p}{)}\PY{p}{:}
        \PY{n}{data\PYZus{}dict} \PY{o}{=} \PY{n}{data}
        \PY{n}{figsize} \PY{o}{=} \PY{n}{figsize\PYZus{}dict}
    \PY{k}{else}\PY{p}{:}
        \PY{n}{data\PYZus{}dict} \PY{o}{=} \PY{p}{\PYZob{}}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Single Dataframe}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{n}{data}\PY{p}{\PYZcb{}}
        \PY{n}{figsize} \PY{o}{=} \PY{n}{figsize\PYZus{}single}

    \PY{k}{for} \PY{n}{df\PYZus{}name}\PY{p}{,} \PY{n}{df} \PY{o+ow}{in} \PY{n}{data\PYZus{}dict}\PY{o}{.}\PY{n}{items}\PY{p}{(}\PY{p}{)}\PY{p}{:}
        \PY{n}{c} \PY{o}{=} \PY{n}{PC}\PY{p}{(}\PY{n}{df}\PY{p}{)}
        \PY{n}{max\PYZus{}cond\PYZus{}vars} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{df}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{l+m+mi}{2}
        \PY{n}{model} \PY{o}{=} \PY{n}{c}\PY{o}{.}\PY{n}{estimate}\PY{p}{(}\PY{n}{return\PYZus{}type}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dag}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{variant}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{orig}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{significance\PYZus{}level}\PY{o}{=}\PY{n}{p\PYZus{}val}\PY{p}{,} \PY{n}{max\PYZus{}cond\PYZus{}vars}\PY{o}{=}\PY{n}{max\PYZus{}cond\PYZus{}vars}\PY{p}{,} \PY{n}{ci\PYZus{}test}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{pearsonr}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
        \PY{n}{edges} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{edges}\PY{p}{(}\PY{p}{)}
        \PY{n}{graph\PYZus{}title} \PY{o}{=} \PY{n}{df\PYZus{}name} \PY{k}{if} \PY{n}{df\PYZus{}name} \PY{k}{else} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Directed Acyclic Graph}\PY{l+s+s2}{\PYZdq{}}
        
        \PY{c+c1}{\PYZsh{} Sanitize df\PYZus{}name to create a valid filename}
        \PY{n}{sanitized\PYZus{}name} \PY{o}{=} \PY{n}{df\PYZus{}name}\PY{o}{.}\PY{n}{replace}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{/}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZus{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{replace}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZus{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{} Generate the save path if save\PYZus{}dir is provided}
        \PY{k}{if} \PY{n}{save\PYZus{}dir}\PY{p}{:}
            \PY{n}{save\PYZus{}path} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{save\PYZus{}dir}\PY{p}{,} \PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZob{}}\PY{n}{sanitized\PYZus{}name}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{.png}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
        \PY{k}{else}\PY{p}{:}
            \PY{n}{save\PYZus{}path} \PY{o}{=} \PY{k+kc}{None}
        
        \PY{n}{graph\PYZus{}DAG}\PY{p}{(}\PY{n}{edges}\PY{p}{,} \PY{n}{df}\PY{p}{,} \PY{n}{title}\PY{o}{=}\PY{n}{graph\PYZus{}title}\PY{p}{,} \PY{n}{save\PYZus{}path}\PY{o}{=}\PY{n}{save\PYZus{}path}\PY{p}{)}

    \PY{k}{if} \PY{n}{overall\PYZus{}title}\PY{p}{:}
        \PY{n}{plt}\PY{o}{.}\PY{n}{suptitle}\PY{p}{(}\PY{n}{overall\PYZus{}title}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{16}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{24}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{process\PYZus{}dataframes}\PY{p}{(}\PY{n}{df}\PY{p}{,} \PY{n}{drop\PYZus{}cols}\PY{p}{)}\PY{p}{:}
    \PY{n}{df\PYZus{}clean} \PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{set\PYZus{}index}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FIPS}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{TimePeriod}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
    \PY{n}{df\PYZus{}copy1} \PY{o}{=} \PY{n}{df\PYZus{}clean}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}
    \PY{n}{df\PYZus{}copy2} \PY{o}{=} \PY{n}{df\PYZus{}clean}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}
    \PY{n}{df\PYZus{}copy3} \PY{o}{=} \PY{n}{df\PYZus{}clean}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}
    
    \PY{n}{df\PYZus{}copy1}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{n}{drop\PYZus{}cols}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
    \PY{n}{df\PYZus{}copy2}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{n}{drop\PYZus{}cols}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
    \PY{n}{df\PYZus{}copy3}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{n}{drop\PYZus{}cols}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
    
    \PY{k}{return} \PY{n}{df\PYZus{}clean}\PY{p}{,} \PY{n}{df\PYZus{}copy1}\PY{p}{,} \PY{n}{df\PYZus{}copy2}\PY{p}{,} \PY{n}{df\PYZus{}copy3}

\PY{n}{full\PYZus{}df\PYZus{}drop\PYZus{}cols} \PY{o}{=} \PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{EFW}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{clusters}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{EFW}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{clusters}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}
\PY{n}{diff\PYZus{}df\PYZus{}drop\PYZus{}cols} \PY{o}{=} \PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{EFW}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{clusters}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{EFW}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{clusters}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}

\PY{n}{rates\PYZus{}efw}\PY{p}{,} \PY{n}{rates\PYZus{}no\PYZus{}efw}\PY{p}{,} \PY{n}{rates\PYZus{}efw\PYZus{}no\PYZus{}cluster}\PY{p}{,} \PY{n}{rates\PYZus{}no\PYZus{}efw\PYZus{}no\PYZus{}cluster} \PY{o}{=} \PY{n}{process\PYZus{}dataframes}\PY{p}{(}\PY{n}{full\PYZus{}df\PYZus{}rates\PYZus{}cluster}\PY{p}{,} \PY{n}{full\PYZus{}df\PYZus{}drop\PYZus{}cols}\PY{p}{)}
\PY{n}{diff\PYZus{}rates\PYZus{}efw}\PY{p}{,} \PY{n}{diff\PYZus{}rates\PYZus{}no\PYZus{}efw}\PY{p}{,} \PY{n}{diff\PYZus{}rates\PYZus{}efw\PYZus{}no\PYZus{}cluster}\PY{p}{,} \PY{n}{diff\PYZus{}rates\PYZus{}no\PYZus{}efw\PYZus{}no\PYZus{}cluster} \PY{o}{=} \PY{n}{process\PYZus{}dataframes}\PY{p}{(}\PY{n}{full\PYZus{}df\PYZus{}diff\PYZus{}cluster}\PY{p}{,} \PY{n}{diff\PYZus{}df\PYZus{}drop\PYZus{}cols}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{25}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{dataframes\PYZus{}dict} \PY{o}{=} \PY{p}{\PYZob{}}
\PY{c+c1}{\PYZsh{}     \PYZsq{}rates w/efw w/clusters\PYZsq{}: rates\PYZus{}efw,}
\PY{c+c1}{\PYZsh{}     \PYZsq{}rates w/o efw w/clusters\PYZsq{}: rates\PYZus{}no\PYZus{}efw,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rates w/efw w/o clusters}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{rates\PYZus{}efw\PYZus{}no\PYZus{}cluster}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rates w/o efw w/o clusters}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{rates\PYZus{}no\PYZus{}efw\PYZus{}no\PYZus{}cluster}\PY{p}{,}
\PY{c+c1}{\PYZsh{}     \PYZsq{}diff rates w/efw w/clusters\PYZsq{}: diff\PYZus{}rates\PYZus{}efw,}
\PY{c+c1}{\PYZsh{}     \PYZsq{}diff rates w/o efw w/clusters\PYZsq{}: diff\PYZus{}rates\PYZus{}no\PYZus{}efw,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{diff rates w/efw w/o clusters}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{diff\PYZus{}rates\PYZus{}efw\PYZus{}no\PYZus{}cluster}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{diff rates w/o efw w/o clusters}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{diff\PYZus{}rates\PYZus{}no\PYZus{}efw\PYZus{}no\PYZus{}cluster}
\PY{p}{\PYZcb{}}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{73}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} Plot DAGs for full dataframe}
\PY{n}{save\PYZus{}directory} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Plots}\PY{l+s+s2}{\PYZdq{}}


\PY{n}{plot\PYZus{}graph}\PY{p}{(}\PY{n}{dataframes\PYZus{}dict}\PY{p}{,} \PY{n}{figsize\PYZus{}dict}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{24}\PY{p}{,} \PY{l+m+mi}{20}\PY{p}{)}\PY{p}{,} \PY{n}{p\PYZus{}val}\PY{o}{=}\PY{l+m+mf}{0.01}\PY{p}{,} \PY{n}{overall\PYZus{}title}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{save\PYZus{}dir}\PY{o}{=}\PY{n}{save\PYZus{}directory}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    
    \begin{Verbatim}[commandchars=\\\{\}]
  0\%|          | 0/5 [00:00<?, ?it/s]
    \end{Verbatim}

    
    \begin{Verbatim}[commandchars=\\\{\}]
WARNING:pgmpy:PDAG has no faithful extension (= no oriented DAG with the same
v-structures as PDAG). Remaining undirected PDAG edges oriented arbitrarily.
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{filtered_results_files/filtered_results_30_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    
    \begin{Verbatim}[commandchars=\\\{\}]
  0\%|          | 0/4 [00:00<?, ?it/s]
    \end{Verbatim}

    
    \begin{Verbatim}[commandchars=\\\{\}]
INFO:pgmpy:Reached maximum number of allowed conditional variables. Exiting
WARNING:pgmpy:PDAG has no faithful extension (= no oriented DAG with the same
v-structures as PDAG). Remaining undirected PDAG edges oriented arbitrarily.
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{filtered_results_files/filtered_results_30_5.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    
    \begin{Verbatim}[commandchars=\\\{\}]
  0\%|          | 0/5 [00:00<?, ?it/s]
    \end{Verbatim}

    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{filtered_results_files/filtered_results_30_7.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    
    \begin{Verbatim}[commandchars=\\\{\}]
  0\%|          | 0/4 [00:00<?, ?it/s]
    \end{Verbatim}

    
    \begin{Verbatim}[commandchars=\\\{\}]
INFO:pgmpy:Reached maximum number of allowed conditional variables. Exiting
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{filtered_results_files/filtered_results_30_10.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{28}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} Save train and test data }
\PY{n}{train\PYZus{}data\PYZus{}rates\PYZus{}ols\PYZus{}efw}\PY{p}{,} \PY{n}{test\PYZus{}data\PYZus{}rates\PYZus{}ols\PYZus{}efw} \PY{o}{=} \PY{n}{get\PYZus{}best\PYZus{}fold\PYZus{}data\PYZus{}merged}\PY{p}{(}\PY{n}{best\PYZus{}rates\PYZus{}data\PYZus{}ols}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{const}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                                                              \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Agri}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                                                             \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mini}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                                                             \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Util}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                                                             \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{EFW}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                                                             \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                                                             \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M4I}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{n}{train\PYZus{}data\PYZus{}rates\PYZus{}ols\PYZus{}no\PYZus{}efw}\PY{p}{,} \PY{n}{test\PYZus{}data\PYZus{}rates\PYZus{}ols\PYZus{}no\PYZus{}efw} \PY{o}{=} \PY{n}{get\PYZus{}best\PYZus{}fold\PYZus{}data\PYZus{}merged}\PY{p}{(}\PY{n}{best\PYZus{}rates\PYZus{}data\PYZus{}ols}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{const}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                                                              \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Agri}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                                                             \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mini}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                                                             \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Util}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                                                             \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                                                             \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M4I}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{n}{train\PYZus{}data\PYZus{}rates\PYZus{}wls\PYZus{}efw}\PY{p}{,} \PY{n}{test\PYZus{}data\PYZus{}rates\PYZus{}wls\PYZus{}efw} \PY{o}{=} \PY{n}{get\PYZus{}best\PYZus{}fold\PYZus{}data\PYZus{}merged}\PY{p}{(}\PY{n}{best\PYZus{}rates\PYZus{}data\PYZus{}wls}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{const}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                                                              \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Agri}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                                                             \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mini}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                                                             \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Util}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                                                             \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{EFW}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                                                             \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                                                             \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M4I}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{n}{train\PYZus{}data\PYZus{}rates\PYZus{}wls\PYZus{}no\PYZus{}efw}\PY{p}{,} \PY{n}{test\PYZus{}data\PYZus{}rates\PYZus{}wls\PYZus{}no\PYZus{}efw} \PY{o}{=} \PY{n}{get\PYZus{}best\PYZus{}fold\PYZus{}data\PYZus{}merged}\PY{p}{(}\PY{n}{best\PYZus{}rates\PYZus{}data\PYZus{}wls}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{const}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                                                              \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Agri}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                                                             \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mini}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                                                             \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Util}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                                                             \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                                                             \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M4I}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{n}{train\PYZus{}data\PYZus{}diff\PYZus{}rates\PYZus{}ols\PYZus{}efw}\PY{p}{,} \PY{n}{test\PYZus{}data\PYZus{}diff\PYZus{}rates\PYZus{}ols\PYZus{}efw} \PY{o}{=} \PY{n}{get\PYZus{}best\PYZus{}fold\PYZus{}data\PYZus{}merged}\PY{p}{(}\PY{n}{best\PYZus{}diff\PYZus{}rates\PYZus{}ols}\PY{p}{,}
                                                                             \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Agri}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                                                             \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mini}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                                                             \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Util}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                                                             \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{EFW}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                                                             \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                                                             \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M4I}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{n}{train\PYZus{}data\PYZus{}diff\PYZus{}rates\PYZus{}ols\PYZus{}no\PYZus{}efw}\PY{p}{,} \PY{n}{test\PYZus{}data\PYZus{}diff\PYZus{}rates\PYZus{}ols\PYZus{}no\PYZus{}efw} \PY{o}{=} \PY{n}{get\PYZus{}best\PYZus{}fold\PYZus{}data\PYZus{}merged}\PY{p}{(}\PY{n}{best\PYZus{}diff\PYZus{}rates\PYZus{}ols}\PY{p}{,}
                                                                             \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Agri}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                                                             \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mini}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                                                             \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Util}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                                                             \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                                                             \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M4I}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{29}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{drop\PYZus{}cols} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{const}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}

\PY{n}{test\PYZus{}data\PYZus{}rates\PYZus{}ols\PYZus{}efw}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{n}{drop\PYZus{}cols}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\PY{n}{test\PYZus{}data\PYZus{}rates\PYZus{}ols\PYZus{}no\PYZus{}efw}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{n}{drop\PYZus{}cols}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\PY{n}{test\PYZus{}data\PYZus{}rates\PYZus{}wls\PYZus{}efw}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{n}{drop\PYZus{}cols}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\PY{n}{test\PYZus{}data\PYZus{}rates\PYZus{}wls\PYZus{}no\PYZus{}efw}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{n}{drop\PYZus{}cols}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}

\PY{n}{train\PYZus{}data\PYZus{}rates\PYZus{}ols\PYZus{}efw}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{n}{drop\PYZus{}cols}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\PY{n}{train\PYZus{}data\PYZus{}rates\PYZus{}ols\PYZus{}no\PYZus{}efw}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{n}{drop\PYZus{}cols}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\PY{n}{train\PYZus{}data\PYZus{}rates\PYZus{}wls\PYZus{}efw}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{n}{drop\PYZus{}cols}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\PY{n}{train\PYZus{}data\PYZus{}rates\PYZus{}wls\PYZus{}no\PYZus{}efw}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{n}{drop\PYZus{}cols}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{30}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{k\PYZus{}fold\PYZus{}test\PYZus{}data} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}

\PY{n}{k\PYZus{}fold\PYZus{}test\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k\PYZhy{}fold rates ols w/efw}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{test\PYZus{}data\PYZus{}rates\PYZus{}ols\PYZus{}efw}
\PY{n}{k\PYZus{}fold\PYZus{}test\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k\PYZhy{}fold rates ols w/o efw}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{test\PYZus{}data\PYZus{}rates\PYZus{}ols\PYZus{}no\PYZus{}efw}
\PY{n}{k\PYZus{}fold\PYZus{}test\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k\PYZhy{}fold rates wls w/efw}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{test\PYZus{}data\PYZus{}rates\PYZus{}wls\PYZus{}efw}
\PY{n}{k\PYZus{}fold\PYZus{}test\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k\PYZhy{}fold rates wls w/o efw}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{test\PYZus{}data\PYZus{}rates\PYZus{}wls\PYZus{}no\PYZus{}efw}
\PY{n}{k\PYZus{}fold\PYZus{}test\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k\PYZhy{}fold diff rates ols w/efw}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{test\PYZus{}data\PYZus{}diff\PYZus{}rates\PYZus{}ols\PYZus{}efw}
\PY{n}{k\PYZus{}fold\PYZus{}test\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k\PYZhy{}fold diff rates ols w/o efw}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{test\PYZus{}data\PYZus{}diff\PYZus{}rates\PYZus{}ols\PYZus{}no\PYZus{}efw}

\PY{n}{k\PYZus{}fold\PYZus{}train\PYZus{}data} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}

\PY{n}{k\PYZus{}fold\PYZus{}train\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k\PYZhy{}fold rates ols w/efw}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{train\PYZus{}data\PYZus{}rates\PYZus{}ols\PYZus{}efw}
\PY{n}{k\PYZus{}fold\PYZus{}train\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k\PYZhy{}fold rates ols w/o efw}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{train\PYZus{}data\PYZus{}rates\PYZus{}ols\PYZus{}no\PYZus{}efw}
\PY{n}{k\PYZus{}fold\PYZus{}train\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k\PYZhy{}fold rates wls w/efw}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{train\PYZus{}data\PYZus{}rates\PYZus{}wls\PYZus{}efw}
\PY{n}{k\PYZus{}fold\PYZus{}train\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k\PYZhy{}fold rates wls w/o efw}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{train\PYZus{}data\PYZus{}rates\PYZus{}wls\PYZus{}no\PYZus{}efw}
\PY{n}{k\PYZus{}fold\PYZus{}train\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k\PYZhy{}fold diff rates ols w/efw}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{train\PYZus{}data\PYZus{}diff\PYZus{}rates\PYZus{}ols\PYZus{}efw}
\PY{n}{k\PYZus{}fold\PYZus{}train\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k\PYZhy{}fold diff rates ols w/o efw}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{train\PYZus{}data\PYZus{}diff\PYZus{}rates\PYZus{}ols\PYZus{}no\PYZus{}efw}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{80}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} Plot DAGs for k\PYZhy{}fold data}
\PY{n}{save\PYZus{}directory} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Plots}\PY{l+s+s2}{\PYZdq{}}

\PY{n}{plot\PYZus{}graph}\PY{p}{(}\PY{n}{k\PYZus{}fold\PYZus{}train\PYZus{}data}\PY{p}{,} \PY{n}{figsize\PYZus{}dict}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{24}\PY{p}{,} \PY{l+m+mi}{20}\PY{p}{)}\PY{p}{,} \PY{n}{p\PYZus{}val}\PY{o}{=}\PY{l+m+mf}{0.01}\PY{p}{,} \PY{n}{overall\PYZus{}title}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{save\PYZus{}dir}\PY{o}{=}\PY{n}{save\PYZus{}directory}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    
    \begin{Verbatim}[commandchars=\\\{\}]
  0\%|          | 0/5 [00:00<?, ?it/s]
    \end{Verbatim}

    
    \begin{Verbatim}[commandchars=\\\{\}]
WARNING:pgmpy:PDAG has no faithful extension (= no oriented DAG with the same
v-structures as PDAG). Remaining undirected PDAG edges oriented arbitrarily.
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{filtered_results_files/filtered_results_34_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    
    \begin{Verbatim}[commandchars=\\\{\}]
  0\%|          | 0/4 [00:00<?, ?it/s]
    \end{Verbatim}

    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{filtered_results_files/filtered_results_34_4.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    
    \begin{Verbatim}[commandchars=\\\{\}]
  0\%|          | 0/5 [00:00<?, ?it/s]
    \end{Verbatim}

    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{filtered_results_files/filtered_results_34_6.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    
    \begin{Verbatim}[commandchars=\\\{\}]
  0\%|          | 0/4 [00:00<?, ?it/s]
    \end{Verbatim}

    
    \begin{Verbatim}[commandchars=\\\{\}]
WARNING:pgmpy:PDAG has no faithful extension (= no oriented DAG with the same
v-structures as PDAG). Remaining undirected PDAG edges oriented arbitrarily.
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{filtered_results_files/filtered_results_34_9.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    
    \begin{Verbatim}[commandchars=\\\{\}]
  0\%|          | 0/5 [00:00<?, ?it/s]
    \end{Verbatim}

    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{filtered_results_files/filtered_results_34_11.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    
    \begin{Verbatim}[commandchars=\\\{\}]
  0\%|          | 0/4 [00:00<?, ?it/s]
    \end{Verbatim}

    
    \begin{Verbatim}[commandchars=\\\{\}]
INFO:pgmpy:Reached maximum number of allowed conditional variables. Exiting
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{filtered_results_files/filtered_results_34_14.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{102}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{combined\PYZus{}summary} \PY{o}{=} \PY{n}{combined\PYZus{}summary}\PY{o}{.}\PY{n}{round}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{103}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} Convert DataFrame to HTML table}
\PY{n}{table\PYZus{}html} \PY{o}{=} \PY{n}{combined\PYZus{}summary}\PY{o}{.}\PY{n}{to\PYZus{}html}\PY{p}{(}\PY{n}{index}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,} \PY{n}{border}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{classes}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dataframe}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{justify}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{center}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{n}{display}\PY{p}{(}\PY{n}{HTML}\PY{p}{(}\PY{n}{table\PYZus{}html}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{8}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{from} \PY{n+nn}{IPython}\PY{n+nn}{.}\PY{n+nn}{core}\PY{n+nn}{.}\PY{n+nn}{display} \PY{k+kn}{import} \PY{n}{display}\PY{p}{,} \PY{n}{HTML}

\PY{n}{html\PYZus{}code} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}\PYZdq{}\PYZdq{}}
\PY{l+s+s2}{\PYZlt{}!DOCTYPE html\PYZgt{}}
\PY{l+s+s2}{\PYZlt{}html lang=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{en}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZgt{}}
\PY{l+s+s2}{\PYZlt{}head\PYZgt{}}
\PY{l+s+s2}{    \PYZlt{}meta charset=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{UTF\PYZhy{}8}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZgt{}}
\PY{l+s+s2}{    \PYZlt{}meta name=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{viewport}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ content=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{width=device\PYZhy{}width, initial\PYZhy{}scale=1.0}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZgt{}}
\PY{l+s+s2}{    \PYZlt{}title\PYZgt{}\PYZlt{}/title\PYZgt{}}
\PY{l+s+s2}{    \PYZlt{}style\PYZgt{}}
\PY{l+s+s2}{        body, html }\PY{l+s+s2}{\PYZob{}}
\PY{l+s+s2}{            margin: 0;}
\PY{l+s+s2}{            padding: 0;}
\PY{l+s+s2}{            height: 100}\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{;}
\PY{l+s+s2}{            width: 100}\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{;}
\PY{l+s+s2}{            font\PYZhy{}family: Arial, sans\PYZhy{}serif;}
\PY{l+s+s2}{            color: \PYZsh{}fff; /* Text color for contrast */}
\PY{l+s+s2}{        \PYZcb{}}

\PY{l+s+s2}{        .background }\PY{l+s+s2}{\PYZob{}}
\PY{l+s+s2}{            position: absolute;}
\PY{l+s+s2}{            top: 0;}
\PY{l+s+s2}{            left: 0;}
\PY{l+s+s2}{            width: 100}\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{;}
\PY{l+s+s2}{            height: 100}\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{;}
\PY{l+s+s2}{            z\PYZhy{}index: \PYZhy{}1;}
\PY{l+s+s2}{            background: url(}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{your\PYZhy{}image.jpg}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{) no\PYZhy{}repeat center center/cover;}
\PY{l+s+s2}{        \PYZcb{}}

\PY{l+s+s2}{        .content }\PY{l+s+s2}{\PYZob{}}
\PY{l+s+s2}{            position: relative;}
\PY{l+s+s2}{            padding: 20px;}
\PY{l+s+s2}{            max\PYZhy{}width: 800px;}
\PY{l+s+s2}{            margin: auto;}
\PY{l+s+s2}{            background: rgba(0, 0, 0, 0.5); /* Semi\PYZhy{}transparent background for readability */}
\PY{l+s+s2}{            border\PYZhy{}radius: 10px;}
\PY{l+s+s2}{            box\PYZhy{}shadow: 0 4px 8px rgba(0, 0, 0, 0.3);}
\PY{l+s+s2}{            overflow\PYZhy{}y: auto;}
\PY{l+s+s2}{            max\PYZhy{}height: 90}\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{; /* Ensures content doesn}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{t overflow screen height */}
\PY{l+s+s2}{        \PYZcb{}}

\PY{l+s+s2}{        h1 }\PY{l+s+s2}{\PYZob{}}
\PY{l+s+s2}{            font\PYZhy{}size: 2em;}
\PY{l+s+s2}{            margin\PYZhy{}bottom: 20px;}
\PY{l+s+s2}{        \PYZcb{}}

\PY{l+s+s2}{        h2 }\PY{l+s+s2}{\PYZob{}}
\PY{l+s+s2}{            font\PYZhy{}size: 1.5em; /* Adjust the font size */}
\PY{l+s+s2}{            margin\PYZhy{}top: 20px;}
\PY{l+s+s2}{            margin\PYZhy{}bottom: 15px;}
\PY{l+s+s2}{            /*color: \PYZsh{}FFD700;*/}
\PY{l+s+s2}{        \PYZcb{}}

\PY{l+s+s2}{        p }\PY{l+s+s2}{\PYZob{}}
\PY{l+s+s2}{            line\PYZhy{}height: 1.6;}
\PY{l+s+s2}{            margin\PYZhy{}bottom: 15px;}
\PY{l+s+s2}{        \PYZcb{}}

\PY{l+s+s2}{        .grid\PYZhy{}container }\PY{l+s+s2}{\PYZob{}\PYZob{}}
\PY{l+s+s2}{            display: grid;}
\PY{l+s+s2}{            grid\PYZhy{}template\PYZhy{}columns: auto auto;}
\PY{l+s+s2}{            gap: 10px;}
\PY{l+s+s2}{            padding: 10px;}
\PY{l+s+s2}{        \PYZcb{}\PYZcb{}}
\PY{l+s+s2}{        .grid\PYZhy{}item }\PY{l+s+s2}{\PYZob{}\PYZob{}}
\PY{l+s+s2}{            text\PYZhy{}align: center;}
\PY{l+s+s2}{            padding: 10px;}
\PY{l+s+s2}{            font\PYZhy{}size: 16px;}
\PY{l+s+s2}{        \PYZcb{}\PYZcb{}}
\PY{l+s+s2}{        img }\PY{l+s+s2}{\PYZob{}\PYZob{}}
\PY{l+s+s2}{            width: 100}\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{;}
\PY{l+s+s2}{            height: auto;}
\PY{l+s+s2}{        \PYZcb{}\PYZcb{}}

\PY{l+s+s2}{        /* Styles for figures and captions */}
\PY{l+s+s2}{        figure }\PY{l+s+s2}{\PYZob{}}
\PY{l+s+s2}{            text\PYZhy{}align: center;}
\PY{l+s+s2}{            margin: 20px 0;}
\PY{l+s+s2}{        \PYZcb{}}

\PY{l+s+s2}{        figcaption }\PY{l+s+s2}{\PYZob{}}
\PY{l+s+s2}{            font\PYZhy{}size: 1em;}
\PY{l+s+s2}{            margin\PYZhy{}top: 5px;}
\PY{l+s+s2}{            /*color: \PYZsh{}FFD700;*/}
\PY{l+s+s2}{        \PYZcb{}}

\PY{l+s+s2}{        /* Additional styles for tables */}
\PY{l+s+s2}{        table.dataframe }\PY{l+s+s2}{\PYZob{}}
\PY{l+s+s2}{            width: 130}\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{;}
\PY{l+s+s2}{            margin: 20px 0;}
\PY{l+s+s2}{            border\PYZhy{}collapse: collapse;}
\PY{l+s+s2}{        \PYZcb{}}

\PY{l+s+s2}{        table.dataframe th, table.dataframe td }\PY{l+s+s2}{\PYZob{}}
\PY{l+s+s2}{            padding: 10px;}
\PY{l+s+s2}{            text\PYZhy{}align: center;}
\PY{l+s+s2}{            border: 1px solid \PYZsh{}ddd;}
\PY{l+s+s2}{            background\PYZhy{}color: \PYZsh{}f4f4f4;}
\PY{l+s+s2}{        \PYZcb{}}

\PY{l+s+s2}{        table.dataframe caption }\PY{l+s+s2}{\PYZob{}}
\PY{l+s+s2}{            font\PYZhy{}size: 1em;}
\PY{l+s+s2}{            margin\PYZhy{}bottom: 5px;}
\PY{l+s+s2}{            color: \PYZsh{}000;}
\PY{l+s+s2}{        \PYZcb{}}
\PY{l+s+s2}{    \PYZlt{}/style\PYZgt{}}
\PY{l+s+s2}{\PYZlt{}/head\PYZgt{}}
\PY{l+s+s2}{\PYZlt{}body\PYZgt{}}
\PY{l+s+s2}{    \PYZlt{}div class=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{background}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZgt{}\PYZlt{}/div\PYZgt{}}
\PY{l+s+s2}{    \PYZlt{}div class=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{content}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZgt{}}
\PY{l+s+s2}{        \PYZlt{}h1\PYZgt{}Introduction and Literature\PYZlt{}/h1\PYZgt{}}

\PY{l+s+s2}{        \PYZlt{}h2\PYZgt{}Capital Theory\PYZlt{}/h2\PYZgt{}}
\PY{l+s+s2}{        \PYZlt{}p\PYZgt{}Capital theory is a vast topic in finance and there still seems to be the argument as to what capital means and what it should truly mean. Neoclassicals define capital as a physical quantity that is independent of prices (Robinson, 1970). Historically, the definition of capital has been often shifting from either financial or physical. It started as being financial, in that it meant the sum of all money equivalent of all assets minus the sum of the money equivalent of all liabilities at a particular date to the conduct of the operations of a specific business unit (Lewin and Cachanosky, 2019). After a while economists argued that capital could not be defined as being financial only, and that birthed the physical aspect of capital referred to as physical capital. This connotes the set of physical production goods (often referred to as capital goods). In recent times, capital theorists began to take a look at how time could have an effect on capital as a whole, thus, illustrating capital in terms of having three different but inseparable dimensions: value, quantity and time. What this means is that capital can be viewed as financial, physical and yet involving time in a particular business process. Various disciplines have various definitions for capital, for example, Bourdieu’s capital theory recognizes that capital does not necessarily need to be economic but also includes other factors such as social and cultural capital (Bourdieu, 1986). Lewin and Cachanosky (2019) indicate that capital can be understood as the money value of a firm which accounts for all assets and liabilities. Stating that “productive activities employ stocks of durable and nondurable productive resources over time to produce a flow of valuable products or services for use or for sale”. The value of capital is based on the production process over time and the value of its finished goods or services. Interestingly, developed nations in recent years are beginning to experience a rise in the importance of intangible capital (such as information technology) in production and a decline in the reliance on physical capital (Caggese and Perez\PYZhy{}Orive, 2022).\PYZlt{}/p\PYZgt{}}
\PY{l+s+s2}{        \PYZlt{}p\PYZgt{}Interest rates as well as foreign exchange rates play a vital role in transmitting distortions to the capital structure of economies. Low interest rates do not accommodate for intangible investments due to the nature of intangible capital financing eventually resulting in consequences for aggregate capital misallocation. (McKinnon, 2010; Cachanosky, 2014; Caggese and Perez\PYZhy{}Orive, 2022).\PYZlt{}p\PYZgt{}}
\PY{l+s+s2}{        \PYZlt{}p\PYZgt{}According to Caggese and Perez\PYZhy{}Orive (2022), the reaction of tangible and intangible firms to interest rate changes differ, in that increases in interest rates negatively affects investment of tangible firms. This is expected as conventional theories would rightly predict. However, the investment of intangible firms reacts positively to increases in interest rates.\PYZlt{}p\PYZgt{}}
\PY{l+s+s2}{        }
\PY{l+s+s2}{        \PYZlt{}h2\PYZgt{}Capital Structure\PYZlt{}/h2\PYZgt{}}
\PY{l+s+s2}{        \PYZlt{}p\PYZgt{}To explain the combination of security and financial sources used by a corporation, various hypotheses have surfaced. Following the foundational paper by Modigliani and Miller (1958), which raised the problem of the relationship between a firm}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{s choice of finance and its value, the financing choice of firms is, in fact, possibly the most investigated topic area in finance in recent decades. Although there isn}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{t a single, widely recognized explanation describing why companies choose between debt and equity, various theories have surfaced in the previous few decades. These theories have considered macroeconomic variables as well as firm level characteristics in particular.\PYZlt{}p\PYZgt{}}
\PY{l+s+s2}{        \PYZlt{}p\PYZgt{}Modigliani and Miller (1963) suggest that firms may prefer debt over equity due to tax advantages, potentially leading to high debt levels for profitable firms. However, Miller (1977) and others note the impact of personal taxation, and DeAngelo and Masulis (1980) argue that firms with other tax shields may not prioritize interest tax shields.\PYZlt{}p\PYZgt{}}
\PY{l+s+s2}{        \PYZlt{}p\PYZgt{}Myers and Majluf (1984) propose the pecking\PYZhy{}order theory, suggesting that firms, due to information asymmetry, prefer internal funding over external sources. Thus, profitable firms may use retained earnings for investments rather than debt. Rajan and Zingales (1995) find support for this theory, showing a negative correlation between leverage and profitability.\PYZlt{}p\PYZgt{}}
\PY{l+s+s2}{        \PYZlt{}p\PYZgt{}Rajan and Zingales (1995), following Bradley et al. (1984) and Titman and Wessels (1988), find a positive relationship between tangibility (ratio of fixed to total assets) and leverage. They suggest that firms with more collateral may find it easier to secure debt, aligning with the ideas of Scott (1977), Williamson (1988), and Harris and Raviv (1990) on reducing agency problems.\PYZlt{}p\PYZgt{}}
\PY{l+s+s2}{        }
\PY{l+s+s2}{        \PYZlt{}h2\PYZgt{}Demand Shocks\PYZlt{}/h2\PYZgt{}}
\PY{l+s+s2}{        \PYZlt{}p\PYZgt{}Demand shocks are typically caused by changes in consumer preferences, economic policies, or external factors such as changes in the global economy (Kilian, 2008). The most common example of a demand shock is a sudden change in consumer demand for a product or service (Kilian and Hicks, 2013; Leduc and Lui, 2016). This can lead to a decrease or increase in the level of production of the product, depending on whether the demand shock is positive or negative (Ball et al., 1995; Berument et al., 2010; Kiss et al., 2023). According to the conventional theory of growth and fluctuations, aggregate demand results in temporary deviations from a production trend that is solely influenced by supply forces (capital accumulation, labor force growth and technological progress). After a shock, the economy returns to its typical output path: In the words of the empirical research on growth and economic fluctuations, GDP is }\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{trend steady}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{. In the literature on real business cycles, deviations from trend can be long\PYZhy{}lasting, but this is typically read as indicating that supply\PYZhy{}side variables, such as technological shocks, dominate fluctuations in the economy (Kilian and Park, 2009). The topic of whether aggregate demand shocks have long\PYZhy{}lasting, irreversible consequences on output and living standards thus appears to be answered negatively by orthodox economic theory, with few exceptions (Bachmann, et al., 2013; Dutt and Ros, 2003; Dutt and Ros, 2007). Economic growth may be permanently impacted by aggregate demand. As a result of rising returns, hysteresis impacts in labor markets, and balance of payments limitations, it is demonstrated that even if the economy converges to some }\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{normal}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ route, this course could still be changed by significant demand shocks. It is also demonstrated that the economy might not follow its }\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{normal}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ trend, in which case fiscal and monetary policy will affect output and growth over the long run (Dutt and Ros, 2007; Kilian, 2009).\PYZlt{}p\PYZgt{}}
\PY{l+s+s2}{        }
\PY{l+s+s2}{        \PYZlt{}h2\PYZgt{}Supply Shocks\PYZlt{}/h2\PYZgt{}}
\PY{l+s+s2}{        \PYZlt{}p\PYZgt{}Changes in the availability or price of a crucial input in the production process are frequently what trigger supply shocks (Reifschneider et al., 2015). They are unexpected events that cause a sudden change in the availability of a key input or resource in the production process, leading to changes in the overall cost structure of firms (Ecstein and Sinai, 1986). These shocks can have a significant impact on the economy, with implications for production, employment, and inflation.\PYZlt{}p\PYZgt{}}
\PY{l+s+s2}{        \PYZlt{}p\PYZgt{}Raw material, energy, or labor price increases are the most typical types of supply shocks (Blinder et al., 2013; Bruno and Sachs, 1982). When businesses are unable to generate as much output as before, a sudden increase in the price of an input might result in a drop in the supply of the product being produced (Eckstein and Sinai, 1986; Fisher et al., 1994).\PYZlt{}p\PYZgt{}}
\PY{l+s+s2}{        \PYZlt{}p\PYZgt{}The relationship between supply shocks and pricing in the production structure has been the subject of numerous researches. For instance, a study by Blanchard and Fischer (1989) contends that positive supply shocks can boost a firm}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{s production capacity, resulting in higher output and reduced inflation. These shocks include drops in the price of oil or advances in technology. On the other hand, negative supply shocks, such as abrupt rise in oil costs or a natural disaster, can cause output to fall and prices to rise. The impact of shocks in supply\PYZhy{}side policies, such as tax incentives and deregulation, on productivity and efficiency can have long\PYZhy{}term effects on production structure by influencing investment decisions, technology adoption, and competition (Jorgenson, 1991).\PYZlt{}p\PYZgt{}}
\PY{l+s+s2}{        }
\PY{l+s+s2}{        \PYZlt{}h2\PYZgt{}Models of Demand and Supply shocks on production structure\PYZlt{}/h2\PYZgt{}}
\PY{l+s+s2}{        \PYZlt{}p\PYZgt{}One of the most prominent theories on the impact of supply and demand shocks on production structure is the Input\PYZhy{}Output (IO) framework (Gilmartin et al., 2008; West, 1995), which is based on the idea that different sectors of the economy are interconnected through their use of intermediate inputs. The IO framework can be used to analyze the impact of supply and demand shocks on the production structure by tracing the flow of inputs and outputs through different sectors of the economy (Li et al., 2018). IO model was used to study the impact of Chinese import competition on US manufacturing and the study found that Chinese imports led to a decline in demand for US\PYZhy{}manufactured goods, which in turn led to a decline in the number of firms and workers in the sector (Acemoglu et al., 2016; Autor et al., 2013).\PYZlt{}p\PYZgt{}}
\PY{l+s+s2}{        \PYZlt{}p\PYZgt{}Another approach to studying the impact of supply and demand shocks on the production structure is through the use of computable general equilibrium (CGE) models. These models are used to analyze the impact of changes in supply and demand on the economy as a whole, by considering the interactions between different sectors and households (Blake et al., 2001; Diao and Thurlow, 2012; Doroodian and Boyd, 2003; Seung and Water, 2010). One study on macroeconomic and distributional consequences of energy shocks utilized this model and showed that oil supply shocks are costly and result in a decline in real GDP, higher average prices and increase balance of payment deficits (Adenikinju and Falobi, 2006).\PYZlt{}p\PYZgt{}}
\PY{l+s+s2}{        \PYZlt{}p\PYZgt{}More generally, supply and demand shocks can have significant impacts on the production structure, with the magnitude and direction of the impact depending on a range of factors, including the initial structure of the economy, the nature of the shock, and the policy response. While different models have accessed the impacts and possible directions of demand and supply shocks, there is little to no research using a directed acyclic graph to model the impact of demand and supply shocks on a production structure.\PYZlt{}p\PYZgt{}}
\PY{l+s+s2}{        }
\PY{l+s+s2}{        \PYZlt{}h2\PYZgt{}Money Supply\PYZlt{}/h2\PYZgt{}}
\PY{l+s+s2}{        \PYZlt{}p\PYZgt{}The importance of monetary policy measures as a means to increase firms}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{ access to debt funding has been underlined by the recent Global Financial Crisis. In the midst of the crisis, central banks in most advanced economies have carefully examined the possibility of buying public and private debt to increase credit and money supply (Epstein1, 2007; El\PYZhy{}Erian, 2017; Julio et al., 2020).\PYZlt{}p\PYZgt{}}
\PY{l+s+s2}{        \PYZlt{}p\PYZgt{}Corporate capital structure is likely to depend on decisions made by monetary authorities given the role of monetary policy in achieving financial stability (Ashcraft et al., 2011; Stein, 2012) and the idea that a more stable environment should support company operations. To the degree that borrowing restrictions affect business cycles and collateral values, it is widely recognized that monetary policy can impact bank lending and real activity (Lacoviello, 2005; Gilchrist and Zakrajsek, 2011; Stein, 2012).\PYZlt{}p\PYZgt{}}
\PY{l+s+s2}{        \PYZlt{}p\PYZgt{}According to Pindado et al., (2020), there exists a nonlinear relation between money growth and corporate debt stating that the relation exhibits an inverted U\PYZhy{}shape. An increase in the money supply facilitates firms’ indebtedness because of the higher liquidity in the market (Holmstrom and Tirole, 1998; Schnabl, 2012; Dewally and Shao, 2014; Pindado et al., 2020). However, there is an optimal level beyond which additional growth of the monetary aggregate has the opposite effect. From this level onwards, further expansionary measures discourage firms from borrowing because of the risk of inflation, which would in turn lead to increases in interest rates, making debt more expensive (White, 2009; Bordo and Landon\PYZhy{}Lane, 2013; Pindado et al., 2020). Nevertheless, the characteristics of the banking system influence the intensity of the effect of money supply on firm debt and determine the level of growth of the monetary aggregate that is necessary to maximize firms’ access to debt financing (Becker and Ivashina, 2014). If there is higher liquidity in the hands of banks, the impact of expansionary measures on debt is mitigated and the inflection point at which the relation between both factors turns from positive to negative is reached at a higher level (Eichengreen, 2004; White, 2009). By contrast, in countries where banks allocate a higher fraction of their resources to private credit, the effect of the monetary aggregate on debt is more pronounced, reducing the amount of money supply that is necessary to maximize corporate leverage (Bolton and Freixas, 2006; Kashyap et al., 2008; Crouzet, 2018).\PYZlt{}p\PYZgt{}}
\PY{l+s+s2}{        \PYZlt{}p\PYZgt{}According to Chung and Ariff (2016) and Urbanovský (2016), there is not yet a consensus in empirical research supporting Friedman}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{s proposition that }\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{increases in money supply should lead to liquidity surges and credit expansion.}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ Friedman (1968) argued that a gradual increase in the money supply is essential for a healthy economy as it stimulates economic growth. Therefore, since various sector of an economy’s growth is often indicative of aggregate economic growth, it is possible that the money supply directly influences these sectors or acts as a moderator for the impact of microeconomic variables on the global market (Otambo, 2016; Egbunike and Okerekeoti, 2018). Additionally, Singh, Mehta, and Varsha (2011) suggested that including macroeconomic variables in investment decision\PYZhy{}making could enhance investors}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{ ability to develop profitable investment strategies thus, creating a growth in the economy.\PYZlt{}p\PYZgt{}}
\PY{l+s+s2}{        \PYZlt{}p\PYZgt{}In recent years, researchers have increasingly focused on how the external macroeconomic environment influences a firms}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{ capital structure (Bokpin, 2009; Kumar et al., 2017; Dong, 2023). Korajczyk and Levy (2003) investigated this relationship and discovered that firms without financing constraints tend to prefer equity financing during economic expansions, whereas they favor debt financing during contractions. Conversely, firms facing financing constraints exhibit the opposite pattern. This highlights the significant impact of the macroeconomy on firms}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{ capital structure. Hackbarth et al., (2006) further emphasized the importance of capital supply shocks, whether from the credit or capital markets, in shaping firms}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{ capital structure. Kashyap et al., (1993) observed that tight monetary policy leads to changes in firms}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{ external financing behavior, resulting in a significant decrease in the amount of bank loans obtained by firms. The influence of macroeconomic conditions on capital structure exhibits distinct patterns: firms without financing constraints demonstrate counter\PYZhy{}cyclical changes in their target leverage, whereas constrained firms show cyclical changes (Leary, 2009).\PYZlt{}p\PYZgt{}}
\PY{l+s+s2}{        \PYZlt{}p\PYZgt{}There is little empirical data examining the impact of money supply and demand shocks on firms’ capital structure. The majority of research considers macroeconomic factors as relatively stable external conditions influencing corporate financing decisions. These studies either aim to manage macroeconomic disturbances or seek to explain variations in capital structure from a microeconomic perspective. For instance, Dongwei and Haihua (2009) analyzed China}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{s capital structure using macroeconomic factors and discovered an inverse relationship between China}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{s capital structure and economic cycles. A more recent study carried out by Dong (2023) which examined the correlation between money supply and corporate capital structure through the lens of financial constraints discovered that there is a significant and positive relationship between money supply and corporate capital structure when financing constraints are not considered. Dong also found that the impact of money supply on capital structure differs among firms with varying degrees of financing constraints, with firms facing higher financial constraints experiencing a significantly stronger effect compared to those with lower constraints. However, there still remains a gap in the literature regarding the effects of a demand and/or supply shock of money supply to the capital structure of a firm.\PYZlt{}p\PYZgt{}}
\PY{l+s+s2}{        }
\PY{l+s+s2}{        \PYZlt{}h2\PYZgt{}Research Hypothesis\PYZlt{}/h2\PYZgt{}}
\PY{l+s+s2}{        \PYZlt{}p\PYZgt{}\PYZdl{}H\PYZus{}1\PYZdl{} : There is a positive correlation between money supply and production economy\PYZlt{}p\PYZgt{}}
\PY{l+s+s2}{        \PYZlt{}p\PYZgt{}\PYZdl{}H\PYZus{}2\PYZdl{} : An increase in interest rates results in a decrease in the production\PYZlt{}p\PYZgt{}}
\PY{l+s+s2}{        \PYZlt{}p\PYZgt{}\PYZdl{}H\PYZus{}3\PYZdl{} : Increase in money supply results in decrease in unemployment rates\PYZlt{}p\PYZgt{}}
\PY{l+s+s2}{        \PYZlt{}p\PYZgt{}\PYZdl{}H\PYZus{}4\PYZdl{} : There exists a positive correlation between interest rates and unemployment rates\PYZlt{}p\PYZgt{}}
\PY{l+s+s2}{        \PYZlt{}p\PYZgt{}\PYZdl{}H\PYZus{}5\PYZdl{} : The higher the economic freedom, the lower the unemployment rates and the higher the nominal GDP\PYZlt{}p\PYZgt{}}

\PY{l+s+s2}{        \PYZlt{}h1\PYZgt{}Data and Methodology\PYZlt{}/h1\PYZgt{}}
\PY{l+s+s2}{        \PYZlt{}h2\PYZgt{}Data\PYZlt{}/h2\PYZgt{}}
\PY{l+s+s2}{        \PYZlt{}p\PYZgt{}This research consists of a panel time series data ranging from 2001 to 2020 for counties in the US. The sample data comes from the Bureau of Economic Analysis database while the money supply data is sourced from the center for financial stability database. In order to satisfy the requirements of panel data analysis, counties with incomplete data were excluded.\PYZlt{}p\PYZgt{}}
\PY{l+s+s2}{        }
\PY{l+s+s2}{        \PYZlt{}h2\PYZgt{}Methodology\PYZlt{}/h2\PYZgt{}}
\PY{l+s+s2}{        \PYZlt{}p\PYZgt{}According to literature, it can be observed that the capital structure of an entity is influenced by macroeconomic variables. Therefore, we first examine the correlations between the structure of an economy and money supply. We also include another macro variable (unemployment rates) to examine its impact on the shocks to money supply and whether there is a direct effect on capital structure or an indirect effect, or perhaps to effect at all. In order to test the impact of shocks to the macroeconomic variables on the economic growth of a firm, we employed the use of directed acyclic graphs (DAGs), which would give us the directions of effect and their respective correlations.\PYZlt{}p\PYZgt{}}
\PY{l+s+s2}{        \PYZlt{}p\PYZgt{}Directed acyclic graphs (DAGs) serve as visual depictions illustrating causal relationships within a set of variables, devoid of cycles. Originating from the realms of artificial intelligence and computer science, these graphical models elucidate the causal flows between and among variables (Pearl, 2000). DAGs offer a distinct method from Granger causality tests, focusing on asymmetries in causal interactions that are not based on the time sequence, unlike the Granger test which relies on such temporal asymmetries. While relatively novel in economic analysis, there is an increasing body of precedent supporting the utilization of DAGs in this field. (Examples include, Wang and Bessler, 2006; Li et al., 2013; Imbens, 2020; Miljkovic and Goetz, 2020; Barrera and Miljkovic, 2022). A simple definition of a DAG is a graphical representation of a comprising directed edges (or arrows) that connect nodes (or variables) and delineate their paths. In a DAG, nodes (variables) like A, B, and C are connected by edges, showing causal relationships. Paths in a DAG are sequences of connected nodes. Directed paths follow the arrows, while undirected paths do not. Kinship terms describe relationships along a path. For example, in a directed path from A to C, A is C}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{s ancestor and C is A}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{s descendant. In a path like A→B→C, A is a direct cause of B, and B is a result of A and the cause of C. Nodes on directed paths, like B in A→B→C, are intermediary variables. They lie on the causal path between the start and end nodes, in this example A and C respectively.\PYZlt{}p\PYZgt{}}
\PY{l+s+s2}{        \PYZlt{}p\PYZgt{}DAGs employ computer\PYZhy{}programmed algorithms to visually represent causal relationships derived from observational data (Lauritzen and Richardson, 2002). Mathematically, these graphs depict conditional independence, as demonstrated by the recursive product decomposition (Miljkovic et al., 2016):\PYZlt{}p\PYZgt{}}
\PY{l+s+s2}{        \PYZlt{}p\PYZgt{}\PYZdl{}Pr⁡(ν\PYZus{}1,ν\PYZus{}2,……,ν\PYZus{}n )= ∏\PYZus{}}\PY{l+s+s2}{\PYZob{}}\PY{l+s+s2}{i=1\PYZcb{}\PYZca{}}\PY{l+s+si}{\PYZob{}n\PYZcb{}}\PY{l+s+s2}{Pr(ν\PYZus{}i|pπ\PYZus{}i)\PYZdl{}\PYZlt{}p\PYZgt{}}
\PY{l+s+s2}{        \PYZlt{}p\PYZgt{}where Pr represents the probability of variables (\PYZdl{}ν\PYZus{}1,ν\PYZus{}2,……,ν\PYZus{}n\PYZdl{}), the symbol П represents the product operator and π\PYZus{}i is the realization of some subset of variables that have causal effect on \PYZdl{}ν\PYZus{}i\PYZdl{} with i = 1,2,…,n.\PYZlt{}p\PYZgt{}}
\PY{l+s+s2}{        \PYZlt{}p\PYZgt{}Pearl (2000) introduced D\PYZhy{}separation as a method to visually represent independencies and causes. It determines if one set of variables (A) is independent of another set (B), given a third set (C), within a specific causal network. D\PYZhy{}separation associates }\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dependency}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ with }\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{connectedness}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ and }\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{independence}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ with }\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{unconnectedness}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ or }\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{separation.}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ This approach graphically represents conditional independence, allowing us to identify these relations within a directed acyclic graph. By constructing such a graph where variables (\PYZdl{}pπ\PYZus{}i\PYZdl{}) are represented as direct causes (\PYZdl{}ν\PYZus{}i\PYZdl{}), we can interpret the independencies indicated by the equation using D\PYZhy{}separation (Pearl, 2000).\PYZlt{}p\PYZgt{}}
\PY{l+s+s2}{        \PYZlt{}p\PYZgt{}This research focuses on the original PC algorithm. In the original PC\PYZhy{}algorithm, the partial correlation between two variables X and Y is computed while controlling for all other variables in the regression. This is done by regressing one error term on the other, without a constant term, across all possible combinations of the remaining variables. The highest p\PYZhy{}value from these regressions indicates the statistical significance of the causal link between X and Y. If the partial correlation is not statistically significant, it suggests that the link between X and Y should be eliminated (Caton and Gupta, 2021).\PYZlt{}p\PYZgt{}}
\PY{l+s+s2}{        \PYZlt{}p\PYZgt{}We further explored a machine learning technique to partition the counties based on similar characteristics, and create the graphs to test the effects. We explored the kml3d clustering, which is used for clustering longitudinal data types. We identify four sectors of the economy as a proxy for the structure of these entities (counties), and they include; (1) Agriculture, forestry, fishing and hunting; (2) Mining, quarrying, and oil and gas extraction, and (3) Utilities. The summary statistics is shown in Table 1.\PYZlt{}p\PYZgt{}}

\PY{l+s+s2}{        \PYZlt{}div\PYZgt{}}
\PY{l+s+s2}{            \PYZlt{}!\PYZhy{}\PYZhy{} Embedded HTML table \PYZhy{}\PYZhy{}\PYZgt{}}
\PY{l+s+s2}{            \PYZlt{}table class=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dataframe dataframe}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZgt{}}
\PY{l+s+s2}{                \PYZlt{}caption\PYZgt{}Table 1. Summary statistics\PYZlt{}/caption\PYZgt{}}
\PY{l+s+s2}{                \PYZlt{}thead\PYZgt{}}
\PY{l+s+s2}{            \PYZlt{}table class=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dataframe dataframe}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{  \PYZlt{}thead\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{    \PYZlt{}tr style=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{text\PYZhy{}align: center;}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}th\PYZgt{}\PYZlt{}/th\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}th\PYZgt{}\PYZlt{}/th\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}th\PYZgt{}Agri\PYZlt{}/th\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}th\PYZgt{}Mini\PYZlt{}/th\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}th\PYZgt{}Util\PYZlt{}/th\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}th\PYZgt{}M4\PYZlt{}/th\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}th\PYZgt{}M4I\PYZlt{}/th\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}th\PYZgt{}unem\PYZlt{}/th\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}th\PYZgt{}EFW\PYZlt{}/th\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}th\PYZgt{}clusters\PYZus{}2.0\PYZlt{}/th\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}th\PYZgt{}clusters\PYZus{}3.0\PYZlt{}/th\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}th\PYZgt{}clusters\PYZus{}4.0\PYZlt{}/th\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{    \PYZlt{}/tr\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{    \PYZlt{}tr\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}th\PYZgt{}Type\PYZlt{}/th\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}th\PYZgt{}\PYZlt{}/th\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}th\PYZgt{}\PYZlt{}/th\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}th\PYZgt{}\PYZlt{}/th\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}th\PYZgt{}\PYZlt{}/th\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}th\PYZgt{}\PYZlt{}/th\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}th\PYZgt{}\PYZlt{}/th\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}th\PYZgt{}\PYZlt{}/th\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}th\PYZgt{}\PYZlt{}/th\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}th\PYZgt{}\PYZlt{}/th\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}th\PYZgt{}\PYZlt{}/th\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}th\PYZgt{}\PYZlt{}/th\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{    \PYZlt{}/tr\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{  \PYZlt{}/thead\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{  \PYZlt{}tbody\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{    \PYZlt{}tr\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}th rowspan=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{4}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ valign=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{top}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZgt{}Differenced Rates\PYZlt{}/th\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}th\PYZgt{}max\PYZlt{}/th\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}td\PYZgt{}8.80\PYZlt{}/td\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}td\PYZgt{}10.44\PYZlt{}/td\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}td\PYZgt{}9.86\PYZlt{}/td\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}td\PYZgt{}0.16\PYZlt{}/td\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}td\PYZgt{}0.01\PYZlt{}/td\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}td\PYZgt{}11.38\PYZlt{}/td\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}td\PYZgt{}0.19\PYZlt{}/td\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}td\PYZgt{}1.00\PYZlt{}/td\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}td\PYZgt{}1.00\PYZlt{}/td\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}td\PYZgt{}1.00\PYZlt{}/td\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{    \PYZlt{}/tr\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{    \PYZlt{}tr\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}th\PYZgt{}mean\PYZlt{}/th\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}td\PYZgt{}0.01\PYZlt{}/td\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}td\PYZgt{}\PYZhy{}0.02\PYZlt{}/td\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}td\PYZgt{}\PYZhy{}0.01\PYZlt{}/td\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}td\PYZgt{}0.00\PYZlt{}/td\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}td\PYZgt{}\PYZhy{}0.00\PYZlt{}/td\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}td\PYZgt{}0.05\PYZlt{}/td\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}td\PYZgt{}\PYZhy{}0.02\PYZlt{}/td\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}td\PYZgt{}0.37\PYZlt{}/td\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}td\PYZgt{}0.18\PYZlt{}/td\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}td\PYZgt{}0.09\PYZlt{}/td\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{    \PYZlt{}/tr\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{    \PYZlt{}tr\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}th\PYZgt{}min\PYZlt{}/th\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}td\PYZgt{}\PYZhy{}7.49\PYZlt{}/td\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}td\PYZgt{}\PYZhy{}7.20\PYZlt{}/td\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}td\PYZgt{}\PYZhy{}10.96\PYZlt{}/td\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}td\PYZgt{}\PYZhy{}0.11\PYZlt{}/td\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}td\PYZgt{}\PYZhy{}0.02\PYZlt{}/td\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}td\PYZgt{}\PYZhy{}8.57\PYZlt{}/td\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}td\PYZgt{}\PYZhy{}0.38\PYZlt{}/td\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}td\PYZgt{}0.00\PYZlt{}/td\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}td\PYZgt{}0.00\PYZlt{}/td\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}td\PYZgt{}0.00\PYZlt{}/td\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{    \PYZlt{}/tr\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{    \PYZlt{}tr\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}th\PYZgt{}std\PYZlt{}/th\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}td\PYZgt{}1.20\PYZlt{}/td\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}td\PYZgt{}0.65\PYZlt{}/td\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}td\PYZgt{}0.55\PYZlt{}/td\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}td\PYZgt{}0.05\PYZlt{}/td\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}td\PYZgt{}0.01\PYZlt{}/td\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}td\PYZgt{}1.42\PYZlt{}/td\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}td\PYZgt{}0.10\PYZlt{}/td\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}td\PYZgt{}0.48\PYZlt{}/td\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}td\PYZgt{}0.39\PYZlt{}/td\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}td\PYZgt{}0.29\PYZlt{}/td\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{    \PYZlt{}/tr\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{    \PYZlt{}tr\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}th rowspan=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{4}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ valign=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{top}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZgt{}Rates\PYZlt{}/th\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}th\PYZgt{}max\PYZlt{}/th\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}td\PYZgt{}4.48\PYZlt{}/td\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}td\PYZgt{}6.76\PYZlt{}/td\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}td\PYZgt{}9.33\PYZlt{}/td\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}td\PYZgt{}0.21\PYZlt{}/td\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}td\PYZgt{}0.03\PYZlt{}/td\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}td\PYZgt{}29.39\PYZlt{}/td\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}td\PYZgt{}8.61\PYZlt{}/td\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}td\PYZgt{}1.00\PYZlt{}/td\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}td\PYZgt{}1.00\PYZlt{}/td\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}td\PYZgt{}1.00\PYZlt{}/td\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{    \PYZlt{}/tr\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{    \PYZlt{}tr\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}th\PYZgt{}mean\PYZlt{}/th\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}td\PYZgt{}0.02\PYZlt{}/td\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}td\PYZgt{}\PYZhy{}0.01\PYZlt{}/td\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}td\PYZgt{}0.04\PYZlt{}/td\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}td\PYZgt{}0.05\PYZlt{}/td\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}td\PYZgt{}0.01\PYZlt{}/td\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}td\PYZgt{}6.13\PYZlt{}/td\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}td\PYZgt{}8.11\PYZlt{}/td\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}td\PYZgt{}0.37\PYZlt{}/td\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}td\PYZgt{}0.15\PYZlt{}/td\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}td\PYZgt{}0.10\PYZlt{}/td\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{    \PYZlt{}/tr\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{    \PYZlt{}tr\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}th\PYZgt{}min\PYZlt{}/th\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}td\PYZgt{}\PYZhy{}4.38\PYZlt{}/td\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}td\PYZgt{}\PYZhy{}6.10\PYZlt{}/td\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}td\PYZgt{}\PYZhy{}6.40\PYZlt{}/td\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}td\PYZgt{}\PYZhy{}0.05\PYZlt{}/td\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}td\PYZgt{}0.00\PYZlt{}/td\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}td\PYZgt{}1.07\PYZlt{}/td\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}td\PYZgt{}7.63\PYZlt{}/td\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}td\PYZgt{}0.00\PYZlt{}/td\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}td\PYZgt{}0.00\PYZlt{}/td\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}td\PYZgt{}0.00\PYZlt{}/td\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{    \PYZlt{}/tr\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{    \PYZlt{}tr\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}th\PYZgt{}std\PYZlt{}/th\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}td\PYZgt{}0.74\PYZlt{}/td\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}td\PYZgt{}0.48\PYZlt{}/td\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}td\PYZgt{}0.40\PYZlt{}/td\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}td\PYZgt{}0.05\PYZlt{}/td\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}td\PYZgt{}0.01\PYZlt{}/td\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}td\PYZgt{}2.64\PYZlt{}/td\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}td\PYZgt{}0.17\PYZlt{}/td\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}td\PYZgt{}0.48\PYZlt{}/td\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}td\PYZgt{}0.36\PYZlt{}/td\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{      \PYZlt{}td\PYZgt{}0.30\PYZlt{}/td\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{    \PYZlt{}/tr\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{  \PYZlt{}/tbody\PYZgt{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZlt{}/table\PYZgt{}}
\PY{l+s+s2}{        \PYZlt{}/div\PYZgt{}}


\PY{l+s+s2}{        \PYZlt{}h1\PYZgt{}Results\PYZlt{}/h1\PYZgt{}}
\PY{l+s+s2}{        \PYZlt{}p\PYZgt{}This section presents the findings from the analysis of aggregate demand and supply shocks within a capital/production structure. Our objective is to find a consistent set of results from all possible analysis to explain the influence of economic variables in a production structure. To achieve this, we take different approaches, based on the structure of our data and test several hypotheses.\PYZlt{}p\PYZgt{}}
\PY{l+s+s2}{        \PYZlt{}p\PYZgt{}First, we perform an initial causal inference using Directed Acyclic Graphs (DAGs) on our data structure. This involved the use of nominal rates (of our data) for the entire data. We then explored the clustering of the data using the machine learning approach called KML3D. This is a k\PYZhy{}means clustering approach on panel data. We use this method to test for the effect of county clustering on production structure. Next, we use k\PYZhy{}fold regression methods on the data to check for robustness of results as well as the full regressions. The data specified by the k\PYZhy{}fold was also potted using DAGs for robustness.\PYZlt{}p\PYZgt{}}
\PY{l+s+s2}{        \PYZlt{}p\PYZgt{}The Directed Acyclic Graphs (DAGs) were used to identify relationships between variables. The figure above represents the DAGs obtained from the full set of data, split in two, rates and differenced rates. Rates represents the log differenced transformed data, while differenced rates represent the twice differenced data. These datasets are used for the entirety of the study.\PYZlt{}p\PYZgt{}}
\PY{l+s+s2}{        \PYZlt{}p\PYZgt{}The DAGs for each category (rates and differenced rates) are divided into two portions, the scenario where economic freedom index (EFW) is included and where it is excluded.\PYZlt{}p\PYZgt{}}
\PY{l+s+s2}{        }
\PY{l+s+s2}{        \PYZlt{}!\PYZhy{}\PYZhy{} Image Grid \PYZhy{}\PYZhy{}\PYZgt{}}
\PY{l+s+s2}{        \PYZlt{}div class=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{image\PYZhy{}grid}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZgt{}}
\PY{l+s+s2}{            \PYZlt{}img src=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{plots/rates\PYZus{}w\PYZus{}efw\PYZus{}w\PYZus{}o\PYZus{}clusters.png}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ alt=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Rates with EFW}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZgt{}}
\PY{l+s+s2}{            \PYZlt{}img src=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{plots/rates\PYZus{}w\PYZus{}o\PYZus{}efw\PYZus{}w\PYZus{}o\PYZus{}clusters.png}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ alt=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Rates without EFW}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZgt{}}
\PY{l+s+s2}{            \PYZlt{}img src=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{plots/diff\PYZus{}rates\PYZus{}w\PYZus{}efw\PYZus{}w\PYZus{}o\PYZus{}clusters.png}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ alt=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Diff rates with EFW}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZgt{}}
\PY{l+s+s2}{            \PYZlt{}img src=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{plots/diff\PYZus{}rates\PYZus{}w\PYZus{}o\PYZus{}efw\PYZus{}w\PYZus{}o\PYZus{}clusters.png}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ alt=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Diff rates without EFW}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZgt{}}

\PY{l+s+s2}{        \PYZlt{}/div\PYZgt{}}
\PY{l+s+s2}{        \PYZlt{}figcaption\PYZgt{}Fig 1. Full DAGs for rates and Diff rates\PYZlt{}/figcaption\PYZgt{}}
\PY{l+s+s2}{        }
\PY{l+s+s2}{        }
\PY{l+s+s2}{        \PYZlt{}p\PYZgt{}In the above Figure 1, the top left and right represent results from using rates. There is a significant negative relationship between M4 (money supply) and unemployment rates with a correlation of (\PYZhy{}0.36), suggesting that an increase in M4 is associated with a reduction in unemployment, hence supporting the third hypothesis (H3). EFW shows a positive correlation with M4I (interest rates), indicating that higher economic freedom influences monetary policy in an economy. When EFW is excluded from the model, there appears to be a direct negative influence of M4 on unemployment rates (\PYZhy{}0.36) and a negative correlation between mining and unemployment (\PYZhy{}0.05). This highlights the strong role of monetary variables in influencing unemployment rates and production sectors.\PYZlt{}p\PYZgt{}}
\PY{l+s+s2}{        \PYZlt{}p\PYZgt{}On the other hand, the bottom left and right represent results obtained from the differenced rates. The inclusion of EFW shows that there is a significant negative path from M4 to unemployment (\PYZhy{}0.26) and from EFW to unemployment (\PYZhy{}0.47). The positive relationship between M4 and EFW (0.5) underscores the role of economic freedom in monetary policy effects, hence, supporting H5. The scenario where EFW is excluded from the model shows that there exists a strong negative impact of M4 on unemployment (\PYZhy{}0.48) and a positive impact of M4I on production sectors.\PYZlt{}p\PYZgt{}}

\PY{l+s+s2}{        }
\PY{l+s+s2}{        \PYZlt{}!\PYZhy{}\PYZhy{} Image Grid \PYZhy{}\PYZhy{}\PYZgt{}}
\PY{l+s+s2}{        \PYZlt{}div class=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{image\PYZhy{}grid}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZgt{}}
\PY{l+s+s2}{            \PYZlt{}img src=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{plots/k\PYZhy{}fold\PYZus{}rates\PYZus{}ols\PYZus{}w\PYZus{}efw.png}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ alt=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{K\PYZhy{}fold Rates with EFW}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZgt{}}
\PY{l+s+s2}{            \PYZlt{}img src=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{plots/k\PYZhy{}fold\PYZus{}rates\PYZus{}ols\PYZus{}w\PYZus{}o\PYZus{}efw.png}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ alt=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{K\PYZhy{}fold Rates without EFW}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZgt{}}
\PY{l+s+s2}{            \PYZlt{}img src=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{plots/k\PYZhy{}fold\PYZus{}diff\PYZus{}rates\PYZus{}ols\PYZus{}w\PYZus{}efw.png}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ alt=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{K\PYZhy{}fold Diff rates with EFW}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZgt{}}
\PY{l+s+s2}{            \PYZlt{}img src=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{plots/k\PYZhy{}fold\PYZus{}diff\PYZus{}rates\PYZus{}ols\PYZus{}w\PYZus{}o\PYZus{}efw.png}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ alt=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{K\PYZhy{}fold Diff rates without EFW}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZgt{}}

\PY{l+s+s2}{        \PYZlt{}/div\PYZgt{}}
\PY{l+s+s2}{        \PYZlt{}figcaption\PYZgt{}Fig 2. K\PYZhy{}fold DAGs on train data for rates and Diff rates\PYZlt{}/figcaption\PYZgt{}}
\PY{l+s+s2}{        }
\PY{l+s+s2}{        }
\PY{l+s+s2}{        \PYZlt{}p\PYZgt{}Ordinary least squares (OLS) regressions were performed using the k\PYZhy{}fold validation method. The dataset that predicts the best was extracted and used for plotting the DAGs. The above figure 2 represents the results from this training dataset. The top left and right of figure 2 represents rates while the bottom left and right represent the differenced rates.\PYZlt{}p\PYZgt{}}
\PY{l+s+s2}{        \PYZlt{}p\PYZgt{}For the rates, when EFW was included in the model, the DAGs shows a consistent negative impact of M4 on unemployment rates with a correlation of (\PYZhy{}0.38) and a positive relationship between EFW and production sectors, reinforcing the importance of economic freedom in reducing unemployment and enhancing production.\PYZlt{}p\PYZgt{}}
\PY{l+s+s2}{        \PYZlt{}p\PYZgt{}The exclusion of EFW from the k\PYZhy{}fold model also maintains the negative influence of M4 on unemployment rates (\PYZhy{}0.24), highlighting the robustness of monetary policy effects regardless of economic freedom.\PYZlt{}p\PYZgt{}}
\PY{l+s+s2}{        \PYZlt{}p\PYZgt{}When differenced rates are used for the analysis, the inclusion of EFW indicates a strong negative relationship between M4 and unemployment (\PYZhy{}0.26) and between EFW and unemployment (\PYZhy{}0.47). The positive influence of EFW on production variables supports H5. Excluding EFW in the differenced rates k\PYZhy{}fold model, similar patterns are observed, with a consistent negative impact of M4 on unemployment (\PYZhy{}0.48) and a strong role of monetary variables.\PYZlt{}p\PYZgt{}}
\PY{l+s+s2}{        \PYZlt{}p\PYZgt{}Both the full and k\PYZhy{}fold DAGs for rates showed similar structures, indicating robust causal pathways across different data splits. The DAGs for differenced rates also exhibited consistency between the full and k\PYZhy{}fold analyses, underscoring the stability of identified causal relationships.\PYZlt{}p\PYZgt{}}
\PY{l+s+s2}{        \PYZlt{}p\PYZgt{}The economic freedom variable has significant role in influencing other economic variables, acting as a mediator in various pathways. However, excluding it in the model altered some of the causal pathways, indicating its pivotal role in the economic structure.\PYZlt{}p\PYZgt{}}
\PY{l+s+s2}{        \PYZlt{}p\PYZgt{}Furthermore, money supply demonstrated a strong influence on production sectors while interest rates showed significant impacts on unemployment rates and other economic variables, hence, highlighting the importance in capturing monetary influences.\PYZlt{}p\PYZgt{}}
\PY{l+s+s2}{        }
\PY{l+s+s2}{        \PYZlt{}h2\PYZgt{}Ordinary Least Squares (OLS) Regressions\PYZlt{}/h2\PYZgt{}}
\PY{l+s+s2}{        }
\PY{l+s+s2}{        \PYZlt{}p\PYZgt{}Ordinary least squares (OLS) regressions were performed on different models using different data structures. In this section we performed the full regression on the full dataset, and using the k\PYZhy{}fold validation technique on a portion of the dataset for prediction accuracy and robustness.\PYZlt{}p\PYZgt{}}
\PY{l+s+s2}{        \PYZlt{}p\PYZgt{}The following represent the models in the analyses:\PYZlt{}p\PYZgt{}}
\PY{l+s+s2}{        }
\PY{l+s+s2}{        \PYZlt{}p\PYZgt{}Model 1: Unem= \PYZdl{}β\PYZus{}0+ β\PYZus{}1  Agri+ β\PYZus{}2  Mini+ β\PYZus{}3  Util+ β\PYZus{}4  EFW+ β\PYZus{}5  M4+ β\PYZus{}6  M4I+ϵ\PYZdl{}\PYZlt{}p\PYZgt{}}
\PY{l+s+s2}{        \PYZlt{}p\PYZgt{}Model 2: Unem= \PYZdl{}β\PYZus{}0+ β\PYZus{}1  Agri+ β\PYZus{}2  Mini+ β\PYZus{}3  Util+  β\PYZus{}5  M4+ β\PYZus{}6  M4I+ϵ\PYZdl{}\PYZlt{}p\PYZgt{}}
\PY{l+s+s2}{        }


\PY{l+s+s2}{        }
\PY{l+s+s2}{        }
\PY{l+s+s2}{    \PYZlt{}/div\PYZgt{}}
\PY{l+s+s2}{\PYZlt{}/body\PYZgt{}}
\PY{l+s+s2}{\PYZlt{}/html\PYZgt{}}
\PY{l+s+s2}{\PYZdq{}\PYZdq{}\PYZdq{}}

\PY{k+kn}{from} \PY{n+nn}{IPython}\PY{n+nn}{.}\PY{n+nn}{core}\PY{n+nn}{.}\PY{n+nn}{display} \PY{k+kn}{import} \PY{n}{display}\PY{p}{,} \PY{n}{HTML}
\PY{c+c1}{\PYZsh{} display(HTML(html\PYZus{}code))}
\PY{c+c1}{\PYZsh{} Save the HTML content to a file}
\PY{k}{with} \PY{n+nb}{open}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Summer\PYZus{}project.html}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{w}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)} \PY{k}{as} \PY{n}{file}\PY{p}{:}
    \PY{n}{file}\PY{o}{.}\PY{n}{write}\PY{p}{(}\PY{n}{html\PYZus{}code}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
/var/folders/m0/mc2nljwd23d4rr488c02gg1h0000gn/T/ipykernel\_1270/2583411424.py:1:
DeprecationWarning: Importing display from IPython.core.display is deprecated
since IPython 7.14, please import from IPython display
  from IPython.core.display import display, HTML
/var/folders/m0/mc2nljwd23d4rr488c02gg1h0000gn/T/ipykernel\_1270/2583411424.py:23
2: DeprecationWarning: Importing display from IPython.core.display is deprecated
since IPython 7.14, please import from IPython display
  from IPython.core.display import display, HTML
    \end{Verbatim}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{9}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{from} \PY{n+nn}{IPython}\PY{n+nn}{.}\PY{n+nn}{display} \PY{k+kn}{import} \PY{n}{IFrame}
\PY{c+c1}{\PYZsh{} Embed HTML}
\PY{n}{display}\PY{p}{(}\PY{n}{IFrame}\PY{p}{(}\PY{n}{src}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Summer\PYZus{}project.html}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{width}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{100}\PY{l+s+s1}{\PYZpc{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{height}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{500px}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    
    \begin{Verbatim}[commandchars=\\\{\}]
<IPython.lib.display.IFrame at 0x1050a8e50>
    \end{Verbatim}

    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{14}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import} \PY{n+nn}{os}
\PY{k+kn}{from} \PY{n+nn}{IPython}\PY{n+nn}{.}\PY{n+nn}{core}\PY{n+nn}{.}\PY{n+nn}{display} \PY{k+kn}{import} \PY{n}{display}\PY{p}{,} \PY{n}{HTML}

\PY{c+c1}{\PYZsh{} Specify the directory containing your images}
\PY{n}{image\PYZus{}directory} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{plots}\PY{l+s+s2}{\PYZdq{}}

\PY{c+c1}{\PYZsh{} List the specific images you want to include}
\PY{n}{selected\PYZus{}images} \PY{o}{=} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{rates\PYZus{}w\PYZus{}efw\PYZus{}w\PYZus{}o\PYZus{}clusters.png}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{rates\PYZus{}w\PYZus{}o\PYZus{}efw\PYZus{}w\PYZus{}o\PYZus{}clusters.png}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} 
                   \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{diff\PYZus{}rates\PYZus{}w\PYZus{}efw\PYZus{}w\PYZus{}o\PYZus{}clusters.png}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{diff\PYZus{}rates\PYZus{}w\PYZus{}o\PYZus{}efw\PYZus{}w\PYZus{}o\PYZus{}clusters.png}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
/var/folders/m0/mc2nljwd23d4rr488c02gg1h0000gn/T/ipykernel\_1270/437394615.py:2:
DeprecationWarning: Importing display from IPython.core.display is deprecated
since IPython 7.14, please import from IPython display
  from IPython.core.display import display, HTML
    \end{Verbatim}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{20}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{html\PYZus{}code} \PY{o}{=} \PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}\PYZdq{}\PYZdq{}}
\PY{l+s+s2}{\PYZlt{}!DOCTYPE html\PYZgt{}}
\PY{l+s+s2}{\PYZlt{}html lang=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{en}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZgt{}}
\PY{l+s+s2}{\PYZlt{}head\PYZgt{}}
\PY{l+s+s2}{    \PYZlt{}meta charset=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{UTF\PYZhy{}8}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZgt{}}
\PY{l+s+s2}{    \PYZlt{}meta name=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{viewport}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ content=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{width=device\PYZhy{}width, initial\PYZhy{}scale=1.0}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZgt{}}
\PY{l+s+s2}{    \PYZlt{}title\PYZgt{}Summer Project Report\PYZlt{}/title\PYZgt{}}
\PY{l+s+s2}{    \PYZlt{}style\PYZgt{}}
\PY{l+s+s2}{        body, html }\PY{l+s+se}{\PYZob{}\PYZob{}}
\PY{l+s+s2}{            margin: 0;}
\PY{l+s+s2}{            padding: 0;}
\PY{l+s+s2}{            height: 100\PYZpc{};}
\PY{l+s+s2}{            width: 100\PYZpc{};}
\PY{l+s+s2}{            font\PYZhy{}family: Arial, sans\PYZhy{}serif;}
\PY{l+s+s2}{            color: \PYZsh{}fff;}
\PY{l+s+s2}{        }\PY{l+s+se}{\PYZcb{}\PYZcb{}}

\PY{l+s+s2}{        .background }\PY{l+s+se}{\PYZob{}\PYZob{}}
\PY{l+s+s2}{            position: absolute;}
\PY{l+s+s2}{            top: 0;}
\PY{l+s+s2}{            left: 0;}
\PY{l+s+s2}{            width: 100\PYZpc{};}
\PY{l+s+s2}{            height: 100\PYZpc{};}
\PY{l+s+s2}{            z\PYZhy{}index: \PYZhy{}1;}
\PY{l+s+s2}{            background: url(}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{your\PYZhy{}image.jpg}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{) no\PYZhy{}repeat center center/cover;}
\PY{l+s+s2}{        }\PY{l+s+se}{\PYZcb{}\PYZcb{}}

\PY{l+s+s2}{        .content }\PY{l+s+se}{\PYZob{}\PYZob{}}
\PY{l+s+s2}{            position: relative;}
\PY{l+s+s2}{            padding: 20px;}
\PY{l+s+s2}{            max\PYZhy{}width: 800px;}
\PY{l+s+s2}{            margin: auto;}
\PY{l+s+s2}{            background: rgba(0, 0, 0, 0.5);}
\PY{l+s+s2}{            border\PYZhy{}radius: 10px;}
\PY{l+s+s2}{            box\PYZhy{}shadow: 0 4px 8px rgba(0, 0, 0, 0.3);}
\PY{l+s+s2}{            overflow\PYZhy{}y: auto;}
\PY{l+s+s2}{            max\PYZhy{}height: 90\PYZpc{};}
\PY{l+s+s2}{        }\PY{l+s+se}{\PYZcb{}\PYZcb{}}

\PY{l+s+s2}{        h1 }\PY{l+s+se}{\PYZob{}\PYZob{}}
\PY{l+s+s2}{            font\PYZhy{}size: 2em;}
\PY{l+s+s2}{            margin\PYZhy{}bottom: 20px;}
\PY{l+s+s2}{        }\PY{l+s+se}{\PYZcb{}\PYZcb{}}

\PY{l+s+s2}{        h2 }\PY{l+s+se}{\PYZob{}\PYZob{}}
\PY{l+s+s2}{            font\PYZhy{}size: 1.5em;}
\PY{l+s+s2}{            margin\PYZhy{}top: 20px;}
\PY{l+s+s2}{            margin\PYZhy{}bottom: 15px;}
\PY{l+s+s2}{        }\PY{l+s+se}{\PYZcb{}\PYZcb{}}

\PY{l+s+s2}{        p }\PY{l+s+se}{\PYZob{}\PYZob{}}
\PY{l+s+s2}{            line\PYZhy{}height: 1.6;}
\PY{l+s+s2}{            margin\PYZhy{}bottom: 15px;}
\PY{l+s+s2}{        }\PY{l+s+se}{\PYZcb{}\PYZcb{}}

\PY{l+s+s2}{        .grid\PYZhy{}container }\PY{l+s+se}{\PYZob{}\PYZob{}}
\PY{l+s+s2}{            display: grid;}
\PY{l+s+s2}{            grid\PYZhy{}template\PYZhy{}columns: auto auto;}
\PY{l+s+s2}{            gap: 10px;}
\PY{l+s+s2}{            padding: 10px;}
\PY{l+s+s2}{        }\PY{l+s+se}{\PYZcb{}\PYZcb{}}

\PY{l+s+s2}{        .grid\PYZhy{}item }\PY{l+s+se}{\PYZob{}\PYZob{}}
\PY{l+s+s2}{            text\PYZhy{}align: center;}
\PY{l+s+s2}{            padding: 10px;}
\PY{l+s+s2}{            font\PYZhy{}size: 16px;}
\PY{l+s+s2}{        }\PY{l+s+se}{\PYZcb{}\PYZcb{}}

\PY{l+s+s2}{        img }\PY{l+s+se}{\PYZob{}\PYZob{}}
\PY{l+s+s2}{            width: 100\PYZpc{};}
\PY{l+s+s2}{            height: auto;}
\PY{l+s+s2}{        }\PY{l+s+se}{\PYZcb{}\PYZcb{}}

\PY{l+s+s2}{        figure }\PY{l+s+se}{\PYZob{}\PYZob{}}
\PY{l+s+s2}{            text\PYZhy{}align: center;}
\PY{l+s+s2}{            margin: 20px 0;}
\PY{l+s+s2}{        }\PY{l+s+se}{\PYZcb{}\PYZcb{}}

\PY{l+s+s2}{        figcaption }\PY{l+s+se}{\PYZob{}\PYZob{}}
\PY{l+s+s2}{            font\PYZhy{}size: 1em;}
\PY{l+s+s2}{            margin\PYZhy{}top: 5px;}
\PY{l+s+s2}{        }\PY{l+s+se}{\PYZcb{}\PYZcb{}}

\PY{l+s+s2}{        table.dataframe }\PY{l+s+se}{\PYZob{}\PYZob{}}
\PY{l+s+s2}{            width: 130\PYZpc{};}
\PY{l+s+s2}{            margin: 20px 0;}
\PY{l+s+s2}{            border\PYZhy{}collapse: collapse;}
\PY{l+s+s2}{        }\PY{l+s+se}{\PYZcb{}\PYZcb{}}

\PY{l+s+s2}{        table.dataframe th, table.dataframe td }\PY{l+s+se}{\PYZob{}\PYZob{}}
\PY{l+s+s2}{            padding: 10px;}
\PY{l+s+s2}{            text\PYZhy{}align: center;}
\PY{l+s+s2}{            border: 1px solid \PYZsh{}ddd;}
\PY{l+s+s2}{            background\PYZhy{}color: \PYZsh{}f4f4f4;}
\PY{l+s+s2}{            color: \PYZsh{}000;}
\PY{l+s+s2}{        }\PY{l+s+se}{\PYZcb{}\PYZcb{}}

\PY{l+s+s2}{        table.dataframe caption }\PY{l+s+se}{\PYZob{}\PYZob{}}
\PY{l+s+s2}{            font\PYZhy{}size: 1em;}
\PY{l+s+s2}{            margin\PYZhy{}bottom: 5px;}
\PY{l+s+s2}{            color: \PYZsh{}000;}
\PY{l+s+s2}{        }\PY{l+s+se}{\PYZcb{}\PYZcb{}}
\PY{l+s+s2}{    \PYZlt{}/style\PYZgt{}}
\PY{l+s+s2}{\PYZlt{}/head\PYZgt{}}
\PY{l+s+s2}{\PYZlt{}body\PYZgt{}}
\PY{l+s+s2}{    \PYZlt{}div class=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{background}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZgt{}\PYZlt{}/div\PYZgt{}}
\PY{l+s+s2}{    \PYZlt{}div class=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{content}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZgt{}}
\PY{l+s+s2}{        \PYZlt{}h1\PYZgt{}Introduction and Literature\PYZlt{}/h1\PYZgt{}}

\PY{l+s+s2}{        \PYZlt{}h2\PYZgt{}Capital Theory\PYZlt{}/h2\PYZgt{}}
\PY{l+s+s2}{        \PYZlt{}p\PYZgt{}Capital theory is a vast topic in finance and there still seems to be the argument as to what capital means and what it should truly mean. Neoclassicals define capital as a physical quantity that is independent of prices (Robinson, 1970). Historically, the definition of capital has been often shifting from either financial or physical. It started as being financial, in that it meant the sum of all money equivalent of all assets minus the sum of the money equivalent of all liabilities at a particular date to the conduct of the operations of a specific business unit (Lewin and Cachanosky, 2019). After a while economists argued that capital could not be defined as being financial only, and that birthed the physical aspect of capital referred to as physical capital. This connotes the set of physical production goods (often referred to as capital goods). In recent times, capital theorists began to take a look at how time could have an effect on capital as a whole, thus, illustrating capital in terms of having three different but inseparable dimensions: value, quantity and time. What this means is that capital can be viewed as financial, physical and yet involving time in a particular business process. Various disciplines have various definitions for capital, for example, Bourdieu’s capital theory recognizes that capital does not necessarily need to be economic but also includes other factors such as social and cultural capital (Bourdieu, 1986). Lewin and Cachanosky (2019) indicate that capital can be understood as the money value of a firm which accounts for all assets and liabilities. Stating that “productive activities employ stocks of durable and nondurable productive resources over time to produce a flow of valuable products or services for use or for sale”. The value of capital is based on the production process over time and the value of its finished goods or services. Interestingly, developed nations in recent years are beginning to experience a rise in the importance of intangible capital (such as information technology) in production and a decline in the reliance on physical capital (Caggese and Perez\PYZhy{}Orive, 2022).\PYZlt{}/p\PYZgt{}}
\PY{l+s+s2}{        \PYZlt{}p\PYZgt{}Interest rates as well as foreign exchange rates play a vital role in transmitting distortions to the capital structure of economies. Low interest rates do not accommodate for intangible investments due to the nature of intangible capital financing eventually resulting in consequences for aggregate capital misallocation. (McKinnon, 2010; Cachanosky, 2014; Caggese and Perez\PYZhy{}Orive, 2022).\PYZlt{}/p\PYZgt{}}
\PY{l+s+s2}{        }
\PY{l+s+s2}{        }
\PY{l+s+s2}{        \PYZlt{}h2\PYZgt{}Capital Structure\PYZlt{}/h2\PYZgt{}}
\PY{l+s+s2}{        \PYZlt{}p\PYZgt{}[Insert your text here]\PYZlt{}/p\PYZgt{}}

\PY{l+s+s2}{        \PYZlt{}h1\PYZgt{}Results\PYZlt{}/h1\PYZgt{}}
\PY{l+s+s2}{        \PYZlt{}p\PYZgt{}[Insert your results analysis here]\PYZlt{}/p\PYZgt{}}

\PY{l+s+s2}{        \PYZlt{}!\PYZhy{}\PYZhy{} Image Grid \PYZhy{}\PYZhy{}\PYZgt{}}
\PY{l+s+s2}{        \PYZlt{}div class=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{grid\PYZhy{}container}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZgt{}}
\PY{l+s+s2}{\PYZdq{}\PYZdq{}\PYZdq{}}

\PY{c+c1}{\PYZsh{} Dynamically add selected image elements without displaying names}
\PY{k}{for} \PY{n}{img\PYZus{}file} \PY{o+ow}{in} \PY{n}{selected\PYZus{}images}\PY{p}{:}
    \PY{n}{img\PYZus{}path} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{image\PYZus{}directory}\PY{p}{,} \PY{n}{img\PYZus{}file}\PY{p}{)}
    \PY{n}{html\PYZus{}code} \PY{o}{+}\PY{o}{=} \PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}\PYZdq{}\PYZdq{}}
\PY{l+s+s2}{            \PYZlt{}div class=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{grid\PYZhy{}item}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZgt{}}
\PY{l+s+s2}{                \PYZlt{}img src=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZob{}}\PY{n}{img\PYZus{}path}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ alt=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZgt{}}
\PY{l+s+s2}{            \PYZlt{}/div\PYZgt{}}
\PY{l+s+s2}{    }\PY{l+s+s2}{\PYZdq{}\PYZdq{}\PYZdq{}}

\PY{c+c1}{\PYZsh{} Closing the HTML content}
\PY{n}{html\PYZus{}code} \PY{o}{+}\PY{o}{=} \PY{l+s+s2}{\PYZdq{}\PYZdq{}\PYZdq{}}
\PY{l+s+s2}{        \PYZlt{}/div\PYZgt{}}
\PY{l+s+s2}{        \PYZlt{}figcaption\PYZgt{}Fig 1. Selected Image Grid\PYZlt{}/figcaption\PYZgt{}}

\PY{l+s+s2}{        \PYZlt{}h2\PYZgt{}Ordinary Least Squares (OLS) Regressions\PYZlt{}/h2\PYZgt{}}
\PY{l+s+s2}{        \PYZlt{}p\PYZgt{}[Insert your regression analysis here]\PYZlt{}/p\PYZgt{}}
\PY{l+s+s2}{    \PYZlt{}/div\PYZgt{}}
\PY{l+s+s2}{\PYZlt{}/body\PYZgt{}}
\PY{l+s+s2}{\PYZlt{}/html\PYZgt{}}
\PY{l+s+s2}{\PYZdq{}\PYZdq{}\PYZdq{}}

\PY{c+c1}{\PYZsh{} Save the HTML content to a file}
\PY{k}{with} \PY{n+nb}{open}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Summer\PYZus{}project.html}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{w}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)} \PY{k}{as} \PY{n}{file}\PY{p}{:}
    \PY{n}{file}\PY{o}{.}\PY{n}{write}\PY{p}{(}\PY{n}{html\PYZus{}code}\PY{p}{)}

\PY{c+c1}{\PYZsh{} Optionally display the HTML in Jupyter Notebook}
\PY{n}{display}\PY{p}{(}\PY{n}{HTML}\PY{p}{(}\PY{n}{html\PYZus{}code}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    
    \begin{Verbatim}[commandchars=\\\{\}]
<IPython.core.display.HTML object>
    \end{Verbatim}

    
    Capital Theory

Capital theory is a vast topic in finance and there still seems to be
the argument as to what capital means and what it should truly mean.
Neoclassicals define capital as a physical quantity that is independent
of prices (Robinson, 1970). Historically, the definition of capital has
been often shifting from either financial or physical. It started as
being financial, in that it meant the sum of all money equivalent of all
assets minus the sum of the money equivalent of all liabilities at a
particular date to the conduct of the operations of a specific business
unit (Lewin and Cachanosky, 2019). After a while economists argued that
capital could not be defined as being financial only, and that birthed
the physical aspect of capital referred to as physical capital. This
connotes the set of physical production goods (often referred to as
capital goods). In recent times, capital theorists began to take a look
at how time could have an effect on capital as a whole, thus,
illustrating capital in terms of having three different but inseparable
dimensions: value, quantity and time. What this means is that capital
can be viewed as financial, physical and yet involving time in a
particular business process. Various disciplines have various
definitions for capital, for example, Bourdieu's capital theory
recognizes that capital does not necessarily need to be economic but
also includes other factors such as social and cultural capital
(Bourdieu, 1986). Lewin and Cachanosky (2019) indicate that capital can
be understood as the money value of a firm which accounts for all assets
and liabilities. Stating that ``productive activities employ stocks of
durable and nondurable productive resources over time to produce a flow
of valuable products or services for use or for sale''. The value of
capital is based on the production process over time and the value of
its finished goods or services. Interestingly, developed nations in
recent years are beginning to experience a rise in the importance of
intangible capital (such as information technology) in production and a
decline in the reliance on physical capital (Caggese and Perez-Orive,
2022).

Interest rates as well as foreign exchange rates play a vital role in
transmitting distortions to the capital structure of economies. Low
interest rates do not accommodate for intangible investments due to the
nature of intangible capital financing eventually resulting in
consequences for aggregate capital misallocation. (McKinnon, 2010;
Cachanosky, 2014; Caggese and Perez-Orive, 2022).

According to Caggese and Perez-Orive (2022), the reaction of tangible
and intangible firms to interest rate changes differ, in that increases
in interest rates negatively affects investment of tangible firms. This
is expected as conventional theories would rightly predict. However, the
investment of intangible firms reacts positively to increases in
interest rates.

Capital Structure

To explain the combination of security and financial sources used by a
corporation, various hypotheses have surfaced. Following the
foundational paper by Modigliani and Miller (1958), which raised the
problem of the relationship between a firm's choice of finance and its
value, the financing choice of firms is, in fact, possibly the most
investigated topic area in finance in recent decades. Although there
isn't a single, widely recognized explanation describing why companies
choose between debt and equity, various theories have surfaced in the
previous few decades. These theories have considered macroeconomic
variables as well as firm level characteristics in particular.

Modigliani and Miller (1963) suggest that firms may prefer debt over
equity due to tax advantages, potentially leading to high debt levels
for profitable firms. However, Miller (1977) and others note the impact
of personal taxation, and DeAngelo and Masulis (1980) argue that firms
with other tax shields may not prioritize interest tax shields.

Myers and Majluf (1984) propose the pecking-order theory, suggesting
that firms, due to information asymmetry, prefer internal funding over
external sources. Thus, profitable firms may use retained earnings for
investments rather than debt. Rajan and Zingales (1995) find support for
this theory, showing a negative correlation between leverage and
profitability.

Rajan and Zingales (1995), following Bradley et al.~(1984) and Titman
and Wessels (1988), find a positive relationship between tangibility
(ratio of fixed to total assets) and leverage. They suggest that firms
with more collateral may find it easier to secure debt, aligning with
the ideas of Scott (1977), Williamson (1988), and Harris and Raviv
(1990) on reducing agency problems.

Demand Shocks

Demand shocks are typically caused by changes in consumer preferences,
economic policies, or external factors such as changes in the global
economy (Kilian, 2008). The most common example of a demand shock is a
sudden change in consumer demand for a product or service (Kilian and
Hicks, 2013; Leduc and Lui, 2016). This can lead to a decrease or
increase in the level of production of the product, depending on whether
the demand shock is positive or negative (Ball et al., 1995; Berument et
al., 2010; Kiss et al., 2023). According to the conventional theory of
growth and fluctuations, aggregate demand results in temporary
deviations from a production trend that is solely influenced by supply
forces (capital accumulation, labor force growth and technological
progress). After a shock, the economy returns to its typical output
path: In the words of the empirical research on growth and economic
fluctuations, GDP is ``trend steady''. In the literature on real
business cycles, deviations from trend can be long-lasting, but this is
typically read as indicating that supply-side variables, such as
technological shocks, dominate fluctuations in the economy (Kilian and
Park, 2009). The topic of whether aggregate demand shocks have
long-lasting, irreversible consequences on output and living standards
thus appears to be answered negatively by orthodox economic theory, with
few exceptions (Bachmann, et al., 2013; Dutt and Ros, 2003; Dutt and
Ros, 2007). Economic growth may be permanently impacted by aggregate
demand. As a result of rising returns, hysteresis impacts in labor
markets, and balance of payments limitations, it is demonstrated that
even if the economy converges to some ``normal'' route, this course
could still be changed by significant demand shocks. It is also
demonstrated that the economy might not follow its ``normal'' trend, in
which case fiscal and monetary policy will affect output and growth over
the long run (Dutt and Ros, 2007; Kilian, 2009).

Supply Shocks

Changes in the availability or price of a crucial input in the
production process are frequently what trigger supply shocks
(Reifschneider et al., 2015). They are unexpected events that cause a
sudden change in the availability of a key input or resource in the
production process, leading to changes in the overall cost structure of
firms (Ecstein and Sinai, 1986). These shocks can have a significant
impact on the economy, with implications for production, employment, and
inflation.

Raw material, energy, or labor price increases are the most typical
types of supply shocks (Blinder et al., 2013; Bruno and Sachs, 1982).
When businesses are unable to generate as much output as before, a
sudden increase in the price of an input might result in a drop in the
supply of the product being produced (Eckstein and Sinai, 1986; Fisher
et al., 1994).

The relationship between supply shocks and pricing in the production
structure has been the subject of numerous researches. For instance, a
study by Blanchard and Fischer (1989) contends that positive supply
shocks can boost a firm's production capacity, resulting in higher
output and reduced inflation. These shocks include drops in the price of
oil or advances in technology. On the other hand, negative supply
shocks, such as abrupt rise in oil costs or a natural disaster, can
cause output to fall and prices to rise. The impact of shocks in
supply-side policies, such as tax incentives and deregulation, on
productivity and efficiency can have long-term effects on production
structure by influencing investment decisions, technology adoption, and
competition (Jorgenson, 1991).

Models of Demand and Supply shocks on production structure

One of the most prominent theories on the impact of supply and demand
shocks on production structure is the Input-Output (IO) framework
(Gilmartin et al., 2008; West, 1995), which is based on the idea that
different sectors of the economy are interconnected through their use of
intermediate inputs. The IO framework can be used to analyze the impact
of supply and demand shocks on the production structure by tracing the
flow of inputs and outputs through different sectors of the economy (Li
et al., 2018). IO model was used to study the impact of Chinese import
competition on US manufacturing and the study found that Chinese imports
led to a decline in demand for US-manufactured goods, which in turn led
to a decline in the number of firms and workers in the sector (Acemoglu
et al., 2016; Autor et al., 2013).

Another approach to studying the impact of supply and demand shocks on
the production structure is through the use of computable general
equilibrium (CGE) models. These models are used to analyze the impact of
changes in supply and demand on the economy as a whole, by considering
the interactions between different sectors and households (Blake et al.,
2001; Diao and Thurlow, 2012; Doroodian and Boyd, 2003; Seung and Water,
2010). One study on macroeconomic and distributional consequences of
energy shocks utilized this model and showed that oil supply shocks are
costly and result in a decline in real GDP, higher average prices and
increase balance of payment deficits (Adenikinju and Falobi, 2006).

More generally, supply and demand shocks can have significant impacts on
the production structure, with the magnitude and direction of the impact
depending on a range of factors, including the initial structure of the
economy, the nature of the shock, and the policy response. While
different models have accessed the impacts and possible directions of
demand and supply shocks, there is little to no research using a
directed acyclic graph to model the impact of demand and supply shocks
on a production structure.

Money Supply

The importance of monetary policy measures as a means to increase firms'
access to debt funding has been underlined by the recent Global
Financial Crisis. In the midst of the crisis, central banks in most
advanced economies have carefully examined the possibility of buying
public and private debt to increase credit and money supply (Epstein1,
2007; El-Erian, 2017; Julio et al., 2020).

Corporate capital structure is likely to depend on decisions made by
monetary authorities given the role of monetary policy in achieving
financial stability (Ashcraft et al., 2011; Stein, 2012) and the idea
that a more stable environment should support company operations. To the
degree that borrowing restrictions affect business cycles and collateral
values, it is widely recognized that monetary policy can impact bank
lending and real activity (Lacoviello, 2005; Gilchrist and Zakrajsek,
2011; Stein, 2012).

According to Pindado et al., (2020), there exists a nonlinear relation
between money growth and corporate debt stating that the relation
exhibits an inverted U-shape. An increase in the money supply
facilitates firms' indebtedness because of the higher liquidity in the
market (Holmstrom and Tirole, 1998; Schnabl, 2012; Dewally and Shao,
2014; Pindado et al., 2020). However, there is an optimal level beyond
which additional growth of the monetary aggregate has the opposite
effect. From this level onwards, further expansionary measures
discourage firms from borrowing because of the risk of inflation, which
would in turn lead to increases in interest rates, making debt more
expensive (White, 2009; Bordo and Landon-Lane, 2013; Pindado et al.,
2020). Nevertheless, the characteristics of the banking system influence
the intensity of the effect of money supply on firm debt and determine
the level of growth of the monetary aggregate that is necessary to
maximize firms' access to debt financing (Becker and Ivashina, 2014). If
there is higher liquidity in the hands of banks, the impact of
expansionary measures on debt is mitigated and the inflection point at
which the relation between both factors turns from positive to negative
is reached at a higher level (Eichengreen, 2004; White, 2009). By
contrast, in countries where banks allocate a higher fraction of their
resources to private credit, the effect of the monetary aggregate on
debt is more pronounced, reducing the amount of money supply that is
necessary to maximize corporate leverage (Bolton and Freixas, 2006;
Kashyap et al., 2008; Crouzet, 2018).

According to Chung and Ariff (2016) and Urbanovský (2016), there is not
yet a consensus in empirical research supporting Friedman's proposition
that ``increases in money supply should lead to liquidity surges and
credit expansion.'' Friedman (1968) argued that a gradual increase in
the money supply is essential for a healthy economy as it stimulates
economic growth. Therefore, since various sector of an economy's growth
is often indicative of aggregate economic growth, it is possible that
the money supply directly influences these sectors or acts as a
moderator for the impact of microeconomic variables on the global market
(Otambo, 2016; Egbunike and Okerekeoti, 2018). Additionally, Singh,
Mehta, and Varsha (2011) suggested that including macroeconomic
variables in investment decision-making could enhance investors' ability
to develop profitable investment strategies thus, creating a growth in
the economy.

In recent years, researchers have increasingly focused on how the
external macroeconomic environment influences a firms' capital structure
(Bokpin, 2009; Kumar et al., 2017; Dong, 2023). Korajczyk and Levy
(2003) investigated this relationship and discovered that firms without
financing constraints tend to prefer equity financing during economic
expansions, whereas they favor debt financing during contractions.
Conversely, firms facing financing constraints exhibit the opposite
pattern. This highlights the significant impact of the macroeconomy on
firms' capital structure. Hackbarth et al., (2006) further emphasized
the importance of capital supply shocks, whether from the credit or
capital markets, in shaping firms' capital structure. Kashyap et al.,
(1993) observed that tight monetary policy leads to changes in firms'
external financing behavior, resulting in a significant decrease in the
amount of bank loans obtained by firms. The influence of macroeconomic
conditions on capital structure exhibits distinct patterns: firms
without financing constraints demonstrate counter-cyclical changes in
their target leverage, whereas constrained firms show cyclical changes
(Leary, 2009).

There is little empirical data examining the impact of money supply and
demand shocks on firms' capital structure. The majority of research
considers macroeconomic factors as relatively stable external conditions
influencing corporate financing decisions. These studies either aim to
manage macroeconomic disturbances or seek to explain variations in
capital structure from a microeconomic perspective. For instance,
Dongwei and Haihua (2009) analyzed China's capital structure using
macroeconomic factors and discovered an inverse relationship between
China's capital structure and economic cycles. A more recent study
carried out by Dong (2023) which examined the correlation between money
supply and corporate capital structure through the lens of financial
constraints discovered that there is a significant and positive
relationship between money supply and corporate capital structure when
financing constraints are not considered. Dong also found that the
impact of money supply on capital structure differs among firms with
varying degrees of financing constraints, with firms facing higher
financial constraints experiencing a significantly stronger effect
compared to those with lower constraints. However, there still remains a
gap in the literature regarding the effects of a demand and/or supply
shock of money supply to the capital structure of a firm.

Research Hypothesis

\(H_1\) : There is a positive correlation between money supply and
production economy

\(H_2\) : An increase in interest rates results in a decrease in the
production

\(H_3\) : Increase in money supply results in decrease in unemployment
rates

\(H_4\) : There exists a positive correlation between interest rates and
unemployment rates

\(H_5\) : The higher the economic freedom, the lower the unemployment
rates and the higher the nominal GDP

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{1}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{jupyter} \PY{n}{nbconvert} \PY{o}{\PYZhy{}}\PY{o}{\PYZhy{}}\PY{n}{to} \PY{n}{latex} \PYZbs{}
    \PY{o}{\PYZhy{}}\PY{o}{\PYZhy{}}\PY{n}{TagRemovePreprocessor}\PY{o}{.}\PY{n}{remove\PYZus{}cell\PYZus{}tags}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZob{}}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{remove}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{\PYZcb{}}\PY{l+s+s1}{\PYZsq{}} \PYZbs{}
    \PY{o}{\PYZhy{}}\PY{o}{\PYZhy{}}\PY{n}{TagRemovePreprocessor}\PY{o}{.}\PY{n}{allow\PYZus{}cell\PYZus{}tags}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZob{}}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{export}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{\PYZcb{}}\PY{l+s+s1}{\PYZsq{}} \PYZbs{}
    \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{08192024 Update.ipynb}\PY{l+s+s2}{\PYZdq{}} \PYZbs{}
    \PY{o}{\PYZhy{}}\PY{o}{\PYZhy{}}\PY{n}{output} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{filtered\PYZus{}results.tex}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZhy{}}\PY{o}{\PYZhy{}}\PY{n}{output}\PY{o}{\PYZhy{}}\PY{n+nb}{dir} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/path/to/save/location}\PY{l+s+s2}{\PYZdq{}}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}, frame=single, framerule=2mm, rulecolor=\color{outerrorbackground}]
\textcolor{ansi-cyan}{  Cell }\textcolor{ansi-green}{In[1], line 1}
\textcolor{ansi-red}{    jupyter nbconvert --to latex \textbackslash{}}
            \^{}
\textcolor{ansi-red}{SyntaxError}\textcolor{ansi-red}{:} invalid syntax

    \end{Verbatim}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]

\end{Verbatim}
\end{tcolorbox}


    % Add a bibliography block to the postdoc
    
    
    
\end{document}
